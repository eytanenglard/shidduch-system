################################################################################
# Directory Content Map For: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]
# Generated on: 2025-11-30 20:29:03
# Filter: Only content of code files (.bat, .c, .cfg, .conf, .cpp, .cs, .css, .go, .h, .html, .ini, .java, .js, .json, .jsx, .kt, .less, .md, .php, .py, .rb, .rs, .scss, .sh, .sql, .swift, .ts, .tsx, .txt, .xml, .yaml, .yml) is included.
################################################################################

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\AppContent.tsx
--------------------------------------------------------------------------------
Content:
// src/app/AppContent.tsx

'use client';

import { usePathname } from 'next/navigation';
import Navbar from '@/components/layout/Navbar';
import { Toaster } from 'sonner';
import { ReactNode, useState, useEffect } from 'react';
import { cn } from '@/lib/utils'; // ודא שהייבוא הזה קיים
import type { Dictionary } from '@/types/dictionary';

interface AppContentProps {
  children: ReactNode;
  dict: Dictionary;
}

export default function AppContent({ children, dict }: AppContentProps) {
  const pathname = usePathname();
  const [isMainNavbarVisible, setIsMainNavbarVisible] = useState(true);

  useEffect(() => {
    const locale = pathname.split('/')[1];
    const isHomePage =
      pathname === `/${locale}` || (pathname === '/' && !locale);

    if (!isHomePage) {
      setIsMainNavbarVisible(true);
      return;
    }

    const handleScroll = () => {
      setIsMainNavbarVisible(window.scrollY <= 10);
    };

    window.addEventListener('scroll', handleScroll, { passive: true });
    handleScroll();

    return () => {
      window.removeEventListener('scroll', handleScroll);
    };
  }, [pathname]);

  // לוגיקה להסתרה ידנית של ה-Navbar (למשל, בשאלון)
  const isNavbarManuallyHidden = false; // <- הגדרה חדשה שתמיד מציגה את ה-Navbar

  // משתנה עזר שקובע אם צריך להוסיף את הריפוד העליון
  const shouldApplyNavbarPadding = !isNavbarManuallyHidden;

  return (
    <div className="flex flex-col min-h-screen">
      <Toaster position="top-center" richColors />

      {/* ה-Navbar נשאר עם position: fixed כפי שהיה */}
      {!isNavbarManuallyHidden && (
        <div
          className={`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ease-in-out ${
            isMainNavbarVisible
              ? 'opacity-100'
              : 'opacity-0 -translate-y-full pointer-events-none'
          }`}
        >
          <Navbar dict={dict} />
        </div>
      )}

      {/* 
        --- התיקון המרכזי כאן ---
        אנו מוסיפים לאלמנט ה-<main> ריפוד עליון (padding-top) בגובה של ה-Navbar (שהוא h-20, כלומר 5rem או 80px).
        הריפוד מתווסף באופן מותנה רק כאשר ה-Navbar באמת מוצג, כדי למנוע רווח מיותר בעמודים שבהם הוא מוסתר.
      */}
      <main
        className={cn(
          'flex-grow',
          shouldApplyNavbarPadding && 'pt-20' // pt-20 = padding-top: 5rem (80px)
        )}
      >
        {children}
      </main>
    </div>
  );
}
--- End of Content for AppContent.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\[locale]_contents.txt
--------------------------------------------------------------------------------
[This is the output log file itself. Content not included.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\apple-touch-icon.png
--------------------------------------------------------------------------------
[Content skipped: File extension '.png' is not in the allowed code list.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\favicon-96x96.png
--------------------------------------------------------------------------------
[Content skipped: File extension '.png' is not in the allowed code list.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\favicon.ico
--------------------------------------------------------------------------------
[Content skipped: File extension '.ico' is not in the allowed code list.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\favicon.svg
--------------------------------------------------------------------------------
[Content skipped: File extension '.svg' is not in the allowed code list.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\layout.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/layout.tsx

import { Rubik } from 'next/font/google'; // הפונט החם והנעים
import '../globals.css';
import Providers from '@/components/Providers';
import AppContent from './AppContent';
import GoogleAnalytics from '@/components/analytics/GoogleAnalytics';
import AccessibilityFeatures from '@/components/questionnaire/components/AccessibilityFeatures';
import type { Metadata } from 'next';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '../../../i18n-config';
import FeedbackWidget from '@/components/layout/FeedbackWidget';
import { QuestionnaireStateProvider } from '@/app/[locale]/contexts/QuestionnaireStateContext';

// הגדרת פונט Rubik - עגול, אנושי, נגיש וחם
const rubik = Rubik({
  subsets: ['hebrew', 'latin'],
  variable: '--font-rubik', // שם המשתנה
  display: 'swap',
  weight: ['300', '400', '500', '600', '700', '800'], // מגוון משקלים לעיצוב עשיר
});

type LayoutParams = Promise<{
  locale: string;
}>;

export async function generateMetadata(props: {
  params: LayoutParams;
}): Promise<Metadata> {
  const params = await props.params;
  const locale = params.locale as Locale;
  
  const dictionary = await getDictionary(locale);
  return {
    title: dictionary.metadata.title,
    description: dictionary.metadata.description,
    keywords: dictionary.metadata.keywords,
    openGraph: dictionary.metadata.openGraph,
    twitter: dictionary.metadata.twitter,
  };
}

export default async function RootLayout(props: {
  children: React.ReactNode;
  params: LayoutParams;
}) {
  const params = await props.params;
  const locale = params.locale as Locale;
  
  const dictionary = await getDictionary(locale);
  const direction = locale === 'he' ? 'rtl' : 'ltr';

  return (
    <html
      lang={locale}
      dir={direction}
      className={direction === 'rtl' ? 'dir-rtl' : 'dir-ltr'}
      suppressHydrationWarning
    >
      <head />
      <body
        // שימוש במשתנה של רוביק
        className={`${rubik.variable} antialiased font-sans`}
        suppressHydrationWarning
      >
        <GoogleAnalytics />
        <Providers>
          <QuestionnaireStateProvider dict={dictionary}>
            <AppContent dict={dictionary}>
              <FeedbackWidget
                dict={dictionary.feedbackWidget}
                locale={locale}
              />
              {props.children}
            </AppContent>
          </QuestionnaireStateProvider>
          <AccessibilityFeatures
            dict={dictionary.questionnaire.accessibilityFeatures}
          />
        </Providers>
      </body>
    </html>
  );
}
--- End of Content for layout.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/page.tsx

import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../i18n-config';
import HomePage from '@/components/HomePage/HomePage';
import { generateDemoData } from '@/components/HomePage/components/demo-data';

// ✅ Next.js 15: params is a Promise with string type (not union)
type HomePageProps = {
  params: Promise<{ locale: string }>;
};

export default async function Home(props: HomePageProps) {
  const params = await props.params;
  const locale = params.locale as Locale;

  // שאר הקוד נשאר זהה
  const [dictionary, demoData] = await Promise.all([
    getDictionary(locale),
    generateDemoData(locale),
  ]);

  return <HomePage dict={dictionary} demoData={demoData} locale={locale} />;
}
--- End of Content for page.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\site.webmanifest
--------------------------------------------------------------------------------
[Content skipped: File extension '.webmanifest' is not in the allowed code list.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\web-app-manifest-192x192.png
--------------------------------------------------------------------------------
[Content skipped: File extension '.png' is not in the allowed code list.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\web-app-manifest-512x512.png
--------------------------------------------------------------------------------
[Content skipped: File extension '.png' is not in the allowed code list.]

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\(authenticated)_contents.txt
--------------------------------------------------------------------------------
Content:
################################################################################
# Directory Content Map For: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)
# Generated on: 2025-10-28 12:18:35
################################################################################

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\(authenticated)_contents.txt
--------------------------------------------------------------------------------
[This is the output log file itself. Content not included.]

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\admin
================================================================================

(This directory contains subdirectories but no files directly. See subdirectories below.)

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\admin\engagement
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\admin\engagement\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/admin/engagement/page.tsx
import { getServerSession } from 'next-auth';
import { redirect } from 'next/navigation';
import EngagementDashboard from '@/components/admin/EngagementDashboard';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../../i18n-config';
import { authOptions } from '@/lib/auth';

// הגדרת ה-props הנכונה
type EngagementPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function EngagementPage({ params }: EngagementPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const session = await getServerSession(authOptions);

  if (session?.user?.role !== 'ADMIN') {
    redirect('/');
  }

  const dict = await getDictionary(locale);

  return <EngagementDashboard dict={dict} />;
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matches
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matches\MatchesClientPage.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/matches/MatchesClientPage.tsx

'use client';

import { useSession } from 'next-auth/react';
import MatchSuggestionsContainer from '@/components/suggestions/MatchSuggestionsContainer';
import { Skeleton } from '@/components/ui/skeleton';
import type {
  SuggestionsDictionary,
  ProfileCardDict,
} from '@/types/dictionary';

/**
 * הממשק (interface) מגדיר את ה-props שהרכיב הזה מקבל.
 * הוא מצפה לקבל אובייקט 'dict' המכיל את שני מילוני התרגום
 * הדרושים לו ולרכיבי הילד שלו: מילון ההצעות ומילון כרטיס הפרופיל.
 */
interface MatchesClientPageProps {
  suggestionsDict: SuggestionsDictionary;
  profileCardDict: ProfileCardDict;
}

/**
 * רכיב צד-לקוח (Client Component) האחראי על הצגת עמוד ההצעות.
 * הוא מנהל את אימות המשתמש ומעביר את הנתונים והתרגומים לרכיב התצוגה הראשי.
 */
export default function MatchesClientPage({ suggestionsDict, profileCardDict }: MatchesClientPageProps) {
  // קבלת נתוני המשתמש והסטטוס של החיבור
  const { data: session, status } = useSession();

  // בזמן שהחיבור מתבצע, הצג שלד טעינה (skeleton)
  if (status === 'loading') {
    return (
      <div className="container mx-auto p-6 space-y-4">
        <Skeleton className="h-48 w-full rounded-2xl" />
        <Skeleton className="h-48 w-full rounded-2xl" />
        <Skeleton className="h-48 w-full rounded-2xl" />
      </div>
    );
  }

  // אם המשתמש אינו מחובר, הצג הודעה מתאימה
  if (!session?.user?.id) {
    // ניתן להוסיף כאן רכיב מעוצב יותר או הפנייה לדף ההתחברות
    return (
      <div className="container mx-auto p-6 text-center text-red-600">
        אינך מורשה לצפות בדף זה. יש להתחבר למערכת.
      </div>
    );
  }

  // אם המשתמש מחובר, רנדר את קונטיינר ההצעות והעבר לו את הנתונים הנדרשים
  return (
    <MatchSuggestionsContainer
      userId={session.user.id}
      suggestionsDict={suggestionsDict}
      profileCardDict={profileCardDict}
    />
  );
}
--- End of Content for MatchesClientPage.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matches\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/matches/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import MatchesClientPage from './MatchesClientPage';

// הגדרת ה-props הנכונה
type MatchesPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function MatchesPage({ params }: MatchesPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <MatchesClientPage
      suggestionsDict={dictionary.suggestions}
      profileCardDict={dictionary.profilePage.profileCard}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker
================================================================================

(This directory contains subdirectories but no files directly. See subdirectories below.)

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\clients
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\clients\CandidatesManagerClient.tsx
--------------------------------------------------------------------------------
Content:
// File: CandidatesManagerClient.tsx

'use client';

import CandidatesManager from '@/components/matchmaker/new/CandidatesManager/index';
import type { MatchmakerPageDictionary } from '@/types/dictionaries/matchmaker';
import type { ProfilePageDictionary } from '@/types/dictionary';

interface CandidatesManagerClientProps {
  matchmakerDict: MatchmakerPageDictionary;
  profileDict: ProfilePageDictionary;
  locale: string; // ▼▼▼ ADDED: locale prop ▼▼▼
}

export default function CandidatesManagerClient({
  matchmakerDict,
  profileDict,
  locale, // ▼▼▼ ADDED: destructure locale ▼▼▼
}: CandidatesManagerClientProps) {
  // ▼▼▼ CHANGE: Pass the dictionaries and the new locale prop down ▼▼▼
  return (
    <CandidatesManager
      matchmakerDict={matchmakerDict}
      profileDict={profileDict}
      locale={locale}
    />
  );
}
--- End of Content for CandidatesManagerClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\clients\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/matchmaker/clients/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../../i18n-config';
import CandidatesManagerClient from './CandidatesManagerClient';

// הגדרת ה-props הנכונה
type ClientsPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ClientsPage({ params }: ClientsPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <CandidatesManagerClient
      matchmakerDict={dictionary.matchmakerPage}
      profileDict={dictionary.profilePage}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\suggestions
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\suggestions\MatchmakerDashboardPageClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/matchmaker/dashboard/MatchmakerDashboardPageClient.tsx

"use client";

import { Suspense } from "react";
import MatchmakerDashboard from "@/components/matchmaker/suggestions/container/MatchmakerDashboard";
import { Card, CardContent } from "@/components/ui/card";
import type {
  SuggestionsDictionary,
  MatchmakerPageDictionary,
  ProfilePageDictionary,
} from "@/types/dictionary";

// ✅ 1. הגדר את ה-props כפרמטרים נפרדים
interface MatchmakerDashboardPageClientProps {
  suggestionsDict: SuggestionsDictionary;
  matchmakerDict: MatchmakerPageDictionary;
  profileDict: ProfilePageDictionary;
}

// ✅ 2. עדכן את הרכיב כך שיקבל את המילונים הנפרדים
export default function MatchmakerDashboardPageClient({
  suggestionsDict,
  matchmakerDict,
  profileDict,
}: MatchmakerDashboardPageClientProps) {
  return (
    <div className="min-h-screen bg-background">
      <Suspense
        fallback={
          <Card className="m-4">
            <CardContent className="p-6">
              <div className="flex justify-center items-center">
                <div className="text-xl">טוען...</div>
              </div>
            </CardContent>
          </Card>
        }
      >
        {/* ✅ 3. העבר את המילונים הנפרדים הלאה לרכיב MatchmakerDashboard */}
        <MatchmakerDashboard
          suggestionsDict={suggestionsDict}
          matchmakerDict={matchmakerDict}
          profileDict={profileDict}
        />
      </Suspense>
    </div>
  );
}
--- End of Content for MatchmakerDashboardPageClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\suggestions\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/matchmaker/suggestions/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../../i18n-config';
import MatchmakerDashboardPageClient from './MatchmakerDashboardPageClient';
import type {
  MatchmakerPageDictionary,
  SuggestionsDictionary,
  ProfilePageDictionary,
} from '@/types/dictionary';

// הגדרת ה-props הנכונה
type SuggestionsPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function SuggestionsPage({ params }: SuggestionsPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <MatchmakerDashboardPageClient
      suggestionsDict={dictionary.suggestions as SuggestionsDictionary}
      matchmakerDict={dictionary.matchmakerPage as MatchmakerPageDictionary}
      profileDict={dictionary.profilePage as ProfilePageDictionary}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\messages
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\messages\MessagesClientPage.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/messages/MessagesClientPage.tsx
'use client';

import React, { useState, useEffect, useCallback } from 'react';
import { useSession } from 'next-auth/react';
import { Loader2, Inbox, Zap, RefreshCw } from 'lucide-react';
import { AnimatePresence, motion } from 'framer-motion';
import type { FeedItem } from '@/types/messages';
import NotificationCard from '@/components/messages/NotificationCard';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { cn } from '@/lib/utils';
import { Alert, AlertTitle, AlertDescription } from '@/components/ui/alert';
import type { MessagesPageDict } from '@/types/dictionary';
import type { Locale } from '../../../../../i18n-config';

type FilterType = 'all' | 'action_required' | 'updates';

interface MessagesClientPageProps {
  dict: MessagesPageDict;
  locale: Locale;
}

export default function MessagesClientPage({ dict, locale }: MessagesClientPageProps) {
  const { data: session } = useSession();
  const [feedItems, setFeedItems] = useState<FeedItem[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [activeFilter, setActiveFilter] = useState<FilterType>('all');

  const userId = session?.user?.id;

  const fetchFeed = useCallback(async () => {
    setIsLoading(true);
    setError(null);
    try {
      const response = await fetch('/api/messages/feed');
      if (!response.ok) throw new Error('Failed to fetch activity feed');
      const data = await response.json();
      if (data.success) {
        setFeedItems(data.feed);
      } else {
        throw new Error(data.error || 'API returned an error');
      }
    } catch (err) {
      setError(
        err instanceof Error ? err.message : 'An unknown error occurred'
      );
    } finally {
      setIsLoading(false);
    }
  }, []);

  useEffect(() => {
    if (userId) {
      fetchFeed();
    } else {
      setIsLoading(false); 
    }
  }, [userId, fetchFeed]);

  const filteredItems = React.useMemo(() => {
    if (activeFilter === 'all') return feedItems;
    if (activeFilter === 'action_required')
      return feedItems.filter((item) => item.type === 'ACTION_REQUIRED');
    if (activeFilter === 'updates')
      return feedItems.filter(
        (item) =>
          item.type === 'STATUS_UPDATE' || item.type === 'NEW_SUGGESTION'
      );
    return feedItems;
  }, [feedItems, activeFilter]);

  const actionRequiredCount = feedItems.filter(
    (item) => item.type === 'ACTION_REQUIRED'
  ).length;

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-[calc(100vh-80px)]">
        <Loader2 className="h-10 w-10 animate-spin text-cyan-600" />
      </div>
    );
  }

  return (
    <div 
      className="min-h-screen bg-gradient-to-br from-slate-50 via-cyan-50/20 to-emerald-50/20"
      dir={locale === 'he' ? 'rtl' : 'ltr'}
    >
      <div className="container mx-auto px-4 py-8 max-w-4xl">
        <header className="text-center mb-10">
          <h1 className="text-3xl md:text-4xl font-bold bg-gradient-to-r from-purple-600 via-cyan-600 to-emerald-600 bg-clip-text text-transparent mb-3">
            {dict.header.title}
          </h1>
          <p className="text-lg text-gray-600">
            {dict.header.subtitle}
          </p>
        </header>

        <AnimatePresence>
          {actionRequiredCount > 0 && (
            <motion.div
              initial={{ opacity: 0, y: -20, height: 0 }}
              animate={{ opacity: 1, y: 0, height: 'auto' }}
              exit={{ opacity: 0, y: -20, height: 0 }}
              transition={{ duration: 0.5, ease: 'easeInOut' }}
              className="mb-8"
            >
              <Alert className="bg-gradient-to-r from-orange-400 to-amber-400 text-white border-0 shadow-2xl rounded-2xl">
                <Zap className="h-5 w-5 text-white" />
                <AlertTitle className="font-bold text-lg">
                  {actionRequiredCount === 1
                    ? dict.actionBanner.titleSingle
                    : dict.actionBanner.titleMultiple.replace('{{count}}', actionRequiredCount.toString())}
                </AlertTitle>
                <AlertDescription>
                  {dict.actionBanner.description}
                </AlertDescription>
              </Alert>
            </motion.div>
          )}
        </AnimatePresence>

        <div className="flex flex-col sm:flex-row justify-between items-center gap-4 mb-8">
          <div className="flex items-center gap-2 p-1 bg-white/80 backdrop-blur-sm rounded-full shadow-md border border-gray-200">
            <Button
              variant={activeFilter === 'all' ? 'default' : 'ghost'}
              onClick={() => setActiveFilter('all')}
              className="rounded-full"
            >
              {dict.filters.all}
            </Button>
            <Button
              variant={activeFilter === 'action_required' ? 'default' : 'ghost'}
              onClick={() => setActiveFilter('action_required')}
              className="rounded-full relative"
            >
              {dict.filters.actionRequired}
              {actionRequiredCount > 0 && (
                <Badge className="absolute -top-1 -right-2 bg-orange-500 text-white animate-pulse">
                  {actionRequiredCount}
                </Badge>
              )}
            </Button>
            <Button
              variant={activeFilter === 'updates' ? 'default' : 'ghost'}
              onClick={() => setActiveFilter('updates')}
              className="rounded-full"
            >
              {dict.filters.updates}
            </Button>
          </div>
          <Button variant="outline" onClick={fetchFeed} disabled={isLoading}>
            <RefreshCw
              className={cn('w-4 h-4', locale === 'he' ? 'ml-2' : 'mr-2', isLoading && 'animate-spin')}
            />
            {dict.filters.refresh}
          </Button>
        </div>

        {error && (
          <div className="text-center p-4 bg-red-50 text-red-700 rounded-lg">
            {dict.error.replace('{{error}}', error)}
          </div>
        )}

        {filteredItems.length === 0 && !isLoading ? (
          <div className="flex flex-col items-center justify-center min-h-[400px] text-center p-8 bg-white/50 rounded-2xl shadow-inner border border-gray-200/50">
            <Inbox className="w-20 h-20 text-gray-300 mb-6" />
            <h3 className="text-2xl font-bold text-gray-700">{dict.emptyState.title}</h3>
            <p className="text-gray-500 mt-2 max-w-md">
              {activeFilter === 'all'
                ? dict.emptyState.descriptionAll
                : dict.emptyState.descriptionFiltered}
            </p>
          </div>
        ) : (
          <div className="space-y-4">
            <AnimatePresence>
              {filteredItems.map((item, index) => (
                <motion.div
                  key={item.id}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  exit={{ opacity: 0, y: -20 }}
                  transition={{ duration: 0.3, delay: index * 0.05 }}
                >
                  <NotificationCard 
                    item={item} 
                    userId={userId!} 
                    dict={dict.notificationCard}
                    locale={locale}
                  />
                </motion.div>
              ))}
            </AnimatePresence>
          </div>
        )}
      </div>
    </div>
  );
}
--- End of Content for MessagesClientPage.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\messages\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/messages/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import MessagesClientPage from './MessagesClientPage';

// הגדרת ה-props הנכונה
type MessagesPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function MessagesPage({ params }: MessagesPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return <MessagesClientPage dict={dictionary.messagesPage} locale={locale} />;
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\profile
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\profile\ProfilePageClient.tsx
--------------------------------------------------------------------------------
Content:
'use client';

import React, { Suspense } from 'react';
import UnifiedProfileDashboard from '@/components/profile/sections/UnifiedProfileDashboard';
import { useSearchParams } from 'next/navigation';
import { ProfilePageDictionary } from '@/types/dictionary';

// ממשק ה-props של ProfilePageContent מעודכן לכלול את locale
interface ProfilePageContentProps {
  dict: ProfilePageDictionary;
  locale: string; // <-- הוספה
}

// A small wrapper to handle Suspense for useSearchParams
// הקומפוננטה מקבלת עכשיו locale
const ProfilePageContent = ({ dict, locale }: ProfilePageContentProps) => {
  const searchParams = useSearchParams();
   const tabFromUrl = searchParams.get('tab');
  console.log(
    '---[ CLIENT LOG 1 | ProfilePageClient.tsx ]--- קורא את פרמטר ה-URL. הערך של "tab" הוא:',
    tabFromUrl
  );
  const viewOnly = searchParams.get('viewOnly') === 'true';
  const userId = searchParams.get('userId') || undefined;
  const initialTab = searchParams.get('tab') || 'overview';
 console.log(
    `---[ CLIENT LOG 2 | ProfilePageClient.tsx ]--- מגדיר את initialTab לערך "${initialTab}". הערך הזה מועבר ל-UnifiedProfileDashboard.`
  );
  // הערה: אין צורך ב-dir="rtl" כאן, כי הקומפוננטה הפנימית תטפל בזה
  return (
    <div className="min-h-screen bg-background">
      <UnifiedProfileDashboard
        viewOnly={viewOnly}
        userId={userId}
        initialTab={initialTab}
        dict={dict}
        locale={locale} // <-- העברת ה-locale לקומפוננטה
      />
    </div>
  );
};

// ממשק ה-props של ProfilePageClient מעודכן לכלול את locale
interface ProfilePageClientProps {
  dict: ProfilePageDictionary;
  locale: string; // <-- הוספה
}

// רכיב הלקוח הראשי מקבל עכשיו גם את המילון וגם את ה-locale
const ProfilePageClient = ({ dict, locale }: ProfilePageClientProps) => {
  return (
    <Suspense>
      {/* Suspense פנימי עבור useSearchParams */}
      {/* מעבירים את ה-locale הלאה ל-ProfilePageContent */}
      <ProfilePageContent dict={dict} locale={locale} />
    </Suspense>
  );
};

export default ProfilePageClient;
--- End of Content for ProfilePageClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\profile\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/profile/page.tsx
import React, { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '@/../i18n-config';
import ProfilePageClient from './ProfilePageClient';

// הגדרת ה-props הנכונה
type ProfilePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ProfilePage({ params }: ProfilePageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  console.log(
    `---[ SERVER LOG | page.tsx ]--- עמוד הפרופיל נטען עבור שפה: "${locale}".`
  );
  const dictionary = await getDictionary(locale);

  return (
    <Suspense
      fallback={
        <div className="flex items-center justify-center min-h-screen bg-gradient-to-br from-cyan-50 via-white to-pink-50">
          <div className="flex items-center gap-2 text-lg text-cyan-600">
            <Loader2 className="animate-spin h-6 w-6" />
            <span>{dictionary.profilePage.pageLoader}</span>
          </div>
        </div>
      }
    >
      <ProfilePageClient dict={dictionary.profilePage} locale={locale} />
    </Suspense>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\settings
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\settings\SettingsClientPage.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/settings/SettingsClientPage.tsx

"use client";

import { useSession } from "next-auth/react";
import AccountSettings from "@/components/profile/account-settings";
import { Skeleton } from "@/components/ui/skeleton";
import type { AccountSettingsDict } from "@/types/dictionary";
import type { Locale } from "../../../../../i18n-config"; // ✨ שינוי 1: ייבוא טיפוס השפה

// ✨ שינוי 2: עדכון הממשק לקבלת המילון וגם את השפה (locale)
interface SettingsClientPageProps {
  dict: AccountSettingsDict;
  locale: Locale;
}

export default function SettingsClientPage({ dict, locale }: SettingsClientPageProps) {
  const { data: session, status } = useSession();

  if (status === "loading") {
    return (
      <div className="container mx-auto p-6 max-w-2xl">
        <Skeleton className="h-[600px] w-full rounded-2xl" />
      </div>
    );
  }

  if (status === "unauthenticated") {
    return (
      <div className="container mx-auto p-6 text-center text-red-600">
        Access Denied. Please sign in to view your account settings.
      </div>
    );
  }
  
  if (!session?.user) {
    return (
      <div className="container mx-auto p-6 text-center text-red-600">
        Error: Could not load user data. The session might be invalid.
      </div>
    );
  }

  const userData = {
    id: session.user.id,
    email: session.user.email,
    firstName: session.user.firstName,
    lastName: session.user.lastName,
    role: session.user.role,
    status: session.user.status,
    isVerified: session.user.isVerified,
    lastLogin: session.user.lastLogin ?? null,
    createdAt: session.user.createdAt,
    engagementEmailsConsent: session.user.engagementEmailsConsent,
     promotionalEmailsConsent    : session.user.promotionalEmailsConsent    ,
  };

  // ✨ שינוי 3: העברת המילון וה-locale שהתקבלו ב-props לרכיב AccountSettings
  return <AccountSettings user={userData} dict={dict} locale={locale} />;
}
--- End of Content for SettingsClientPage.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\settings\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/settings/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import SettingsClientPage from './SettingsClientPage';
import { redirect } from 'next/navigation';
import { getServerSession } from 'next-auth';
import { authOptions } from '@/lib/auth';

// הגדרת ה-props הנכונה
type SettingsPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function SettingsPage({ params }: SettingsPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const session = await getServerSession(authOptions);
  if (!session?.user) {
    redirect(`/${locale}/auth/signin?callbackUrl=/${locale}/settings`);
  }

  const dictionary = await getDictionary(locale);

  return (
    <div className="container mx-auto p-4 sm:p-6">
      <SettingsClientPage
        dict={dictionary.profilePage.accountSettings}
        locale={locale}
      />
    </div>
  );
}
--- End of Content for page.tsx ---

--- End of Content for (authenticated)_contents.txt ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\admin
================================================================================

(This directory contains subdirectories but no files directly. See subdirectories below.)

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\admin\engagement
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\admin\engagement\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/admin/engagement/page.tsx
import { getServerSession } from 'next-auth';
import { redirect } from 'next/navigation';
import EngagementDashboard from '@/components/admin/EngagementDashboard';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../../i18n-config';
import { authOptions } from '@/lib/auth';

// הגדרת ה-props הנכונה
type EngagementPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function EngagementPage({ params }: EngagementPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const session = await getServerSession(authOptions);

  if (session?.user?.role !== 'ADMIN') {
    redirect('/');
  }

  const dict = await getDictionary(locale);

  return <EngagementDashboard dict={dict} />;
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matches
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matches\MatchesClientPage.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/matches/MatchesClientPage.tsx

'use client';

import { useSession } from 'next-auth/react';
import MatchSuggestionsContainer from '@/components/suggestions/MatchSuggestionsContainer';
import { Skeleton } from '@/components/ui/skeleton';
import type {
  SuggestionsDictionary,
  ProfileCardDict,
} from '@/types/dictionary';

/**
 * הממשק (interface) מגדיר את ה-props שהרכיב הזה מקבל.
 * הוא מצפה לקבל אובייקט 'dict' המכיל את שני מילוני התרגום
 * הדרושים לו ולרכיבי הילד שלו: מילון ההצעות ומילון כרטיס הפרופיל.
 */
interface MatchesClientPageProps {
  suggestionsDict: SuggestionsDictionary;
  profileCardDict: ProfileCardDict;
}

/**
 * רכיב צד-לקוח (Client Component) האחראי על הצגת עמוד ההצעות.
 * הוא מנהל את אימות המשתמש ומעביר את הנתונים והתרגומים לרכיב התצוגה הראשי.
 */
export default function MatchesClientPage({ suggestionsDict, profileCardDict }: MatchesClientPageProps) {
  // קבלת נתוני המשתמש והסטטוס של החיבור
  const { data: session, status } = useSession();

  // בזמן שהחיבור מתבצע, הצג שלד טעינה (skeleton)
  if (status === 'loading') {
    return (
      <div className="container mx-auto p-6 space-y-4">
        <Skeleton className="h-48 w-full rounded-2xl" />
        <Skeleton className="h-48 w-full rounded-2xl" />
        <Skeleton className="h-48 w-full rounded-2xl" />
      </div>
    );
  }

  // אם המשתמש אינו מחובר, הצג הודעה מתאימה
  if (!session?.user?.id) {
    // ניתן להוסיף כאן רכיב מעוצב יותר או הפנייה לדף ההתחברות
    return (
      <div className="container mx-auto p-6 text-center text-red-600">
        אינך מורשה לצפות בדף זה. יש להתחבר למערכת.
      </div>
    );
  }

  // אם המשתמש מחובר, רנדר את קונטיינר ההצעות והעבר לו את הנתונים הנדרשים
  return (
    <MatchSuggestionsContainer
      userId={session.user.id}
      suggestionsDict={suggestionsDict}
      profileCardDict={profileCardDict}
    />
  );
}
--- End of Content for MatchesClientPage.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matches\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/matches/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import MatchesClientPage from './MatchesClientPage';

// הגדרת ה-props הנכונה
type MatchesPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function MatchesPage({ params }: MatchesPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <MatchesClientPage
      suggestionsDict={dictionary.suggestions}
      profileCardDict={dictionary.profilePage.profileCard}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker
================================================================================

(This directory contains subdirectories but no files directly. See subdirectories below.)

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\clients
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\clients\CandidatesManagerClient.tsx
--------------------------------------------------------------------------------
Content:
// File: CandidatesManagerClient.tsx

'use client';

import CandidatesManager from '@/components/matchmaker/new/CandidatesManager/index';
import type { MatchmakerPageDictionary } from '@/types/dictionaries/matchmaker';
import type { ProfilePageDictionary } from '@/types/dictionary';

interface CandidatesManagerClientProps {
  matchmakerDict: MatchmakerPageDictionary;
  profileDict: ProfilePageDictionary;
  locale: string; // ▼▼▼ ADDED: locale prop ▼▼▼
}

export default function CandidatesManagerClient({
  matchmakerDict,
  profileDict,
  locale, // ▼▼▼ ADDED: destructure locale ▼▼▼
}: CandidatesManagerClientProps) {
  // ▼▼▼ CHANGE: Pass the dictionaries and the new locale prop down ▼▼▼
  return (
    <CandidatesManager
      matchmakerDict={matchmakerDict}
      profileDict={profileDict}
      locale={locale}
    />
  );
}
--- End of Content for CandidatesManagerClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\clients\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/matchmaker/clients/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../../i18n-config';
import CandidatesManagerClient from './CandidatesManagerClient';

// הגדרת ה-props הנכונה
type ClientsPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ClientsPage({ params }: ClientsPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <CandidatesManagerClient
      matchmakerDict={dictionary.matchmakerPage}
      profileDict={dictionary.profilePage}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\suggestions
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\suggestions\MatchmakerDashboardPageClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/matchmaker/dashboard/MatchmakerDashboardPageClient.tsx

"use client";

import { Suspense } from "react";
import MatchmakerDashboard from "@/components/matchmaker/suggestions/container/MatchmakerDashboard";
import { Card, CardContent } from "@/components/ui/card";
import type {
  SuggestionsDictionary,
  MatchmakerPageDictionary,
  ProfilePageDictionary,
} from "@/types/dictionary";

// ✅ 1. הגדר את ה-props כפרמטרים נפרדים
interface MatchmakerDashboardPageClientProps {
  suggestionsDict: SuggestionsDictionary;
  matchmakerDict: MatchmakerPageDictionary;
  profileDict: ProfilePageDictionary;
}

// ✅ 2. עדכן את הרכיב כך שיקבל את המילונים הנפרדים
export default function MatchmakerDashboardPageClient({
  suggestionsDict,
  matchmakerDict,
  profileDict,
}: MatchmakerDashboardPageClientProps) {
  return (
    <div className="min-h-screen bg-background">
      <Suspense
        fallback={
          <Card className="m-4">
            <CardContent className="p-6">
              <div className="flex justify-center items-center">
                <div className="text-xl">טוען...</div>
              </div>
            </CardContent>
          </Card>
        }
      >
        {/* ✅ 3. העבר את המילונים הנפרדים הלאה לרכיב MatchmakerDashboard */}
        <MatchmakerDashboard
          suggestionsDict={suggestionsDict}
          matchmakerDict={matchmakerDict}
          profileDict={profileDict}
        />
      </Suspense>
    </div>
  );
}
--- End of Content for MatchmakerDashboardPageClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\matchmaker\suggestions\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/matchmaker/suggestions/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../../i18n-config';
import MatchmakerDashboardPageClient from './MatchmakerDashboardPageClient';
import type {
  MatchmakerPageDictionary,
  SuggestionsDictionary,
  ProfilePageDictionary,
} from '@/types/dictionary';

// הגדרת ה-props הנכונה
type SuggestionsPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function SuggestionsPage({ params }: SuggestionsPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <MatchmakerDashboardPageClient
      suggestionsDict={dictionary.suggestions as SuggestionsDictionary}
      matchmakerDict={dictionary.matchmakerPage as MatchmakerPageDictionary}
      profileDict={dictionary.profilePage as ProfilePageDictionary}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\messages
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\messages\MessagesClientPage.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/messages/MessagesClientPage.tsx
'use client';

import React, { useState, useEffect, useCallback } from 'react';
import { useSession } from 'next-auth/react';
import { Loader2, Inbox, Zap, RefreshCw } from 'lucide-react';
import { AnimatePresence, motion } from 'framer-motion';
import type { FeedItem } from '@/types/messages';
import NotificationCard from '@/components/messages/NotificationCard';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { cn } from '@/lib/utils';
import { Alert, AlertTitle, AlertDescription } from '@/components/ui/alert';
import type { MessagesPageDict } from '@/types/dictionary';
import type { Locale } from '../../../../../i18n-config';

type FilterType = 'all' | 'action_required' | 'updates';

interface MessagesClientPageProps {
  dict: MessagesPageDict;
  locale: Locale;
}

export default function MessagesClientPage({ dict, locale }: MessagesClientPageProps) {
  const { data: session } = useSession();
  const [feedItems, setFeedItems] = useState<FeedItem[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [activeFilter, setActiveFilter] = useState<FilterType>('all');

  const userId = session?.user?.id;

  const fetchFeed = useCallback(async () => {
    setIsLoading(true);
    setError(null);
    try {
      const response = await fetch('/api/messages/feed');
      if (!response.ok) throw new Error('Failed to fetch activity feed');
      const data = await response.json();
      if (data.success) {
        setFeedItems(data.feed);
      } else {
        throw new Error(data.error || 'API returned an error');
      }
    } catch (err) {
      setError(
        err instanceof Error ? err.message : 'An unknown error occurred'
      );
    } finally {
      setIsLoading(false);
    }
  }, []);

  useEffect(() => {
    if (userId) {
      fetchFeed();
    } else {
      setIsLoading(false); 
    }
  }, [userId, fetchFeed]);

  const filteredItems = React.useMemo(() => {
    if (activeFilter === 'all') return feedItems;
    if (activeFilter === 'action_required')
      return feedItems.filter((item) => item.type === 'ACTION_REQUIRED');
    if (activeFilter === 'updates')
      return feedItems.filter(
        (item) =>
          item.type === 'STATUS_UPDATE' || item.type === 'NEW_SUGGESTION'
      );
    return feedItems;
  }, [feedItems, activeFilter]);

  const actionRequiredCount = feedItems.filter(
    (item) => item.type === 'ACTION_REQUIRED'
  ).length;

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-[calc(100vh-80px)]">
        <Loader2 className="h-10 w-10 animate-spin text-cyan-600" />
      </div>
    );
  }

  return (
    <div 
      className="min-h-screen bg-gradient-to-br from-slate-50 via-cyan-50/20 to-emerald-50/20"
      dir={locale === 'he' ? 'rtl' : 'ltr'}
    >
      <div className="container mx-auto px-4 py-8 max-w-4xl">
        <header className="text-center mb-10">
          <h1 className="text-3xl md:text-4xl font-bold bg-gradient-to-r from-purple-600 via-cyan-600 to-emerald-600 bg-clip-text text-transparent mb-3">
            {dict.header.title}
          </h1>
          <p className="text-lg text-gray-600">
            {dict.header.subtitle}
          </p>
        </header>

        <AnimatePresence>
          {actionRequiredCount > 0 && (
            <motion.div
              initial={{ opacity: 0, y: -20, height: 0 }}
              animate={{ opacity: 1, y: 0, height: 'auto' }}
              exit={{ opacity: 0, y: -20, height: 0 }}
              transition={{ duration: 0.5, ease: 'easeInOut' }}
              className="mb-8"
            >
              <Alert className="bg-gradient-to-r from-orange-400 to-amber-400 text-white border-0 shadow-2xl rounded-2xl">
                <Zap className="h-5 w-5 text-white" />
                <AlertTitle className="font-bold text-lg">
                  {actionRequiredCount === 1
                    ? dict.actionBanner.titleSingle
                    : dict.actionBanner.titleMultiple.replace('{{count}}', actionRequiredCount.toString())}
                </AlertTitle>
                <AlertDescription>
                  {dict.actionBanner.description}
                </AlertDescription>
              </Alert>
            </motion.div>
          )}
        </AnimatePresence>

        <div className="flex flex-col sm:flex-row justify-between items-center gap-4 mb-8">
          <div className="flex items-center gap-2 p-1 bg-white/80 backdrop-blur-sm rounded-full shadow-md border border-gray-200">
            <Button
              variant={activeFilter === 'all' ? 'default' : 'ghost'}
              onClick={() => setActiveFilter('all')}
              className="rounded-full"
            >
              {dict.filters.all}
            </Button>
            <Button
              variant={activeFilter === 'action_required' ? 'default' : 'ghost'}
              onClick={() => setActiveFilter('action_required')}
              className="rounded-full relative"
            >
              {dict.filters.actionRequired}
              {actionRequiredCount > 0 && (
                <Badge className="absolute -top-1 -right-2 bg-orange-500 text-white animate-pulse">
                  {actionRequiredCount}
                </Badge>
              )}
            </Button>
            <Button
              variant={activeFilter === 'updates' ? 'default' : 'ghost'}
              onClick={() => setActiveFilter('updates')}
              className="rounded-full"
            >
              {dict.filters.updates}
            </Button>
          </div>
          <Button variant="outline" onClick={fetchFeed} disabled={isLoading}>
            <RefreshCw
              className={cn('w-4 h-4', locale === 'he' ? 'ml-2' : 'mr-2', isLoading && 'animate-spin')}
            />
            {dict.filters.refresh}
          </Button>
        </div>

        {error && (
          <div className="text-center p-4 bg-red-50 text-red-700 rounded-lg">
            {dict.error.replace('{{error}}', error)}
          </div>
        )}

        {filteredItems.length === 0 && !isLoading ? (
          <div className="flex flex-col items-center justify-center min-h-[400px] text-center p-8 bg-white/50 rounded-2xl shadow-inner border border-gray-200/50">
            <Inbox className="w-20 h-20 text-gray-300 mb-6" />
            <h3 className="text-2xl font-bold text-gray-700">{dict.emptyState.title}</h3>
            <p className="text-gray-500 mt-2 max-w-md">
              {activeFilter === 'all'
                ? dict.emptyState.descriptionAll
                : dict.emptyState.descriptionFiltered}
            </p>
          </div>
        ) : (
          <div className="space-y-4">
            <AnimatePresence>
              {filteredItems.map((item, index) => (
                <motion.div
                  key={item.id}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  exit={{ opacity: 0, y: -20 }}
                  transition={{ duration: 0.3, delay: index * 0.05 }}
                >
                  <NotificationCard 
                    item={item} 
                    userId={userId!} 
                    dict={dict.notificationCard}
                    locale={locale}
                  />
                </motion.div>
              ))}
            </AnimatePresence>
          </div>
        )}
      </div>
    </div>
  );
}
--- End of Content for MessagesClientPage.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\messages\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/messages/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import MessagesClientPage from './MessagesClientPage';

// הגדרת ה-props הנכונה
type MessagesPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function MessagesPage({ params }: MessagesPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return <MessagesClientPage dict={dictionary.messagesPage} locale={locale} />;
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\profile
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\profile\ProfilePageClient.tsx
--------------------------------------------------------------------------------
Content:
'use client';

import React, { Suspense } from 'react';
import UnifiedProfileDashboard from '@/components/profile/sections/UnifiedProfileDashboard';
import { useSearchParams } from 'next/navigation';
import { ProfilePageDictionary } from '@/types/dictionary';

// ממשק ה-props של ProfilePageContent נשאר כפי שהוא
interface ProfilePageContentProps {
  dict: ProfilePageDictionary;
  locale: 'he' | 'en';
}

// קומפוננטת התוכן
const ProfilePageContent = ({ dict, locale }: ProfilePageContentProps) => {
  const searchParams = useSearchParams();
  const tabFromUrl = searchParams.get('tab');
  console.log(
    '---[ CLIENT LOG 1 | ProfilePageClient.tsx ]--- קורא את פרמטר ה-URL. הערך של "tab" הוא:',
    tabFromUrl
  );
  const viewOnly = searchParams.get('viewOnly') === 'true';
  const userId = searchParams.get('userId') || undefined;
  const initialTab = searchParams.get('tab') || 'overview';
  console.log(
    `---[ CLIENT LOG 2 | ProfilePageClient.tsx ]--- מגדיר את initialTab לערך "${initialTab}". הערך הזה מועבר ל-UnifiedProfileDashboard.`
  );
  
  return (
    <div className="min-h-screen bg-background">
      <UnifiedProfileDashboard
        viewOnly={viewOnly}
        userId={userId}
        initialTab={initialTab}
        dict={dict}
        locale={locale} // <-- העברת ה-locale לקומפוננטה
      />
    </div>
  );
};

// ממשק ה-props של ProfilePageClient עודכן
interface ProfilePageClientProps {
  dict: ProfilePageDictionary;
  locale: 'he' | 'en'; // <--- ✨ התיקון כאן
}

// רכיב הלקוח הראשי
const ProfilePageClient = ({ dict, locale }: ProfilePageClientProps) => {
  return (
    <Suspense>
      {/* Suspense פנימי עבור useSearchParams */}
      {/* מעבירים את ה-locale הלאה ל-ProfilePageContent */}
      <ProfilePageContent dict={dict} locale={locale} />
    </Suspense>
  );
};

export default ProfilePageClient;
--- End of Content for ProfilePageClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\profile\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/profile/page.tsx
import React, { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '@/../i18n-config';
import ProfilePageClient from './ProfilePageClient';

// הגדרת ה-props הנכונה
type ProfilePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ProfilePage({ params }: ProfilePageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  console.log(
    `---[ SERVER LOG | page.tsx ]--- עמוד הפרופיל נטען עבור שפה: "${locale}".`
  );
  const dictionary = await getDictionary(locale);

  return (
    <Suspense
      fallback={
        <div className="flex items-center justify-center min-h-screen bg-gradient-to-br from-cyan-50 via-white to-pink-50">
          <div className="flex items-center gap-2 text-lg text-cyan-600">
            <Loader2 className="animate-spin h-6 w-6" />
            <span>{dictionary.profilePage.pageLoader}</span>
          </div>
        </div>
      }
    >
      <ProfilePageClient dict={dictionary.profilePage} locale={locale} />
    </Suspense>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\settings
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\settings\SettingsClientPage.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/settings/SettingsClientPage.tsx

"use client";

import { useSession } from "next-auth/react";
import AccountSettings from "@/components/profile/account-settings";
import { Skeleton } from "@/components/ui/skeleton";
import type { AccountSettingsDict } from "@/types/dictionary";
import type { Locale } from "../../../../../i18n-config"; // ✨ שינוי 1: ייבוא טיפוס השפה

// ✨ שינוי 2: עדכון הממשק לקבלת המילון וגם את השפה (locale)
interface SettingsClientPageProps {
  dict: AccountSettingsDict;
  locale: Locale;
}

export default function SettingsClientPage({ dict, locale }: SettingsClientPageProps) {
  const { data: session, status } = useSession();

  if (status === "loading") {
    return (
      <div className="container mx-auto p-6 max-w-2xl">
        <Skeleton className="h-[600px] w-full rounded-2xl" />
      </div>
    );
  }

  if (status === "unauthenticated") {
    return (
      <div className="container mx-auto p-6 text-center text-red-600">
        Access Denied. Please sign in to view your account settings.
      </div>
    );
  }
  
  if (!session?.user) {
    return (
      <div className="container mx-auto p-6 text-center text-red-600">
        Error: Could not load user data. The session might be invalid.
      </div>
    );
  }

  const userData = {
    id: session.user.id,
    email: session.user.email,
    firstName: session.user.firstName,
    lastName: session.user.lastName,
    role: session.user.role,
    status: session.user.status,
    isVerified: session.user.isVerified,
    lastLogin: session.user.lastLogin ?? null,
    createdAt: session.user.createdAt,
    engagementEmailsConsent: session.user.engagementEmailsConsent,
     promotionalEmailsConsent    : session.user.promotionalEmailsConsent    ,
  };

  // ✨ שינוי 3: העברת המילון וה-locale שהתקבלו ב-props לרכיב AccountSettings
  return <AccountSettings user={userData} dict={dict} locale={locale} />;
}
--- End of Content for SettingsClientPage.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\(authenticated)\settings\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/(authenticated)/settings/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import SettingsClientPage from './SettingsClientPage';
import { redirect } from 'next/navigation';
import { getServerSession } from 'next-auth';
import { authOptions } from '@/lib/auth';

// הגדרת ה-props הנכונה
type SettingsPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function SettingsPage({ params }: SettingsPageProps) {
  // שימוש ב-await כדי לחלץ את המידע מה-Promise
  const { locale } = await params;
  const session = await getServerSession(authOptions);
  if (!session?.user) {
    redirect(`/${locale}/auth/signin?callbackUrl=/${locale}/settings`);
  }

  const dictionary = await getDictionary(locale);

  return (
    <div className="container mx-auto p-4 sm:p-6">
      <SettingsClientPage
        dict={dictionary.profilePage.accountSettings}
        locale={locale}
      />
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\auth_contents.txt
--------------------------------------------------------------------------------
Content:
################################################################################
# Directory Content Map For: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth
# Generated on: 2025-11-26 12:22:06
################################################################################

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\auth_contents.txt
--------------------------------------------------------------------------------
[This is the output log file itself. Content not included.]

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\error
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\error\AuthErrorClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/error/AuthErrorClient.tsx
'use client';

import { useSearchParams, useRouter } from "next/navigation";
import { Card, CardHeader, CardTitle, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { AlertTriangle } from "lucide-react";
import type { AuthErrorDict } from '@/types/dictionaries/auth';

interface AuthErrorClientProps {
    dict: AuthErrorDict;
}

export default function AuthErrorClient({ dict }: AuthErrorClientProps) {
  const searchParams = useSearchParams();
  const router = useRouter();
  const error = searchParams.get("error");

  const getErrorMessage = (error: string | null) => {
    switch (error) {
      case "CredentialsSignin":
        return dict.errors.CredentialsSignin;
      case "OAuthAccountNotLinked":
        return dict.errors.OAuthAccountNotLinked;
      default:
        return dict.errors.Default;
    }
  };

  return (
    <Card className="w-full max-w-md">
      <CardHeader className="text-center">
        <AlertTriangle className="mx-auto h-12 w-12 text-red-500" />
        <CardTitle className="text-2xl font-bold text-red-600 mt-4">
          {dict.title}
        </CardTitle>
      </CardHeader>
      <CardContent className="space-y-4 text-center">
        <p className="text-gray-600">{getErrorMessage(error)}</p>
        <Button onClick={() => router.push("/auth/signin")} className="w-full">
          {dict.backButton}
        </Button>
      </CardContent>
    </Card>
  );
}
--- End of Content for AuthErrorClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\error\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/error/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import AuthErrorClient from './AuthErrorClient';

function Loading() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <Loader2 className="h-8 w-8 animate-spin text-gray-500" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼

// 1. הגדרת טיפוס (type) נכון עבור ה-props
type ErrorPageProps = {
  params: Promise<{ locale: Locale }>;
};

// 2. עדכון חתימת הפונקציה והוספת await
export default async function ErrorPage({ params }: ErrorPageProps) {
  const { locale } = await params; // <-- הוספת await
  const dictionary = await getDictionary(locale);

  return (
    <div className="min-h-screen flex items-center justify-center p-4 bg-gray-50">
      <Suspense fallback={<Loading />}>
        <AuthErrorClient dict={dictionary.auth.errorPage} />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\forgot-password
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\forgot-password\ForgotPasswordClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/forgot-password/ForgotPasswordClient.tsx
'use client';

import { useState, FormEvent } from 'react';
import { useRouter } from 'next/navigation';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import {
  Mail,
  Loader2,
  AlertCircle,
  ArrowLeft,
  ArrowRight,
  Send,
  KeyRound,
  Sparkles,
  CheckCircle2,
} from 'lucide-react';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import type { ForgotPasswordDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface ForgotPasswordClientProps {
  dict: ForgotPasswordDict;
  locale: 'he' | 'en';
}

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

// ============================================================================
// BACKGROUND COMPONENT
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-cyan-400/20 to-blue-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-pink-400/20 to-purple-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-orange-400/15 to-red-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />

    {/* Dot Pattern */}
    <div className="absolute inset-0 opacity-[0.03] bg-[radial-gradient(#06b6d4_1px,transparent_1px)] [background-size:24px_24px]" />

    {/* SVG Decorative Wave */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1000 1000"
      xmlns="http://www.w3.org/2000/svg"
      preserveAspectRatio="none"
    >
      <defs>
        <linearGradient id="waveGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stopColor="#06b6d4" stopOpacity="0.08" />
          <stop offset="100%" stopColor="#ec4899" stopOpacity="0.04" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,200 C300,100 700,300 1000,200 L1000,0 L0,0 Z"
        fill="url(#waveGrad)"
        initial={{ opacity: 0.6 }}
        animate={{ opacity: [0.6, 0.9, 0.6] }}
        transition={{ duration: 8, repeat: Infinity, ease: 'easeInOut' }}
      />
    </svg>
  </div>
);

// ============================================================================
// MAIN COMPONENT
// ============================================================================

export default function ForgotPasswordClient({
  dict,
  locale,
}: ForgotPasswordClientProps) {
  const router = useRouter();
  const [email, setEmail] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);

  const isRTL = locale === 'he';

  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);

    if (!email) {
      setError(dict.errors.missingEmail);
      setIsLoading(false);
      return;
    }

    try {
      const response = await fetch(
        `/api/auth/request-password-reset?locale=${locale}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email }),
        }
      );

      const data = await response.json();

      if (!response.ok || !data.success) {
        throw new Error(data.error || dict.errors.default);
      }

      // Show success message before redirect
      setSuccess(true);

      // Redirect after showing success
      setTimeout(() => {
        router.push(
          `/${locale}/auth/reset-password?email=${encodeURIComponent(email)}`
        );
      }, 1500);
    } catch (err) {
      setError(err instanceof Error ? err.message : dict.errors.default);
      setIsLoading(false);
    }
  };

  return (
    <>
      <DynamicBackground />

      <div className="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8 relative z-10">
        {/* Back to Sign In Link */}
        <motion.div
          initial={{ opacity: 0, x: isRTL ? 20 : -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.5 }}
          className={`absolute top-6 ${isRTL ? 'right-6' : 'left-6'}`}
        >
          <Link
            href={`/${locale}/auth/signin`}
            className="group flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors duration-300"
          >
            {isRTL ? (
              <ArrowRight className="w-4 h-4 group-hover:translate-x-1 transition-transform" />
            ) : (
              <ArrowLeft className="w-4 h-4 group-hover:-translate-x-1 transition-transform" />
            )}
            <span className="text-sm font-medium">
              {locale === 'he' ? 'חזרה להתחברות' : 'Back to Sign In'}
            </span>
          </Link>
        </motion.div>

        {/* Hero Section */}
        <motion.div
          variants={containerVariants}
          initial="hidden"
          animate="visible"
          className="mb-8 text-center"
        >
          <motion.div variants={itemVariants} className="mb-4">
            <div className="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-cyan-400 to-purple-500 rounded-2xl shadow-lg mb-6">
              <motion.div
                animate={{
                  rotate: [0, -10, 10, -10, 0],
                  scale: [1, 1.1, 1],
                }}
                transition={{
                  duration: 3,
                  repeat: Infinity,
                  ease: 'easeInOut',
                }}
              >
                <KeyRound className="w-10 h-10 text-white" />
              </motion.div>
            </div>
          </motion.div>

          <motion.h1
            variants={itemVariants}
            className="text-3xl md:text-4xl font-bold mb-3"
          >
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 animate-gradient-slow">
              {dict.title}
            </span>
          </motion.h1>

          <motion.p
            variants={itemVariants}
            className="text-gray-600 text-base md:text-lg max-w-md mx-auto px-4"
          >
            {dict.subtitle}
          </motion.p>

          {/* Decorative Line */}
          <motion.div variants={itemVariants} className="relative mt-6">
            <div className="w-20 h-1 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 rounded-full mx-auto" />
          </motion.div>
        </motion.div>

        {/* Main Card */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5, delay: 0.3 }}
          className="w-full max-w-md"
        >
          <div className="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/60 overflow-hidden relative">
            {/* Top Gradient Line */}
            <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400" />

            {/* Decorative Elements */}
            <div className="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-cyan-400/10 to-transparent rounded-full transform translate-x-20 -translate-y-20 pointer-events-none" />
            <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-pink-400/10 to-transparent rounded-full transform -translate-x-16 translate-y-16 pointer-events-none" />

            <div className="relative z-10 p-6 sm:p-8">
              {/* Success State */}
              <AnimatePresence mode="wait">
                {success ? (
                  <motion.div
                    key="success"
                    initial={{ opacity: 0, scale: 0.9 }}
                    animate={{ opacity: 1, scale: 1 }}
                    exit={{ opacity: 0, scale: 0.9 }}
                    className="text-center py-8"
                  >
                    <motion.div
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      transition={{ delay: 0.2, type: 'spring', stiffness: 200 }}
                      className="inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-6"
                    >
                      <CheckCircle2 className="w-10 h-10 text-green-600" />
                    </motion.div>

                    <motion.h2
                      initial={{ opacity: 0, y: 10 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ delay: 0.3 }}
                      className="text-2xl font-bold text-gray-800 mb-3"
                    >
                      {locale === 'he' ? 'נשלח בהצלחה!' : 'Email Sent!'}
                    </motion.h2>

                    <motion.p
                      initial={{ opacity: 0, y: 10 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ delay: 0.4 }}
                      className="text-gray-600 mb-6"
                    >
                      {locale === 'he'
                        ? 'מעביר אותך לדף איפוס הסיסמה...'
                        : 'Redirecting to reset password...'}
                    </motion.p>

                    <motion.div
                      initial={{ opacity: 0 }}
                      animate={{ opacity: 1 }}
                      transition={{ delay: 0.5 }}
                    >
                      <Loader2 className="w-6 h-6 animate-spin text-cyan-500 mx-auto" />
                    </motion.div>
                  </motion.div>
                ) : (
                  <motion.div
                    key="form"
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                  >
                    {/* Info Box */}
                    <motion.div
                      initial={{ opacity: 0, y: -10 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ delay: 0.2 }}
                      className="mb-6 p-4 bg-gradient-to-r from-cyan-50 to-purple-50 rounded-2xl border border-cyan-100"
                    >
                      <div className="flex items-start gap-3">
                        <div className="p-2 bg-white rounded-lg flex-shrink-0">
                          <Sparkles className="w-5 h-5 text-cyan-500" />
                        </div>
                        <p className="text-sm text-gray-700 leading-relaxed pt-1">
                          {locale === 'he'
                            ? 'נשלח לך קישור לאיפוס הסיסמה למייל שרשמת'
                            : "We'll send you a link to reset your password"}
                        </p>
                      </div>
                    </motion.div>

                    {/* Error Alert */}
                    <AnimatePresence>
                      {error && (
                        <motion.div
                          initial={{ opacity: 0, y: -10, height: 0 }}
                          animate={{ opacity: 1, y: 0, height: 'auto' }}
                          exit={{ opacity: 0, y: -10, height: 0 }}
                          className="mb-6"
                        >
                          <Alert variant="destructive" className="border-2">
                            <div className="flex items-start gap-3">
                              <div className="p-2 bg-red-100 rounded-lg flex-shrink-0">
                                <AlertCircle className="h-5 w-5 text-red-600" />
                              </div>
                              <div className="flex-1">
                                <AlertTitle className="font-bold mb-1">
                                  {dict.errors.title}
                                </AlertTitle>
                                <AlertDescription className="text-sm">
                                  {error}
                                </AlertDescription>
                              </div>
                            </div>
                          </Alert>
                        </motion.div>
                      )}
                    </AnimatePresence>

                    {/* Form */}
                    <form onSubmit={handleSubmit} className="space-y-6">
                      {/* Email Field */}
                      <div className="space-y-2">
                        <label
                          htmlFor="email-forgot"
                          className="block text-sm font-semibold text-gray-700"
                        >
                          {dict.emailLabel}
                        </label>
                        <div className="relative group">
                          <div
                            className={`absolute ${isRTL ? 'right-3' : 'left-3'} top-1/2 transform -translate-y-1/2 transition-colors ${
                              email ? 'text-cyan-500' : 'text-gray-400'
                            }`}
                          >
                            <Mail className="h-5 w-5" />
                          </div>
                          <Input
                            type="email"
                            id="email-forgot"
                            value={email}
                            onChange={(e) => setEmail(e.target.value)}
                            placeholder={dict.emailPlaceholder}
                            required
                            className={`w-full ${isRTL ? 'pr-11 pl-4' : 'pl-11 pr-4'} py-3.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-cyan-200 focus:border-cyan-400 focus:outline-none transition-all bg-white/50 backdrop-blur-sm hover:border-gray-300 text-gray-800 placeholder:text-gray-400`}
                            disabled={isLoading}
                            dir={isRTL ? 'rtl' : 'ltr'}
                          />
                        </div>
                      </div>

                      {/* Submit Button */}
                      <Button
                        type="submit"
                        disabled={isLoading}
                        className="w-full py-4 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 hover:from-cyan-600 hover:via-purple-600 hover:to-pink-600 shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2 rounded-xl text-base font-semibold group relative overflow-hidden"
                      >
                        {/* Shine effect */}
                        <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000" />

                        {isLoading ? (
                          <>
                            <Loader2 className="h-5 w-5 animate-spin" />
                            <span>{dict.submitButtonLoading}</span>
                          </>
                        ) : (
                          <>
                            <Send className="w-5 h-5" />
                            <span>{dict.submitButton}</span>
                          </>
                        )}
                      </Button>
                    </form>

                    {/* Back Link */}
                    <div className="mt-8 text-center">
                      <p className="text-gray-600 text-sm">
                        {locale === 'he' ? 'זכרת את הסיסמה?' : 'Remember your password?'}{' '}
                        <Link
                          href={`/${locale}/auth/signin`}
                          className="text-cyan-600 font-semibold hover:text-cyan-700 hover:underline transition-colors inline-flex items-center gap-1"
                        >
                          {dict.backToSignInLink}
                          {isRTL ? (
                            <ArrowLeft className="w-3 h-3" />
                          ) : (
                            <ArrowRight className="w-3 h-3" />
                          )}
                        </Link>
                      </p>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>

            {/* Bottom Shine Effect */}
            <div className="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 opacity-50" />
          </div>
        </motion.div>

        {/* Help Text */}
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.8, duration: 0.5 }}
          className="mt-8 text-center max-w-md"
        >
          <p className="text-xs text-gray-500">
            {locale === 'he'
              ? 'לא קיבלת מייל? בדוק את תיקיית הספאם או נסה שוב'
              : "Didn't receive an email? Check your spam folder or try again"}
          </p>
        </motion.div>
      </div>

      {/* Animations CSS */}
      <style>{`
        @keyframes gradient-slow {
          0%,
          100% {
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
        }
        .animate-gradient-slow {
          background-size: 200% 200%;
          animation: gradient-slow 6s ease infinite;
        }
      `}</style>
    </>
  );
}
--- End of Content for ForgotPasswordClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\forgot-password\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/forgot-password/page.tsx
import Link from 'next/link';
import { ArrowLeft } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import ForgotPasswordClient from './ForgotPasswordClient';

// ▼▼▼ כאן השינוי ▼▼▼
type ForgotPasswordPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ForgotPasswordPage({ params }: ForgotPasswordPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-cyan-50 via-white to-pink-50 p-4 sm:p-8">
      <Link
        href="/"
        className="absolute top-4 left-4 rtl:right-4 rtl:left-auto text-gray-600 hover:text-gray-800 transition-colors flex items-center gap-1 text-sm z-20"
      >
        <ArrowLeft
          className={`h-4 w-4 ${locale === 'he' ? 'transform rotate-180' : ''}`}
        />{' '}
        חזרה לדף הבית
      </Link>
      <ForgotPasswordClient
        dict={dictionary.auth.forgotPassword}
        locale={locale}
      />
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\register
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\register\RegisterClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/register/RegisterClient.tsx
'use client';

import React, { useEffect, useState } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { useSession } from 'next-auth/react';
import {
  RegistrationProvider,
  useRegistration,
} from '@/components/auth/RegistrationContext';
import Link from 'next/link';
import { motion, AnimatePresence } from 'framer-motion';
import {
  Info,
  Loader2,
  Sparkles,
  Heart,
  Shield,
  ArrowRight,
  ArrowLeft,
} from 'lucide-react';

// Import step components
import WelcomeStep from '@/components/auth/steps/WelcomeStep';
import BasicInfoStep from '@/components/auth/steps/BasicInfoStep';
import EmailVerificationCodeStep from '@/components/auth/steps/EmailVerificationCodeStep';
import PersonalDetailsStep from '@/components/auth/steps/PersonalDetailsStep';
import CompleteStep from '@/components/auth/steps/CompleteStep';
import ProgressBar from '@/components/auth/ProgressBar';

import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import type { User as SessionUserType } from '@/types/next-auth';
import type { RegisterStepsDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface RegisterClientProps {
  dict: RegisterStepsDict;
  locale: 'he' | 'en';
}

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const pageTransition = {
  initial: { opacity: 0, y: 20 },
  animate: { opacity: 1, y: 0 },
  exit: { opacity: 0, y: -20 },
  transition: { duration: 0.4, ease: 'easeOut' },
};

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

// ============================================================================
// BACKGROUND COMPONENT
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-cyan-400/20 to-blue-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-pink-400/20 to-purple-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-orange-400/15 to-red-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />
    <motion.div
      className="absolute bottom-20 right-10 w-64 h-64 bg-gradient-to-br from-emerald-400/20 to-teal-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 35, 0],
        scale: [1, 1.12, 1],
      }}
      transition={{
        duration: 16,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 0.5,
      }}
    />

    {/* Dot Pattern */}
    <div className="absolute inset-0 opacity-[0.03] bg-[radial-gradient(#06b6d4_1px,transparent_1px)] [background-size:24px_24px]" />

    {/* SVG Decorative Waves */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1000 1000"
      xmlns="http://www.w3.org/2000/svg"
      preserveAspectRatio="none"
    >
      <defs>
        <linearGradient id="waveGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stopColor="#06b6d4" stopOpacity="0.08" />
          <stop offset="100%" stopColor="#ec4899" stopOpacity="0.04" />
        </linearGradient>
        <linearGradient id="waveGrad2" x1="100%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stopColor="#8b5cf6" stopOpacity="0.06" />
          <stop offset="100%" stopColor="#06b6d4" stopOpacity="0.03" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,200 C300,100 700,300 1000,200 L1000,0 L0,0 Z"
        fill="url(#waveGrad1)"
        initial={{ opacity: 0.6 }}
        animate={{ opacity: [0.6, 0.9, 0.6] }}
        transition={{ duration: 8, repeat: Infinity, ease: 'easeInOut' }}
      />
      <motion.path
        d="M0,800 C300,700 700,900 1000,800 L1000,1000 L0,1000 Z"
        fill="url(#waveGrad2)"
        initial={{ opacity: 0.6 }}
        animate={{ opacity: [0.6, 0.8, 0.6] }}
        transition={{
          duration: 10,
          repeat: Infinity,
          ease: 'easeInOut',
          delay: 2,
        }}
      />
    </svg>
  </div>
);

// ============================================================================
// HERO SECTION
// ============================================================================

interface HeroSectionProps {
  title: string;
  subtitle: string;
  locale: 'he' | 'en';
}

const HeroSection: React.FC<HeroSectionProps> = ({
  title,
  subtitle,
  locale,
}) => {
  const isRTL = locale === 'he';

  return (
    <motion.div
      variants={containerVariants}
      initial="hidden"
      animate="visible"
      className="mb-8 text-center"
    >
      <motion.div variants={itemVariants} className="mb-4">
        <div className="inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/60 mb-6">
          <motion.div
            animate={{ rotate: [0, 10, -10, 0] }}
            transition={{ duration: 2, repeat: Infinity, ease: 'easeInOut' }}
          >
            <Sparkles className="w-5 h-5 text-cyan-500" />
          </motion.div>
          <span className="text-sm font-medium text-gray-700">
            {locale === 'he' ? 'הצעד הראשון למסע שלכם' : 'Your First Step'}
          </span>
          <Heart className="w-5 h-5 text-pink-500" />
        </div>
      </motion.div>

      <motion.h1
        variants={itemVariants}
        className="text-3xl md:text-4xl lg:text-5xl font-bold mb-4"
      >
        <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 animate-gradient-slow">
          {title}
        </span>
      </motion.h1>

      <motion.p
        variants={itemVariants}
        className="text-gray-600 text-base md:text-lg max-w-2xl mx-auto leading-relaxed px-4"
        style={{
          direction: isRTL ? 'rtl' : 'ltr',
          textAlign: 'center',
        }}
      >
        {subtitle}
      </motion.p>

      {/* Decorative Line */}
      <motion.div variants={itemVariants} className="relative mt-6">
        <div className="w-24 h-1 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 rounded-full mx-auto" />
        <motion.div
          className="absolute top-0 left-1/2 -translate-x-1/2 w-2 h-2 bg-white rounded-full border-2 border-pink-400"
          animate={{ scale: [1, 1.3, 1] }}
          transition={{ duration: 2, repeat: Infinity, ease: 'easeInOut' }}
        />
      </motion.div>
    </motion.div>
  );
};

// ============================================================================
// MAIN REGISTRATION STEPS CONTENT
// ============================================================================

const RegisterStepsContent: React.FC<{
  dict: RegisterStepsDict;
  locale: 'he' | 'en';
}> = ({ dict, locale }) => {
  const {
    data: registrationContextData,
    initializeFromSession,
    resetForm,
    goToStep,
  } = useRegistration();
  const router = useRouter();
  const { data: session, status: sessionStatus } = useSession();
  const searchParams = useSearchParams();

  const [showIncompleteProfileMessage, setShowIncompleteProfileMessage] =
    useState(false);
  const [initializationAttempted, setInitializationAttempted] = useState(false);

  const isRTL = locale === 'he';

  // Handle incomplete profile message
  useEffect(() => {
    const reasonParam = searchParams.get('reason');
    if (
      (reasonParam === 'complete_profile' || reasonParam === 'verify_phone') &&
      !registrationContextData.isCompletingProfile
    ) {
      setShowIncompleteProfileMessage(true);
    } else {
      setShowIncompleteProfileMessage(false);
    }
  }, [searchParams, registrationContextData.isCompletingProfile]);

  // Initialize from session
  useEffect(() => {
    if (sessionStatus === 'loading') return;

    if (sessionStatus === 'authenticated' && session?.user) {
      const user = session.user as SessionUserType;
      if (
        user.isProfileComplete &&
        user.isPhoneVerified &&
        user.termsAndPrivacyAcceptedAt
      ) {
        if (
          typeof window !== 'undefined' &&
          window.location.pathname !== `/${locale}/profile`
        ) {
          router.push(`/${locale}/profile`);
        }
        return;
      }

      const needsSetup =
        !user.termsAndPrivacyAcceptedAt ||
        !user.isProfileComplete ||
        !user.isPhoneVerified;
      if (
        needsSetup &&
        (!initializationAttempted ||
          (registrationContextData.step === 0 &&
            !registrationContextData.isVerifyingEmailCode))
      ) {
        initializeFromSession(user);
        setInitializationAttempted(true);
      }
    }
  }, [
    sessionStatus,
    session,
    router,
    registrationContextData,
    initializeFromSession,
    resetForm,
    goToStep,
    initializationAttempted,
    searchParams,
    locale,
  ]);

  // Render appropriate step
  const renderStep = (): React.ReactNode => {
    if (sessionStatus === 'loading') {
      return (
        <div className="flex flex-col items-center justify-center p-16">
          <Loader2 className="h-10 w-10 animate-spin text-cyan-600 mb-4" />
          <p className="text-gray-600 text-sm">
            {locale === 'he' ? 'טוען...' : 'Loading...'}
          </p>
        </div>
      );
    }

    if (
      registrationContextData.isVerifyingEmailCode &&
      !registrationContextData.isCompletingProfile
    ) {
      return (
        <EmailVerificationCodeStep
          dict={dict.steps.emailVerification}
          locale={locale}
        />
      );
    }

    if (registrationContextData.isCompletingProfile) {
      switch (registrationContextData.step) {
        case 2:
          return (
            <PersonalDetailsStep
              personalDetailsDict={dict.steps.personalDetails}
              optionalInfoDict={dict.steps.optionalInfo}
              consentDict={dict.consentCheckbox}
              locale={locale}
            />
          );
        case 4:
          return <CompleteStep dict={dict.steps.complete} />;
        default:
          resetForm();
          return <WelcomeStep dict={dict.steps.welcome} locale={locale} />;
      }
    }

    switch (registrationContextData.step) {
      case 0:
        return <WelcomeStep dict={dict.steps.welcome} locale={locale} />;
      case 1:
        return (
          <BasicInfoStep
            dict={dict.steps.basicInfo}
            consentDict={dict.consentCheckbox}
            locale={locale}
          />
        );
      default:
        resetForm();
        return <WelcomeStep dict={dict.steps.welcome} locale={locale} />;
    }
  };

  // Determine page title and progress
  let pageTitle = dict.headers.registerTitle;
  let stepDescription = dict.headers.welcomeDescription;
  let currentProgressBarStep = 0;
  let totalProgressBarSteps = 3;
  let showProgressBar = false;

  if (
    registrationContextData.isVerifyingEmailCode &&
    !registrationContextData.isCompletingProfile
  ) {
    pageTitle = dict.headers.verifyEmailTitle;
    stepDescription = dict.headers.verifyEmailDescription.replace(
      '{{email}}',
      registrationContextData.emailForVerification || ''
    );
    showProgressBar = true;
    currentProgressBarStep = 1;
  } else if (registrationContextData.isCompletingProfile) {
    pageTitle = dict.headers.completeProfileTitle;
    totalProgressBarSteps = 1;
    if (registrationContextData.step === 2) {
      stepDescription = session?.user?.termsAndPrivacyAcceptedAt
        ? dict.headers.personalDetailsConsentedDescription
        : dict.headers.personalDetailsDescription;
      currentProgressBarStep = 1;
      showProgressBar = true;
    } else if (registrationContextData.step === 4) {
      stepDescription = session?.user?.isPhoneVerified
        ? dict.headers.completionReadyDescription
        : dict.headers.completionPhoneVerificationDescription;
      showProgressBar = false;
    } else {
      stepDescription = dict.headers.loadingProfileDescription;
      showProgressBar = false;
    }
  } else {
    if (registrationContextData.step === 1) {
      pageTitle = dict.headers.registerTitle;
      stepDescription = dict.headers.accountCreationDescription;
      currentProgressBarStep = 1;
      showProgressBar = true;
    }
  }

  // קובע אם השלב הנוכחי דורש רוחב מלא או צר
  const isWideStep = registrationContextData.isCompletingProfile && registrationContextData.step === 2;

  return (
    <>
      <DynamicBackground />

      <div className="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8 relative z-10">
        {/* Hero Section */}
        <HeroSection
          title={pageTitle}
          subtitle={stepDescription}
          locale={locale}
        />

        {/* Incomplete Profile Alert */}
        <AnimatePresence>
          {showIncompleteProfileMessage && (
            <motion.div
              initial={{ opacity: 0, y: -20, scale: 0.95 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, y: -20, scale: 0.95 }}
              transition={{ duration: 0.3 }}
              className="w-full max-w-md md:max-w-2xl mb-6 mx-auto"
            >
              <Alert className="bg-gradient-to-r from-amber-50 to-orange-50 border-2 border-amber-200 shadow-lg">
                <div className="flex items-start gap-3">
                  <div className="p-2 bg-amber-100 rounded-lg">
                    <Info className="h-5 w-5 text-amber-600" />
                  </div>
                  <div className="flex-1">
                    <AlertTitle className="font-bold text-amber-900 mb-1">
                      {dict.incompleteProfileAlert.title}
                    </AlertTitle>
                    <AlertDescription className="text-sm text-amber-800 leading-relaxed">
                      {searchParams.get('reason') === 'verify_phone'
                        ? dict.incompleteProfileAlert.verifyPhoneDescription
                        : dict.incompleteProfileAlert.description}
                    </AlertDescription>
                  </div>
                </div>
              </Alert>
            </motion.div>
          )}
        </AnimatePresence>

        {/* Progress Bar */}
        <AnimatePresence>
          {showProgressBar && (
            <motion.div
              initial={{ opacity: 0, y: -10 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -10 }}
              transition={{ duration: 0.4 }}
              className="w-full max-w-md md:max-w-2xl mb-6 mx-auto"
            >
              <ProgressBar
                currentStep={currentProgressBarStep}
                totalSteps={totalProgressBarSteps}
                stepLabel={dict.progressBar.stepLabel}
                locale={locale}
              />
            </motion.div>
          )}
        </AnimatePresence>

        {/* Main Card Container - כאן השינוי לרוחב */}
        <motion.div 
          {...pageTransition} 
          className="w-full max-w-md md:max-w-2xl relative"
        >
          <div className="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/60 overflow-hidden relative">
            {/* Decorative Elements - POINTER EVENTS NONE */}
            <div className="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-cyan-400/10 to-transparent rounded-full transform translate-x-20 -translate-y-20 pointer-events-none" />
            <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-pink-400/10 to-transparent rounded-full transform -translate-x-16 translate-y-16 pointer-events-none" />

            {/* Content - Z-10 RELATIVE */}
            {/* הגדלנו padding בדסקטופ */}
            <div className="relative z-10 p-6 sm:p-8 md:p-12">
              <AnimatePresence mode="wait">
                <motion.div
                  key={registrationContextData.step}
                  initial={{ opacity: 0, x: isRTL ? -20 : 20 }}
                  animate={{ opacity: 1, x: 0 }}
                  exit={{ opacity: 0, x: isRTL ? 20 : -20 }}
                  transition={{ duration: 0.3 }}
                  // כאן הלוגיקה: אם זה שלב רחב, קח 100%. אחרת, תמרכז ותגביל רוחב.
                  className={isWideStep ? "w-full" : "max-w-md mx-auto"}
                >
                  {renderStep()}
                </motion.div>
              </AnimatePresence>
            </div>

            {/* Bottom Shine Effect - POINTER EVENTS NONE */}
            <div className="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 opacity-50 pointer-events-none" />
          </div>
        </motion.div>

        {/* Support Link */}
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.5, duration: 0.5 }}
          className="mt-8 text-center"
        >
          <p className="text-sm text-gray-500">
            {dict.contactSupport}{' '}
            <Link
              href={`/${locale}/contact`}
              className="text-cyan-600 hover:text-cyan-700 font-medium hover:underline transition-colors inline-flex items-center gap-1"
            >
              {dict.contactSupportLink}
              <Shield className="w-3 h-3" />
            </Link>
          </p>
        </motion.div>
      </div>

      {/* Animations CSS */}
      <style>{`
        @keyframes gradient-slow {
          0%,
          100% {
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
        }
        .animate-gradient-slow {
          background-size: 200% 200%;
          animation: gradient-slow 6s ease infinite;
        }
      `}</style>
    </>
  );
};

// ============================================================================
// MAIN EXPORT WITH PROVIDER
// ============================================================================

export default function RegisterClient({ dict, locale }: RegisterClientProps) {
  return (
    <RegistrationProvider>
      <RegisterStepsContent dict={dict} locale={locale} />
    </RegistrationProvider>
  );
}
--- End of Content for RegisterClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\register\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/register/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import RegisterClient from './RegisterClient';

function Loading() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <Loader2 className="h-10 w-10 animate-spin text-cyan-600" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type RegisterPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function RegisterPage({ params }: RegisterPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <Suspense fallback={<Loading />}>
      <RegisterClient
        dict={dictionary.auth.register}
        locale={locale}
      />
    </Suspense>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\reset-password
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\reset-password\ResetPasswordClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/reset-password/ResetPasswordClient.tsx
'use client';

import { useState, FormEvent, useEffect } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Lock,
  KeySquare,
  Loader2,
  AlertCircle,
  CheckCircle,
  Eye,
  EyeOff,
  Mail,
} from 'lucide-react';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import Link from 'next/link';
import type { ResetPasswordDict } from '@/types/dictionaries/auth';

interface ResetPasswordClientProps {
  dict: ResetPasswordDict;
  locale: 'he' | 'en'; // הוסף
}

const validatePassword = (
  value: string,
  validationMessage: string
): string | null => {
  const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
  if (!passwordRegex.test(value)) {
    return validationMessage;
  }
  return null;
};

export default function ResetPasswordClient({
  dict,
  locale,
}: ResetPasswordClientProps) {
  const router = useRouter();
  const searchParams = useSearchParams();

  const [email, setEmail] = useState('');
  const [otp, setOtp] = useState('');
  const [newPassword, setNewPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [passwordError, setPasswordError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);

  useEffect(() => {
    const emailFromQuery = searchParams.get('email');
    if (emailFromQuery) setEmail(emailFromQuery);
  }, [searchParams]);

  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);
    setPasswordError(null);

    if (!email) {
      setError(dict.errors.missingEmail);
      setIsLoading(false);
      return;
    }
    if (!otp || otp.length !== 6 || !/^\d+$/.test(otp)) {
      setError(dict.errors.invalidOtp);
      setIsLoading(false);
      return;
    }
    const passValidationError = validatePassword(
      newPassword,
      dict.passwordValidation.length
    );
    if (passValidationError) {
      setPasswordError(passValidationError);
      setIsLoading(false);
      return;
    }
    if (newPassword !== confirmPassword) {
      setError(dict.errors.passwordsMismatch);
      setIsLoading(false);
      return;
    }

    try {
      const response = await fetch(
        `/api/auth/reset-password?locale=${locale}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, otp, newPassword }),
        }
      );
      const data = await response.json();
      if (!response.ok) throw new Error(data.error || dict.errors.default);

      setSuccessMessage(dict.successMessage);
      setTimeout(() => router.push('/auth/signin?reset=success'), 3000);
    } catch (err) {
      setError(err instanceof Error ? err.message : dict.errors.default);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="w-full max-w-md bg-white rounded-xl shadow-xl overflow-hidden relative">
      <div className="absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-cyan-500 to-pink-500"></div>
      <div className="p-6 sm:p-8">
        <div className="text-center mb-6">
          <h1 className="text-2xl font-bold text-gray-800 mb-2">
            {dict.title}
          </h1>
          <p className="text-gray-600 text-sm">{dict.subtitle}</p>
        </div>

        {error && (
          <Alert variant="destructive" className="mb-4" role="alert">
            <AlertCircle className="h-4 w-4" />
            <AlertTitle>שגיאה</AlertTitle>
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        )}
        {passwordError && !error && (
          <Alert variant="destructive" className="mb-4" role="alert">
            <AlertCircle className="h-4 w-4" />
            <AlertTitle>שגיאת סיסמה</AlertTitle>
            <AlertDescription>{passwordError}</AlertDescription>
          </Alert>
        )}
        {successMessage && (
          <Alert className="mb-4 bg-green-50">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <AlertTitle>הצלחה!</AlertTitle>
            <AlertDescription>
              {successMessage} {dict.successRedirect}
            </AlertDescription>
          </Alert>
        )}

        {!successMessage && (
          <form onSubmit={handleSubmit} className="space-y-5">
            <div className="space-y-1">
              <label
                htmlFor="email-reset"
                className="block text-sm font-medium text-gray-700"
              >
                {dict.emailLabel} <span className="text-red-500">*</span>
              </label>
              <div className="relative">
                <Mail className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5" />
                <Input
                  type="email"
                  id="email-reset"
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  placeholder={dict.emailPlaceholder}
                  required
                  disabled={isLoading || !!searchParams.get('email')}
                />
              </div>
            </div>
            <div className="space-y-1">
              <label
                htmlFor="otp-reset"
                className="block text-sm font-medium text-gray-700"
              >
                {dict.otpLabel} <span className="text-red-500">*</span>
              </label>
              <div className="relative">
                <KeySquare className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5" />
                <Input
                  type="text"
                  id="otp-reset"
                  value={otp}
                  onChange={(e) =>
                    setOtp(e.target.value.replace(/[^0-9]/g, '').slice(0, 6))
                  }
                  placeholder={dict.otpPlaceholder}
                  maxLength={6}
                  required
                  disabled={isLoading}
                  inputMode="numeric"
                />
              </div>
            </div>
            <div className="space-y-1">
              <label
                htmlFor="new-password-reset"
                className="block text-sm font-medium text-gray-700"
              >
                {dict.newPasswordLabel} <span className="text-red-500">*</span>
              </label>
              <div className="relative">
                <Lock className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5" />
                <Input
                  type={showPassword ? 'text' : 'password'}
                  id="new-password-reset"
                  value={newPassword}
                  onChange={(e) => setNewPassword(e.target.value)}
                  onBlur={(e) =>
                    setPasswordError(
                      validatePassword(
                        e.target.value,
                        dict.passwordValidation.length
                      )
                    )
                  }
                  placeholder={dict.newPasswordPlaceholder}
                  required
                  disabled={isLoading}
                />
                <button
                  type="button"
                  onClick={() => setShowPassword(!showPassword)}
                  className="absolute left-3 top-1/2 -translate-y-1/2"
                  aria-label={
                    showPassword ? dict.hidePasswordAria : dict.showPasswordAria
                  }
                >
                  {showPassword ? (
                    <EyeOff className="h-5 w-5" />
                  ) : (
                    <Eye className="h-5 w-5" />
                  )}
                </button>
              </div>
              {!passwordError && (
                <p className="mt-1 text-xs text-gray-500">
                  {dict.passwordHint}
                </p>
              )}
            </div>
            <div className="space-y-1">
              <label
                htmlFor="confirm-password-reset"
                className="block text-sm font-medium text-gray-700"
              >
                {dict.confirmPasswordLabel}{' '}
                <span className="text-red-500">*</span>
              </label>
              <div className="relative">
                <Lock className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5" />
                <Input
                  type={showConfirmPassword ? 'text' : 'password'}
                  id="confirm-password-reset"
                  value={confirmPassword}
                  onChange={(e) => setConfirmPassword(e.target.value)}
                  placeholder={dict.confirmPasswordPlaceholder}
                  required
                  disabled={isLoading}
                />
                <button
                  type="button"
                  onClick={() => setShowConfirmPassword(!showConfirmPassword)}
                  className="absolute left-3 top-1/2 -translate-y-1/2"
                  aria-label={
                    showConfirmPassword
                      ? dict.hidePasswordAria
                      : dict.showPasswordAria
                  }
                >
                  {showConfirmPassword ? (
                    <EyeOff className="h-5 w-5" />
                  ) : (
                    <Eye className="h-5 w-5" />
                  )}
                </button>
              </div>
            </div>
            <Button
              type="submit"
              disabled={
                isLoading ||
                !!passwordError ||
                !otp ||
                !newPassword ||
                !confirmPassword ||
                newPassword !== confirmPassword
              }
              className="w-full"
            >
              {isLoading ? (
                <>
                  <Loader2 className="h-5 w-5 animate-spin mr-2" />
                  <span>{dict.submitButtonLoading}</span>
                </>
              ) : (
                dict.submitButton
              )}
            </Button>
          </form>
        )}

        <div className="mt-6 text-center">
          <Link
            href="/auth/signin"
            className="text-sm text-cyan-600 hover:text-cyan-700 hover:underline"
          >
            {dict.backToSignInLink}
          </Link>
        </div>
      </div>
    </div>
  );
}
--- End of Content for ResetPasswordClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\reset-password\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/reset-password/page.tsx
import { Suspense } from 'react';
import Link from 'next/link';
import { ArrowLeft, Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import ResetPasswordClient from './ResetPasswordClient';

function Loading() {
  return (
    <div className="flex flex-col items-center justify-center p-8 bg-white rounded-xl shadow-xl">
      <Loader2 className="h-8 w-8 animate-spin text-cyan-500" />
      <p className="mt-4 text-gray-600">טוען...</p>
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type ResetPasswordPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ResetPasswordPage({ params }: ResetPasswordPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-cyan-50 via-white to-pink-50 p-4 sm:p-8">
      <Link
        href="/"
        className="absolute top-4 left-4 rtl:right-4 rtl:left-auto text-gray-600 hover:text-gray-800 transition-colors flex items-center gap-1 text-sm z-20"
      >
        <ArrowLeft
          className={`h-4 w-4 ${locale === 'he' ? 'transform rotate-180' : ''}`}
        />{' '}
        חזרה לדף הבית
      </Link>
      <Suspense fallback={<Loading />}>
        <ResetPasswordClient
          dict={dictionary.auth.resetPassword}
          locale={locale}
        />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\setup-account
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\setup-account\SetupAccountClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/setup-account/SetupAccountClient.tsx
"use client";

import React, { useState, useEffect } from 'react';
import { useSearchParams } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { toast } from 'sonner';
import { Loader2, KeyRound, CheckCircle } from "lucide-react";
import type { SetupAccountDict } from '@/types/dictionaries/auth';

interface SetupAccountClientProps {
    dict: SetupAccountDict;
}

export default function SetupAccountClient({ dict }: SetupAccountClientProps) {
  const searchParams = useSearchParams();
  const [token, setToken] = useState<string | null>(null);
  const [password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState(false);

  useEffect(() => {
    const tokenFromUrl = searchParams.get('token');
    if (tokenFromUrl) {
      setToken(tokenFromUrl);
    } else {
      setError(dict.errors.linkInvalid);
    }
  }, [searchParams, dict.errors.linkInvalid]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError('');

    if (password.length < 8) {
      setError(dict.errors.passwordLength);
      return;
    }
    if (password !== confirmPassword) {
      setError(dict.errors.passwordsMismatch);
      return;
    }
    
    setIsLoading(true);

    try {
      const response = await fetch('/api/auth/complete-setup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token, password }),
      });
      const result = await response.json();
      if (!response.ok) throw new Error(result.error || dict.errors.default);
      
      setSuccess(true);
      toast.success(dict.success.title);

      setTimeout(() => { window.location.assign('/profile'); }, 1500);
    } catch (err) {
      setError(err instanceof Error ? err.message : dict.errors.unexpected);
      setIsLoading(false); 
    }
  };
  
  if (success) {
    return (
        <Card className="w-full max-w-md mx-auto text-center">
            <CardHeader>
                <div className="mx-auto bg-green-100 rounded-full p-3 w-fit">
                    <CheckCircle className="h-10 w-10 text-green-600" />
                </div>
                <CardTitle className="mt-4">{dict.success.title}</CardTitle>
            </CardHeader>
            <CardContent>
                <p className="text-muted-foreground">{dict.success.description}</p>
                <Loader2 className="mt-4 h-6 w-6 animate-spin mx-auto" />
            </CardContent>
        </Card>
    );
  }

  return (
    <Card className="w-full max-w-md mx-auto">
      <CardHeader>
        <CardTitle>{dict.title}</CardTitle>
        <CardDescription>{dict.description}</CardDescription>
      </CardHeader>
      <CardContent>
        {!token ? (
            <div className="text-red-500 text-center p-4 bg-red-50 rounded-md">{error}</div>
        ) : (
            <form onSubmit={handleSubmit} className="space-y-4">
                <div>
                    <Label htmlFor="password">{dict.newPasswordLabel}</Label>
                    <Input id="password" type="password" value={password} onChange={(e) => setPassword(e.target.value)} required />
                    <p className="text-xs text-muted-foreground mt-1">{dict.passwordHint}</p>
                </div>
                <div>
                    <Label htmlFor="confirmPassword">{dict.confirmPasswordLabel}</Label>
                    <Input id="confirmPassword" type="password" value={confirmPassword} onChange={(e) => setConfirmPassword(e.target.value)} required />
                </div>
                {error && <p className="text-sm font-medium text-destructive">{error}</p>}
                <CardFooter className="p-0 pt-4">
                    <Button type="submit" className="w-full" disabled={isLoading}>
                        {isLoading ? <Loader2 className="mr-2 h-4 w-4 animate-spin" /> : <KeyRound className="mr-2 h-4 w-4" />}
                        {isLoading ? dict.submitButtonLoading : dict.submitButton}
                    </Button>
                </CardFooter>
            </form>
        )}
      </CardContent>
    </Card>
  );
}
--- End of Content for SetupAccountClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\setup-account\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/setup-account/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import SetupAccountClient from './SetupAccountClient';

function Loading() {
  return (
    <div className="flex items-center justify-center min-h-screen">
      <Loader2 className="h-8 w-8 animate-spin text-cyan-600" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type SetupAccountPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function SetupAccountPage({ params }: SetupAccountPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="flex items-center justify-center min-h-screen bg-gray-100 p-4">
      <Suspense fallback={<Loading />}>
        <SetupAccountClient dict={dictionary.auth.setupAccount} />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\signin
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\signin\SignInClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/signin/SignInClient.tsx
'use client';

import { useState, useEffect, FormEvent } from 'react';
import { useSearchParams, useRouter } from 'next/navigation';
import { useSession, signIn } from 'next-auth/react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import {
  Mail,
  Lock,
  AlertCircle,
  Loader2,
  ArrowLeft,
  ArrowRight,
  Sparkles,
  Heart,
  Shield,
  CheckCircle2,
  Eye,
  EyeOff,
} from 'lucide-react';

import { Button } from '@/components/ui/button';
import { Label } from '@/components/ui/label';
import type { SignInDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface SignInClientProps {
  dict: SignInDict;
  locale: 'he' | 'en';
}

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

// ============================================================================
// BACKGROUND COMPONENT
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-cyan-400/20 to-blue-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-pink-400/20 to-purple-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-orange-400/15 to-red-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />
    <motion.div
      className="absolute bottom-20 right-10 w-64 h-64 bg-gradient-to-br from-emerald-400/20 to-teal-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 35, 0],
        scale: [1, 1.12, 1],
      }}
      transition={{
        duration: 16,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 0.5,
      }}
    />

    {/* Dot Pattern */}
    <div className="absolute inset-0 opacity-[0.03] bg-[radial-gradient(#06b6d4_1px,transparent_1px)] [background-size:24px_24px]" />

    {/* SVG Decorative Waves */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1000 1000"
      xmlns="http://www.w3.org/2000/svg"
      preserveAspectRatio="none"
    >
      <defs>
        <linearGradient id="waveGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stopColor="#06b6d4" stopOpacity="0.08" />
          <stop offset="100%" stopColor="#ec4899" stopOpacity="0.04" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,200 C300,100 700,300 1000,200 L1000,0 L0,0 Z"
        fill="url(#waveGrad1)"
        initial={{ opacity: 0.6 }}
        animate={{ opacity: [0.6, 0.9, 0.6] }}
        transition={{ duration: 8, repeat: Infinity, ease: 'easeInOut' }}
      />
    </svg>
  </div>
);

// ============================================================================
// LOADING STATE COMPONENT
// ============================================================================

interface LoadingStateProps {
  status: 'loading' | 'authenticated';
  dict: SignInDict;
}

const LoadingState: React.FC<LoadingStateProps> = ({ status, dict }) => (
  <motion.div
    initial={{ opacity: 0, scale: 0.9 }}
    animate={{ opacity: 1, scale: 1 }}
    className="flex w-full max-w-md flex-col items-center justify-center rounded-3xl bg-white/80 backdrop-blur-xl p-12 text-center shadow-2xl border border-white/60"
    style={{ minHeight: '420px' }}
  >
    <motion.div
      animate={{ rotate: 360 }}
      transition={{ duration: 2, repeat: Infinity, ease: 'linear' }}
      className="mb-6"
    >
      <div className="p-4 bg-gradient-to-br from-cyan-400 to-pink-400 rounded-full">
        <Loader2 className="h-12 w-12 text-white" />
      </div>
    </motion.div>

    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ delay: 0.2 }}
    >
      <h2 className="mb-3 text-2xl font-bold text-gray-800">
        {status === 'authenticated' ? dict.loader.success : dict.loader.loading}
      </h2>
      <p className="text-gray-600 mb-4">
        {status === 'authenticated'
          ? dict.loader.redirecting
          : dict.loader.checking}
      </p>

      {status === 'authenticated' && (
        <motion.div
          initial={{ scale: 0 }}
          animate={{ scale: 1 }}
          transition={{ delay: 0.3, type: 'spring' }}
          className="inline-flex items-center gap-2 bg-green-50 text-green-700 px-4 py-2 rounded-full text-sm font-medium"
        >
          <CheckCircle2 className="w-4 h-4" />
          <span>מתחבר בהצלחה</span>
        </motion.div>
      )}
    </motion.div>

    {/* Decorative circles */}
    <div className="absolute inset-0 pointer-events-none overflow-hidden rounded-3xl">
      <motion.div
        className="absolute -top-10 -right-10 w-32 h-32 bg-gradient-to-br from-cyan-400/20 to-transparent rounded-full pointer-events-none"
        animate={{ scale: [1, 1.2, 1], rotate: [0, 90, 0] }}
        transition={{ duration: 4, repeat: Infinity }}
      />
      <motion.div
        className="absolute -bottom-10 -left-10 w-32 h-32 bg-gradient-to-br from-pink-400/20 to-transparent rounded-full pointer-events-none"
        animate={{ scale: [1, 1.2, 1], rotate: [0, -90, 0] }}
        transition={{ duration: 4, repeat: Infinity, delay: 1 }}
      />
    </div>
  </motion.div>
);

// ============================================================================
// MAIN SIGNIN COMPONENT
// ============================================================================

export default function SignInClient({ dict, locale }: SignInClientProps) {
  const router = useRouter();
  const searchParams = useSearchParams();
  const { data: session, status } = useSession();

  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [error, setError] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [isGoogleLoading, setIsGoogleLoading] = useState(false);
  const [shouldShake, setShouldShake] = useState(false);

  const isRTL = locale === 'he';

  // Handle authenticated redirect
  useEffect(() => {
    if (status === 'authenticated') {
      const redirectUrl = session?.redirectUrl || `/${locale}/profile`;
      router.push(redirectUrl);
    }
  }, [status, session, router, locale]);

  // Handle URL error parameters
  useEffect(() => {
    const errorMessage = searchParams.get('error');
    if (errorMessage) {
      switch (errorMessage) {
        case 'CredentialsSignin':
          setError(dict.errors.credentialsSignin);
          break;
        case 'OAuthAccountNotLinked':
          setError(dict.errors.oauthAccountNotLinked);
          break;
        default:
          setError(dict.errors.default.replace('{errorMessage}', errorMessage));
      }
      setShouldShake(true);
      setTimeout(() => setShouldShake(false), 500);
    }
  }, [searchParams, dict.errors]);

  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setError('');
    setIsLoading(true);

    if (!email || !password) {
      setError(dict.errors.missingFields);
      setShouldShake(true);
      setTimeout(() => setShouldShake(false), 500);
      setIsLoading(false);
      return;
    }

    const result = await signIn('credentials', {
      email: email.toLowerCase(),
      password,
      redirect: false,
    });

    if (result?.error) {
      setError(dict.errors.credentialsSignin);
      setShouldShake(true);
      setTimeout(() => setShouldShake(false), 500);
    }

    setIsLoading(false);
  };

  const handleGoogleSignIn = async () => {
    setIsGoogleLoading(true);
    setError('');
    await signIn('google', undefined, { hl: locale });
  };

  // Show loading state
  if (status === 'loading' || status === 'authenticated') {
    return (
      <>
        <DynamicBackground />
        <div className="min-h-screen flex items-center justify-center p-4">
          <LoadingState status={status} dict={dict} />
        </div>
      </>
    );
  }

  // Main sign-in form
  return (
    <>
      <DynamicBackground />

      <div className="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8 relative z-10">
        
        {/* Hero Section */}
        <motion.div
          variants={containerVariants}
          initial="hidden"
          animate="visible"
          className="mb-8 text-center"
        >
          <motion.div variants={itemVariants} className="mb-4">
            <div className="inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/60 mb-6">
              <motion.div
                animate={{ rotate: [0, 10, -10, 0] }}
                transition={{ duration: 2, repeat: Infinity, ease: 'easeInOut' }}
              >
                <Heart className="w-5 h-5 text-pink-500" />
              </motion.div>
              <span className="text-sm font-medium text-gray-700">
                {locale === 'he' ? 'ברוכים השבים' : 'Welcome Back'}
              </span>
              <Sparkles className="w-5 h-5 text-cyan-500" />
            </div>
          </motion.div>

          <motion.h1
            variants={itemVariants}
            className="text-3xl md:text-4xl font-bold mb-3"
          >
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 animate-gradient-slow">
              {dict.title}
            </span>
          </motion.h1>

          <motion.p
            variants={itemVariants}
            className="text-gray-600 text-base md:text-lg max-w-md mx-auto"
          >
            {dict.subtitle}
          </motion.p>

          {/* Decorative Line */}
          <motion.div variants={itemVariants} className="relative mt-6">
            <div className="w-20 h-1 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 rounded-full mx-auto" />
          </motion.div>
        </motion.div>

        {/* Main Card */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={
            shouldShake
              ? { opacity: 1, y: 0, x: [-10, 10, -10, 10, 0] }
              : { opacity: 1, y: 0 }
          }
          transition={
            shouldShake
              ? { duration: 0.5 }
              : { duration: 0.5, delay: 0.3 }
          }
          className="w-full max-w-md"
        >
          <div className="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/60 overflow-hidden relative">
            {/* Top Gradient Line - POINTER EVENTS NONE */}
            <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 pointer-events-none" />

            {/* Decorative Elements - POINTER EVENTS NONE */}
            <div className="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-cyan-400/10 to-transparent rounded-full transform translate-x-20 -translate-y-20 pointer-events-none" />
            <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-pink-400/10 to-transparent rounded-full transform -translate-x-16 translate-y-16 pointer-events-none" />

            <div className="relative z-10 p-6 sm:p-8">
              {/* Error Alert */}
              <AnimatePresence>
                {error && (
                  <motion.div
                    initial={{ opacity: 0, y: -10, height: 0 }}
                    animate={{ opacity: 1, y: 0, height: 'auto' }}
                    exit={{ opacity: 0, y: -10, height: 0 }}
                    className="mb-6"
                  >
                    <div
                      role="alert"
                      className="p-4 bg-red-50 border-2 border-red-200 rounded-2xl flex items-start gap-3 shadow-sm"
                    >
                      <div className="p-2 bg-red-100 rounded-lg flex-shrink-0">
                        <AlertCircle className="h-5 w-5 text-red-600" />
                      </div>
                      <div className="flex-1">
                        <p className="text-red-800 text-sm font-medium leading-relaxed">
                          {error}
                        </p>
                      </div>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>

              {/* Sign In Form */}
              <form onSubmit={handleSubmit} className="space-y-5 mb-6">
                {/* Email Field */}
                <div className="space-y-2">
                  <Label
                    htmlFor="email"
                    className="block text-sm font-semibold text-gray-700"
                  >
                    {dict.emailLabel}
                  </Label>
                  <div className="relative group">
                    <div
                      className={`absolute ${isRTL ? 'right-3' : 'left-3'} top-1/2 transform -translate-y-1/2 transition-colors ${
                        email ? 'text-cyan-500' : 'text-gray-400'
                      }`}
                    >
                      <Mail className="h-5 w-5" />
                    </div>
                    <input
                      type="email"
                      id="email"
                      name="email"
                      autoComplete="email"
                      value={email}
                      onChange={(e) => setEmail(e.target.value)}
                      className={`w-full ${isRTL ? 'pr-11 pl-4' : 'pl-11 pr-4'} py-3.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-cyan-200 focus:border-cyan-400 focus:outline-none transition-all bg-white/50 backdrop-blur-sm hover:border-gray-300 text-gray-800 placeholder:text-gray-400 relative z-10`}
                      placeholder={dict.emailPlaceholder}
                      required
                      disabled={isLoading || isGoogleLoading}
                      dir={isRTL ? 'rtl' : 'ltr'}
                    />
                  </div>
                </div>

                {/* Password Field */}
                <div className="space-y-2">
                  <div className="flex items-center justify-between">
                    <Label
                      htmlFor="password"
                      className="block text-sm font-semibold text-gray-700"
                    >
                      {dict.passwordLabel}
                    </Label>
                  </div>
                  <div className="relative group">
                    <div
                      className={`absolute ${isRTL ? 'right-3' : 'left-3'} top-1/2 transform -translate-y-1/2 transition-colors ${
                        password ? 'text-cyan-500' : 'text-gray-400'
                      }`}
                    >
                      <Lock className="h-5 w-5" />
                    </div>
                    <input
                      type={showPassword ? 'text' : 'password'}
                      id="password"
                      name="password"
                      autoComplete="current-password"
                      value={password}
                      onChange={(e) => setPassword(e.target.value)}
                      className={`w-full ${isRTL ? 'pr-11 pl-12' : 'pl-11 pr-12'} py-3.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-cyan-200 focus:border-cyan-400 focus:outline-none transition-all bg-white/50 backdrop-blur-sm hover:border-gray-300 text-gray-800 placeholder:text-gray-400 relative z-10`}
                      placeholder={dict.passwordPlaceholder}
                      required
                      disabled={isLoading || isGoogleLoading}
                      dir={isRTL ? 'rtl' : 'ltr'}
                    />
                    <button
                      type="button"
                      onClick={() => setShowPassword(!showPassword)}
                      className={`absolute ${isRTL ? 'left-3' : 'right-3'} top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors z-20`}
                      tabIndex={-1}
                    >
                      {showPassword ? (
                        <EyeOff className="h-5 w-5" />
                      ) : (
                        <Eye className="h-5 w-5" />
                      )}
                    </button>
                  </div>
                  <div className={`flex ${isRTL ? 'justify-start' : 'justify-end'}`}>
                    <Link
                      href={`/${locale}/auth/forgot-password`}
                      className="text-sm text-cyan-600 hover:text-cyan-700 hover:underline font-medium transition-colors relative z-20"
                    >
                      {dict.forgotPasswordLink}
                    </Link>
                  </div>
                </div>

                {/* Submit Button - Z-20 + Relative */}
                <Button
                  type="submit"
                  disabled={isLoading || isGoogleLoading}
                  className="w-full relative z-20 py-4 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 hover:from-cyan-600 hover:via-purple-600 hover:to-pink-600 shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2 rounded-xl text-base font-semibold group overflow-hidden"
                >
                  {/* Shine effect - POINTER EVENTS NONE */}
                  <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 pointer-events-none" />

                  {isLoading ? (
                    <>
                      <Loader2 className="h-5 w-5 animate-spin" />
                      <span>{dict.submitButtonLoading}</span>
                    </>
                  ) : (
                    <>
                      <span>{dict.submitButton}</span>
                      {isRTL ? (
                        <ArrowLeft className="w-5 h-5 group-hover:-translate-x-1 transition-transform" />
                      ) : (
                        <ArrowRight className="w-5 h-5 group-hover:translate-x-1 transition-transform" />
                      )}
                    </>
                  )}
                </Button>
              </form>

              {/* Divider */}
              <div className="relative mb-6">
                <div className="absolute inset-0 flex items-center">
                  <div className="w-full border-t-2 border-gray-200" />
                </div>
                <div className="relative flex justify-center">
                  <span className="px-4 bg-white/80 text-sm font-medium text-gray-500">
                    {dict.orDivider}
                  </span>
                </div>
              </div>

              {/* Google Sign In Button - Z-20 + Relative + BG-White/50 */}
              <Button
                type="button"
                onClick={handleGoogleSignIn}
                disabled={isLoading || isGoogleLoading}
                variant="outline"
                className="w-full relative z-20 border-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50 py-4 rounded-xl flex items-center justify-center gap-3 group transition-all duration-300 bg-white/50 backdrop-blur-sm"
              >
                {isGoogleLoading ? (
                  <>
                    <Loader2 className="animate-spin h-5 w-5" />
                    <span className="font-medium">{dict.googleButtonLoading}</span>
                  </>
                ) : (
                  <>
                    <svg className="h-5 w-5 flex-shrink-0" viewBox="0 0 24 24" aria-hidden="true">
                      <path
                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                        fill="#4285F4"
                      />
                      <path
                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                        fill="#34A853"
                      />
                      <path
                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                        fill="#FBBC05"
                      />
                      <path
                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                        fill="#EA4335"
                      />
                    </svg>
                    <span className="text-gray-700 font-medium group-hover:text-gray-900 transition-colors">
                      {dict.googleButton}
                    </span>
                  </>
                )}
              </Button>

              {/* Sign Up Link */}
              <div className="mt-8 text-center">
                <p className="text-gray-600 text-sm">
                  {dict.noAccountPrompt}{' '}
                  <Link
                    href={`/${locale}/auth/register`}
                    className="text-cyan-600 font-semibold hover:text-cyan-700 hover:underline transition-colors inline-flex items-center gap-1 relative z-20"
                  >
                    {dict.signUpLink}
                    {isRTL ? (
                      <ArrowLeft className="w-3 h-3" />
                    ) : (
                      <ArrowRight className="w-3 h-3" />
                    )}
                  </Link>
                </p>
              </div>
            </div>

            {/* Bottom Shine Effect - POINTER EVENTS NONE */}
            <div className="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 opacity-50 pointer-events-none" />
          </div>
        </motion.div>

        {/* Trust Badge */}
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.8, duration: 0.5 }}
          className="mt-8 flex items-center gap-2 text-sm text-gray-500"
        >
          <Shield className="w-4 h-4 text-cyan-500" />
          <span>
            {locale === 'he'
              ? 'המידע שלך מוגן ומאובטח'
              : 'Your data is protected and secure'}
          </span>
        </motion.div>
      </div>

      {/* Animations CSS */}
      <style>{`
        @keyframes gradient-slow {
          0%,
          100% {
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
        }
        .animate-gradient-slow {
          background-size: 200% 200%;
          animation: gradient-slow 6s ease infinite;
        }
      `}</style>
    </>
  );
}
--- End of Content for SignInClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\signin\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/signin/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import SignInClient from './SignInClient';

function Loading() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <Loader2 className="h-8 w-8 animate-spin text-cyan-600" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type SignInPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function SignInPage({ params }: SignInPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-cyan-50 via-white to-pink-50 p-4">
      <Suspense fallback={<Loading />}>
        <SignInClient dict={dictionary.auth.signIn} locale={locale} />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\update-phone
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\update-phone\UpdatePhoneClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/update-phone/UpdatePhoneClient.tsx
'use client';

import { useState, useCallback, FormEvent } from 'react';
import { useRouter } from 'next/navigation';
import { useSession } from 'next-auth/react';
import { Button } from '@/components/ui/button';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { AlertCircle, Loader2 } from 'lucide-react';
import Link from 'next/link';
import type { UpdatePhoneDict } from '@/types/dictionaries/auth';

// ======================= ייבואים חדשים =======================
import PhoneNumberInput from '@/components/auth/PhoneNumberInput';
import { isPossiblePhoneNumber } from 'react-phone-number-input';
// =============================================================

interface UpdatePhoneClientProps {
  dict: UpdatePhoneDict;
  // הוספת locale לממשק כדי שנוכל לקבל אותו
  locale: 'he' | 'en';
}

const UpdatePhoneClient = ({ dict, locale }: UpdatePhoneClientProps) => {
  const router = useRouter();
  const { status: sessionStatus } = useSession();
  const [newPhone, setNewPhone] = useState<string | undefined>('');
  const [error, setError] = useState<string | null>(null);
  const [isLoading, setIsLoading] = useState(false);

  const handleSubmit = useCallback(
    async (e: FormEvent) => {
      e.preventDefault();
      setError(null);

      // ======================= ולידציה מעודכנת =======================
      if (!newPhone || !isPossiblePhoneNumber(newPhone)) {
        setError(dict.errors.invalidFormat);
        return;
      }
      // ===============================================================

      setIsLoading(true);
      try {
        const response = await fetch('/api/auth/update-and-resend-code', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ newPhone }),
        });
        const result = await response.json();
        if (!response.ok) {
          throw new Error(result.error || dict.errors.updateFailed);
        }
        // הניווט הוא יחסי ולכן אין צורך ב-locale כאן
        router.push('/auth/verify-phone');
      } catch (err: unknown) {
        if (err instanceof Error) {
          setError(err.message);
        } else {
          setError(dict.errors.unexpected);
        }
      } finally {
        setIsLoading(false);
      }
    },
    [newPhone, router, dict]
  );

  if (sessionStatus === 'loading') {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <Loader2 className="h-8 w-8 animate-spin text-cyan-600" />
        <span className="ml-2">{dict.loaderText}</span>
      </div>
    );
  }
  if (sessionStatus === 'unauthenticated') {
    router.push('/auth/signin?callbackUrl=/auth/update-phone');
    return null;
  }

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-cyan-50 via-white to-pink-50 p-4">
      <div className="w-full max-w-sm bg-white rounded-xl shadow-xl p-6 sm:p-8 space-y-6">
        <div className="text-center">
          <h1 className="text-2xl font-bold text-gray-800">{dict.title}</h1>
          <p
            className="text-gray-600 mt-2 text-sm sm:text-base"
            dangerouslySetInnerHTML={{
              __html: dict.description.replace(/\n/g, '<br />'),
            }}
          />
        </div>

        {error && (
          <Alert variant="destructive">
            <AlertCircle className="h-4 w-4" />
            <AlertTitle>{dict.errors.title}</AlertTitle>
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        )}

        <form onSubmit={handleSubmit} className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1 text-right">
              {dict.newPhoneLabel}
            </label>
            {/* ======================= החלפת שדה הקלט הישן ======================= */}
            <PhoneNumberInput
              value={newPhone}
              onChange={setNewPhone}
              disabled={isLoading}
              locale={locale}
            />
            {/* ====================================================================== */}
          </div>
          <Button
            type="submit"
            disabled={isLoading || !newPhone}
            className="w-full"
          >
            {isLoading ? (
              <Loader2 className="animate-spin h-5 w-5" />
            ) : (
              dict.submitButton
            )}
          </Button>
        </form>

        <div className="text-center mt-4">
          <Link
            href="/auth/verify-phone"
            className="text-sm text-cyan-600 hover:underline"
          >
            {dict.backToVerificationLink}
          </Link>
        </div>
      </div>
    </div>
  );
};

export default UpdatePhoneClient;
--- End of Content for UpdatePhoneClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\update-phone\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/update-phone/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import UpdatePhoneClient from './UpdatePhoneClient';

// ▼▼▼ כאן השינוי ▼▼▼
type UpdatePhonePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function UpdatePhonePage({ params }: UpdatePhonePageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <UpdatePhoneClient dict={dictionary.auth.updatePhone} locale={locale} />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-email
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-email\VerifyEmailClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/verify-email/VerifyEmailClient.tsx
'use client';

import { useState, useEffect, useRef } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { useSession } from 'next-auth/react';
import { motion, AnimatePresence } from 'framer-motion';
import {
  Loader2,
  AlertCircle,
  CheckCircle,
  Mail,
  ArrowRight,
  ArrowLeft,
  Sparkles,
  Send,
  Shield,
  Clock,
  RefreshCw,
} from 'lucide-react';

import { Button } from '@/components/ui/button';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import type { VerifyEmailDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface VerificationState {
  status: 'pending' | 'verifying' | 'success' | 'error';
  message: string;
}

interface VerifyEmailClientProps {
  dict: VerifyEmailDict;
  locale: 'he' | 'en';
}

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

const cardVariants = {
  hidden: { opacity: 0, scale: 0.95, y: 30 },
  visible: {
    opacity: 1,
    scale: 1,
    y: 0,
    transition: { duration: 0.6, ease: [0.25, 0.46, 0.45, 0.94] },
  },
};

// ============================================================================
// DYNAMIC BACKGROUND COMPONENT
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-cyan-400/20 to-blue-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-pink-400/20 to-purple-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-orange-400/15 to-red-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />
    <motion.div
      className="absolute bottom-20 right-10 w-64 h-64 bg-gradient-to-br from-emerald-400/20 to-teal-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 20, 0],
        x: [0, -10, 0],
        scale: [1, 1.12, 1],
      }}
      transition={{
        duration: 16,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 0.5,
      }}
    />

    {/* Decorative Dots Pattern */}
    <div className="absolute inset-0 opacity-5 bg-[radial-gradient(#8b5cf6_1px,transparent_1px)] [background-size:30px_30px]"></div>

    {/* SVG Decorative Paths */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1200 800"
      xmlns="http://www.w3.org/2000/svg"
    >
      <defs>
        <linearGradient
          id="decorativeGradient"
          x1="0%"
          y1="0%"
          x2="100%"
          y2="100%"
        >
          <stop offset="0%" stopColor="#06b6d4" stopOpacity="0.08" />
          <stop offset="50%" stopColor="#ec4899" stopOpacity="0.06" />
          <stop offset="100%" stopColor="#8b5cf6" stopOpacity="0.08" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,100 C300,50 600,150 1200,100 L1200,0 L0,0 Z"
        fill="url(#decorativeGradient)"
        initial={{ opacity: 0.8 }}
        animate={{ opacity: [0.8, 1, 0.8] }}
        transition={{ duration: 4, repeat: Infinity, ease: 'easeInOut' }}
      />
      <motion.path
        d="M0,700 C400,650 800,750 1200,700 L1200,800 L0,800 Z"
        fill="url(#decorativeGradient)"
        initial={{ opacity: 0.8 }}
        animate={{ opacity: [0.8, 1, 0.8] }}
        transition={{
          duration: 4,
          repeat: Infinity,
          ease: 'easeInOut',
          delay: 2,
        }}
      />
    </svg>
  </div>
);

// ============================================================================
// ANIMATED ICON COMPONENTS
// ============================================================================

const AnimatedMailIcon: React.FC = () => (
  <motion.div
    className="relative inline-flex items-center justify-center w-24 h-24 mb-6"
    initial={{ scale: 0, rotate: -180 }}
    animate={{ scale: 1, rotate: 0 }}
    transition={{ duration: 0.6, ease: 'easeOut' }}
  >
    <motion.div
      className="absolute inset-0 rounded-full bg-gradient-to-br from-cyan-400/20 to-blue-500/20"
      animate={{
        scale: [1, 1.2, 1],
        opacity: [0.5, 0.8, 0.5],
      }}
      transition={{
        duration: 2,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <div className="relative w-20 h-20 rounded-2xl bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center shadow-lg">
      <Mail className="w-10 h-10 text-white" />
    </div>
  </motion.div>
);

const AnimatedSuccessIcon: React.FC = () => (
  <motion.div
    className="relative inline-flex items-center justify-center w-24 h-24 mb-6"
    initial={{ scale: 0 }}
    animate={{ scale: 1 }}
    transition={{ duration: 0.5, ease: 'backOut' }}
  >
    <motion.div
      className="absolute inset-0 rounded-full bg-gradient-to-br from-green-400/30 to-emerald-500/30"
      animate={{
        scale: [1, 1.3, 1],
        opacity: [0.5, 0, 0.5],
      }}
      transition={{
        duration: 1.5,
        repeat: Infinity,
        ease: 'easeOut',
      }}
    />
    <div className="relative w-20 h-20 rounded-full bg-gradient-to-br from-green-400 to-emerald-500 flex items-center justify-center shadow-lg">
      <motion.div
        initial={{ scale: 0 }}
        animate={{ scale: 1 }}
        transition={{ delay: 0.2, duration: 0.3 }}
      >
        <CheckCircle className="w-10 h-10 text-white" />
      </motion.div>
    </div>
  </motion.div>
);

const AnimatedErrorIcon: React.FC = () => (
  <motion.div
    className="relative inline-flex items-center justify-center w-24 h-24 mb-6"
    initial={{ scale: 0, rotate: 180 }}
    animate={{ scale: 1, rotate: 0 }}
    transition={{ duration: 0.5, ease: 'easeOut' }}
  >
    <motion.div
      className="absolute inset-0 rounded-full bg-gradient-to-br from-red-400/30 to-rose-500/30"
      animate={{
        scale: [1, 1.2, 1],
      }}
      transition={{
        duration: 2,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <div className="relative w-20 h-20 rounded-full bg-gradient-to-br from-red-400 to-rose-500 flex items-center justify-center shadow-lg">
      <AlertCircle className="w-10 h-10 text-white" />
    </div>
  </motion.div>
);

const AnimatedLoadingIcon: React.FC = () => (
  <motion.div
    className="relative inline-flex items-center justify-center w-24 h-24 mb-6"
    initial={{ opacity: 0 }}
    animate={{ opacity: 1 }}
    transition={{ duration: 0.3 }}
  >
    <motion.div
      className="absolute inset-0 rounded-full bg-gradient-to-br from-purple-400/20 to-pink-500/20"
      animate={{
        scale: [1, 1.3, 1],
        rotate: [0, 360],
      }}
      transition={{
        duration: 3,
        repeat: Infinity,
        ease: 'linear',
      }}
    />
    <div className="relative w-20 h-20 rounded-2xl bg-gradient-to-br from-purple-400 to-pink-500 flex items-center justify-center shadow-lg">
      <Loader2 className="w-10 h-10 text-white animate-spin" />
    </div>
  </motion.div>
);

// ============================================================================
// MAIN COMPONENT
// ============================================================================

export default function VerifyEmailClient({
  dict,
  locale,
}: VerifyEmailClientProps) {
  const router = useRouter();
  const searchParams = useSearchParams();
  const { data: session } = useSession();
  const verificationApiCallMadeRef = useRef(false);
  const isRTL = locale === 'he';

  const [verification, setVerification] = useState<VerificationState>({
    status: 'pending',
    message: '',
  });
  const [isResending, setIsResending] = useState(false);
  const [infoMessage, setInfoMessage] = useState<string | null>(null);

  useEffect(() => {
    if (verificationApiCallMadeRef.current) return;
    verificationApiCallMadeRef.current = true;

    const token = searchParams.get('token');
    const email = searchParams.get('email');

    if (!token) {
      if (email) {
        setInfoMessage(dict.pendingMessage);
      } else {
        setVerification({
          status: 'error',
          message: dict.errors.linkInvalid,
        });
      }
      return;
    }

    verifyToken(token);
  }, [searchParams, dict]);

  const verifyToken = async (token: string) => {
    setVerification({ status: 'verifying', message: '' });

    if (
      session?.user?.email &&
      searchParams.get('email') &&
      session.user.email !== searchParams.get('email')
    ) {
      setVerification({
        status: 'error',
        message: dict.errors.sessionMismatch,
      });
      return;
    }

    try {
      const response = await fetch('/api/auth/verify', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token: token, type: 'EMAIL' }),
      });
      const data = await response.json();
      if (!response.ok) throw new Error(data.error);

      setVerification({ status: 'success', message: dict.successMessage });
      setTimeout(() => router.push(`/${locale}/auth/signin`), 2000);
    } catch (error) {
      let errorMessage = dict.errors.default;
      if (error instanceof Error) {
        if (error.message.includes('הטוקן כבר נוצל'))
          errorMessage = dict.errors.tokenUsed;
        else if (error.message.includes('תוקף הטוקן פג'))
          errorMessage = dict.errors.tokenExpired;
        else errorMessage = error.message;
      }
      setVerification({ status: 'error', message: errorMessage });
    }
  };

  const handleResendVerification = async () => {
    const email = searchParams.get('email');
    if (!email) {
      setVerification({ status: 'error', message: dict.errors.noEmail });
      return;
    }
    setIsResending(true);
    setVerification({ status: 'pending', message: '' });
    try {
      const response = await fetch('/api/auth/resend-verification', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email: email, type: 'EMAIL' }),
      });
      const data = await response.json();
      if (!response.ok)
        throw new Error(data.error || dict.errors.resendFailed);
      setInfoMessage(dict.alerts.resendSuccess);
    } catch (error) {
      setVerification({
        status: 'error',
        message:
          error instanceof Error ? error.message : dict.errors.resendFailed,
      });
    } finally {
      setIsResending(false);
    }
  };

  const emailParam = searchParams.get('email');

  return (
    <div className="min-h-screen flex flex-col items-center justify-center p-4 relative">
      <DynamicBackground />

      <motion.div
        variants={containerVariants}
        initial="hidden"
        animate="visible"
        className="w-full max-w-lg relative z-10"
      >
        {/* Header Section */}
        <motion.div variants={itemVariants} className="text-center mb-8">
          <motion.div
            className="inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/60 mb-6"
            whileHover={{ scale: 1.05 }}
            transition={{ duration: 0.3 }}
          >
            <Shield className="w-6 h-6 text-cyan-500" />
            <span className="text-cyan-700 font-semibold text-lg">
              {dict.title}
            </span>
          </motion.div>
        </motion.div>

        {/* Main Card */}
        <motion.div
          variants={cardVariants}
          className="relative overflow-hidden rounded-3xl bg-white/70 backdrop-blur-xl shadow-2xl border border-white/60 p-8 md:p-12"
        >
          {/* Decorative Elements */}
          <div className="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-cyan-400/20 to-transparent rounded-full transform translate-x-16 -translate-y-16 blur-2xl" />
          <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-pink-400/20 to-transparent rounded-full transform -translate-x-16 translate-y-16 blur-2xl" />
          <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-purple-400/5 to-transparent rounded-full blur-3xl" />

          <div className="relative z-10">
            <AnimatePresence mode="wait">
              {/* Pending State */}
              {verification.status === 'pending' && (
                <motion.div
                  key="pending"
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  exit={{ opacity: 0, y: -20 }}
                  transition={{ duration: 0.4 }}
                  className="text-center space-y-6"
                >
                  <AnimatedMailIcon />
                  
                  <div className="space-y-3">
                    <h2 className="text-3xl font-bold text-gray-800">
                      {dict.title}
                    </h2>
                    
                    {infoMessage && (
                      <motion.div
                        initial={{ opacity: 0, scale: 0.95 }}
                        animate={{ opacity: 1, scale: 1 }}
                        transition={{ duration: 0.3 }}
                      >
                        <Alert className="border-blue-200 bg-blue-50">
                          <Sparkles className="h-5 w-5 text-blue-600" />
                          <AlertDescription className="text-blue-700">
                            {infoMessage}
                          </AlertDescription>
                        </Alert>
                      </motion.div>
                    )}

                    {emailParam && (
                      <div className="space-y-4 pt-4">
                        <div className="bg-gradient-to-r from-cyan-50 to-blue-50 rounded-2xl p-6 border border-cyan-100">
                          <p className="text-gray-600 text-sm mb-2">
                            {dict.emailSentTo}
                          </p>
                          <p className="text-xl font-bold text-gray-800 break-all">
                            {emailParam}
                          </p>
                        </div>
                        
                        <p className="text-gray-600 leading-relaxed">
                          {dict.checkYourInbox}
                        </p>

                        <motion.div
                          whileHover={{ scale: 1.02 }}
                          whileTap={{ scale: 0.98 }}
                        >
                          <Button
                            onClick={handleResendVerification}
                            disabled={isResending}
                            className="w-full py-6 text-lg font-semibold rounded-xl bg-gradient-to-r from-cyan-500 via-blue-500 to-cyan-600 hover:from-cyan-600 hover:via-blue-600 hover:to-cyan-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 relative overflow-hidden group"
                          >
                            {isResending ? (
                              <div className="flex items-center justify-center gap-3">
                                <Loader2 className="animate-spin h-5 w-5" />
                                <span>{dict.resendButtonLoading}</span>
                              </div>
                            ) : (
                              <div className="flex items-center justify-center gap-3">
                                <RefreshCw className="h-5 w-5" />
                                <span>{dict.resendButton}</span>
                                <Send className="h-5 w-5" />
                              </div>
                            )}
                            <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent group-hover:translate-x-full transition-transform duration-1000" />
                          </Button>
                        </motion.div>
                      </div>
                    )}
                  </div>
                </motion.div>
              )}

              {/* Verifying State */}
              {verification.status === 'verifying' && (
                <motion.div
                  key="verifying"
                  initial={{ opacity: 0, scale: 0.9 }}
                  animate={{ opacity: 1, scale: 1 }}
                  exit={{ opacity: 0, scale: 0.9 }}
                  transition={{ duration: 0.4 }}
                  className="text-center space-y-6"
                >
                  <AnimatedLoadingIcon />
                  
                  <div className="space-y-3">
                    <h2 className="text-2xl font-bold text-gray-800">
                      {dict.verifyingMessage}
                    </h2>
                    <div className="flex justify-center gap-2 py-4">
                      {[0, 1, 2].map((i) => (
                        <motion.div
                          key={i}
                          className="w-3 h-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full"
                          animate={{
                            scale: [1, 1.5, 1],
                            opacity: [0.5, 1, 0.5],
                          }}
                          transition={{
                            duration: 1.5,
                            repeat: Infinity,
                            delay: i * 0.2,
                          }}
                        />
                      ))}
                    </div>
                  </div>
                </motion.div>
              )}

              {/* Success State */}
              {verification.status === 'success' && (
                <motion.div
                  key="success"
                  initial={{ opacity: 0, scale: 0.9 }}
                  animate={{ opacity: 1, scale: 1 }}
                  exit={{ opacity: 0, scale: 0.9 }}
                  transition={{ duration: 0.4 }}
                  className="text-center space-y-6"
                >
                  <AnimatedSuccessIcon />
                  
                  <div className="space-y-4">
                    <h2 className="text-2xl md:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-emerald-600">
                      {verification.message}
                    </h2>
                    
                    <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-6 border border-green-100">
                      <div className="flex items-center justify-center gap-3">
                        <Clock className="w-5 h-5 text-green-600" />
                        <p className="text-gray-700">{dict.successRedirect}</p>
                      </div>
                      <motion.div
                        className="mt-4"
                        animate={{ rotate: 360 }}
                        transition={{
                          duration: 2,
                          repeat: Infinity,
                          ease: 'linear',
                        }}
                      >
                        <Loader2 className="h-6 w-6 mx-auto text-green-600" />
                      </motion.div>
                    </div>
                  </div>
                </motion.div>
              )}

              {/* Error State */}
              {verification.status === 'error' && (
                <motion.div
                  key="error"
                  initial={{ opacity: 0, scale: 0.9 }}
                  animate={{ opacity: 1, scale: 1 }}
                  exit={{ opacity: 0, scale: 0.9 }}
                  transition={{ duration: 0.4 }}
                  className="text-center space-y-6"
                >
                  <AnimatedErrorIcon />
                  
                  <div className="space-y-4">
                    <h2 className="text-2xl font-bold text-red-600">
                      {dict.errorMessage}
                    </h2>
                    
                    <Alert
                      variant="destructive"
                      className="border-red-200 bg-red-50"
                    >
                      <AlertCircle className="h-5 w-5" />
                      <AlertTitle className="font-semibold">
                        {dict.errors.title || 'שגיאה'}
                      </AlertTitle>
                      <AlertDescription>{verification.message}</AlertDescription>
                    </Alert>

                    <motion.div
                      whileHover={{ scale: 1.02 }}
                      whileTap={{ scale: 0.98 }}
                      className="pt-4"
                    >
                      <Button
                        onClick={() => router.push(`/${locale}/auth/signin`)}
                        className="w-full py-6 text-lg font-semibold rounded-xl bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white shadow-lg hover:shadow-xl transition-all duration-300"
                      >
                        <div className="flex items-center justify-center gap-3">
                          {isRTL ? (
                            <ArrowRight className="h-5 w-5" />
                          ) : (
                            <ArrowLeft className="h-5 w-5" />
                          )}
                          <span>{dict.backToSignInButton}</span>
                        </div>
                      </Button>
                    </motion.div>
                  </div>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </motion.div>

        {/* Bottom Decoration */}
        <motion.div variants={itemVariants} className="mt-8 text-center">
          <div className="inline-flex items-center gap-2 text-sm text-gray-500">
            <Shield className="h-4 w-4" />
            <span>מוגן באמצעות הצפנת SSL</span>
          </div>
        </motion.div>
      </motion.div>
    </div>
  );
}
--- End of Content for VerifyEmailClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-email\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/verify-email/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import VerifyEmailClient from './VerifyEmailClient';

function Loading() {
  return (
    <div className="flex items-center justify-center min-h-screen">
      <Loader2 className="h-8 w-8 animate-spin text-cyan-600" />
    </div>
  );
}

type VerifyEmailPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function VerifyEmailPage({ params }: VerifyEmailPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="flex items-center justify-center min-h-screen bg-gray-50 p-4">
      <Suspense fallback={<Loading />}>
        <VerifyEmailClient 
          dict={dictionary.auth.verifyEmail} 
          locale={locale} 
        />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-phone
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-phone\VerifyPhoneClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/verify-phone/VerifyPhoneClient.tsx
'use client';

import { useState, useCallback, useRef, useEffect, FormEvent } from 'react';
import { useSession } from 'next-auth/react';
import { useRouter } from 'next/navigation';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import {
  Loader2,
  AlertCircle,
  CheckCircle,
  MessageSquare,
  ArrowRight,
  ArrowLeft,
  Sparkles,
  Shield,
  Clock,
  RefreshCw,
} from 'lucide-react';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import type { VerifyPhoneDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface VerifyPhoneClientProps {
  dict: VerifyPhoneDict;
  locale: 'he' | 'en';
}

const OTP_LENGTH = 6;
const RESEND_COOLDOWN = 60;

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

const cardVariants = {
  hidden: { opacity: 0, scale: 0.95, y: 30 },
  visible: {
    opacity: 1,
    scale: 1,
    y: 0,
    transition: { duration: 0.6, ease: [0.25, 0.46, 0.45, 0.94] },
  },
};

// ============================================================================
// DYNAMIC BACKGROUND COMPONENT
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-cyan-400/20 to-blue-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-pink-400/20 to-purple-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-orange-400/15 to-red-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />
    <motion.div
      className="absolute bottom-20 right-10 w-64 h-64 bg-gradient-to-br from-emerald-400/20 to-teal-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 20, 0],
        x: [0, -10, 0],
        scale: [1, 1.12, 1],
      }}
      transition={{
        duration: 16,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 0.5,
      }}
    />

    {/* Decorative Dots Pattern */}
    <div className="absolute inset-0 opacity-5 bg-[radial-gradient(#8b5cf6_1px,transparent_1px)] [background-size:30px_30px]"></div>

    {/* SVG Decorative Paths */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1200 800"
      xmlns="http://www.w3.org/2000/svg"
    >
      <defs>
        <linearGradient
          id="decorativeGradient"
          x1="0%"
          y1="0%"
          x2="100%"
          y2="100%"
        >
          <stop offset="0%" stopColor="#06b6d4" stopOpacity="0.08" />
          <stop offset="50%" stopColor="#ec4899" stopOpacity="0.06" />
          <stop offset="100%" stopColor="#8b5cf6" stopOpacity="0.08" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,100 C300,50 600,150 1200,100 L1200,0 L0,0 Z"
        fill="url(#decorativeGradient)"
        initial={{ opacity: 0.8 }}
        animate={{ opacity: [0.8, 1, 0.8] }}
        transition={{ duration: 4, repeat: Infinity, ease: 'easeInOut' }}
      />
      <motion.path
        d="M0,700 C400,650 800,750 1200,700 L1200,800 L0,800 Z"
        fill="url(#decorativeGradient)"
        initial={{ opacity: 0.8 }}
        animate={{ opacity: [0.8, 1, 0.8] }}
        transition={{
          duration: 4,
          repeat: Infinity,
          ease: 'easeInOut',
          delay: 2,
        }}
      />
    </svg>
  </div>
);

// ============================================================================
// CIRCULAR TIMER COMPONENT
// ============================================================================

interface CircularTimerProps {
  seconds: number;
  maxSeconds: number;
}

const CircularTimer: React.FC<CircularTimerProps> = ({
  seconds,
  maxSeconds,
}) => {
  const progress = (seconds / maxSeconds) * 100;
  const circumference = 2 * Math.PI * 20;
  const strokeDashoffset = circumference - (progress / 100) * circumference;

  return (
    <div className="relative inline-flex items-center justify-center w-10 h-10">
      <svg className="w-10 h-10 transform -rotate-90">
        <circle
          cx="20"
          cy="20"
          r="18"
          stroke="currentColor"
          strokeWidth="2"
          fill="none"
          className="text-gray-200"
        />
        <motion.circle
          cx="20"
          cy="20"
          r="18"
          stroke="currentColor"
          strokeWidth="2"
          fill="none"
          strokeDasharray={circumference}
          strokeDashoffset={strokeDashoffset}
          strokeLinecap="round"
          className="text-cyan-500"
          initial={{ strokeDashoffset: circumference }}
          animate={{ strokeDashoffset }}
          transition={{ duration: 0.3, ease: 'linear' }}
        />
      </svg>
      <span className="absolute text-xs font-semibold text-gray-600">
        {seconds}
      </span>
    </div>
  );
};

// ============================================================================
// MAIN COMPONENT
// ============================================================================

const VerifyPhoneClient: React.FC<VerifyPhoneClientProps> = ({
  dict,
  locale,
}) => {
  const { data: session, update: updateSession } = useSession();
  const router = useRouter();
  const isRTL = locale === 'he';

  // Debug logging
  useEffect(() => {
    console.log('[VerifyPhoneClient] Component mounted');
    console.log('[VerifyPhoneClient] Session data:', session);
    console.log('[VerifyPhoneClient] User phone:', session?.user?.phone);
  }, [session]);

  // State
  const [code, setCode] = useState<string[]>(Array(OTP_LENGTH).fill(''));
  const [isLoading, setIsLoading] = useState(false);
  const [isResending, setIsResending] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);
  const [infoMessage, setInfoMessage] = useState<string | null>(null);
  const [resendTimer, setResendTimer] = useState(0);
  const [focusedIndex, setFocusedIndex] = useState<number | null>(null);

  const inputRefs = useRef<(HTMLInputElement | null)[]>([]);
  const resendTimerRef = useRef<NodeJS.Timeout | null>(null);

  const resendDisabled = resendTimer > 0;

  // Timer Management
  const startResendTimer = useCallback(() => {
    setResendTimer(RESEND_COOLDOWN);
    if (resendTimerRef.current) {
      clearInterval(resendTimerRef.current);
    }
    resendTimerRef.current = setInterval(() => {
      setResendTimer((prev) => {
        if (prev <= 1) {
          if (resendTimerRef.current) {
            clearInterval(resendTimerRef.current);
            resendTimerRef.current = null;
          }
          return 0;
        }
        return prev - 1;
      });
    }, 1000);
  }, []);

  useEffect(() => {
    startResendTimer();
    return () => {
      if (resendTimerRef.current) {
        clearInterval(resendTimerRef.current);
      }
    };
  }, [startResendTimer]);

  // Input Handling
  const handleInputChange = useCallback(
    (index: number, value: string) => {
      if (!/^\d*$/.test(value)) return;
      const newCode = [...code];
      newCode[index] = value.slice(0, 1);
      setCode(newCode);
      setError(null);

      if (value && index < OTP_LENGTH - 1) {
        inputRefs.current[index + 1]?.focus();
      }
    },
    [code]
  );

  const handleKeyDown = useCallback(
    (index: number, e: React.KeyboardEvent<HTMLInputElement>) => {
      if (e.key === 'Backspace' && !code[index] && index > 0) {
        inputRefs.current[index - 1]?.focus();
      }
      if (e.key === 'ArrowLeft' && index > 0) {
        inputRefs.current[index - 1]?.focus();
      }
      if (e.key === 'ArrowRight' && index < OTP_LENGTH - 1) {
        inputRefs.current[index + 1]?.focus();
      }
    },
    [code]
  );

  // Verify Code
  const handleVerifyCode = useCallback(
    async (e: FormEvent<HTMLFormElement>) => {
      e.preventDefault();
      setError(null);
      setInfoMessage(null);

      const fullCode = code.join('');
      if (fullCode.length !== OTP_LENGTH) {
        setError(dict.errors.incompleteCode);
        return;
      }

      setIsLoading(true);

      try {
        const response = await fetch(
          `/api/auth/verify-phone-code?locale=${locale}`,
          {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ code: fullCode }),
          }
        );

        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.error || dict.errors.default);
        }

        setSuccessMessage(dict.success.verifying);

        const updatedSession = await updateSession();

        if (updatedSession?.user?.isPhoneVerified) {
          router.push(`/${locale}/profile`);
        } else {
          setError('Failed to update session. Please try logging in again.');
          setIsLoading(false);
        }
      } catch (err: unknown) {
        setError(err instanceof Error ? err.message : dict.errors.unexpected);
        setIsLoading(false);
      }
    },
    [code, updateSession, dict, locale, router]
  );

  // Resend Code
  const handleResendCode = useCallback(async () => {
    if (resendDisabled || isResending) return;
    setError(null);
    setInfoMessage(null);
    setIsResending(true);

    try {
      const response = await fetch(
        `/api/auth/resend-phone-code?locale=${locale}`,
        {
          method: 'POST',
        }
      );
      if (!response.ok) throw new Error((await response.json()).error);
      setInfoMessage(dict.info.resent);
      startResendTimer();
    } catch (err: unknown) {
      setError(err instanceof Error ? err.message : dict.errors.unexpected);
    } finally {
      setIsResending(false);
    }
  }, [isResending, resendDisabled, startResendTimer, dict, locale]);

  // Get Hidden Phone
  const getHiddenPhone = () => {
    const phone = session?.user?.phone;
    if (!phone || phone.length < 4) {
      return dict.yourPhoneNumber;
    }
    const hiddenPhone = `${phone.substring(0, 3)}••••${phone.substring(phone.length - 3)}`;
    return hiddenPhone;
  };

  // --- Helper to safely render text with dynamic OTP length ---
  const renderWithGradientNumber = (text: string) => {
    // If the JSON contains the placeholder, we split and insert the styled number
    if (text.includes('{{OTP_LENGTH}}')) {
      const parts = text.split('{{OTP_LENGTH}}');
      return (
        <>
          {parts[0]}
          <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-600 to-pink-600">
            {OTP_LENGTH}
          </span>
          {parts[1]}
        </>
      );
    }
    // Fallback: Return text as is (avoids double number bug)
    return text;
  };

  const disableForm = isLoading || !!successMessage;
  const disableResend = isResending || resendDisabled || !!successMessage;
  const isCodeComplete = code.every((digit) => digit !== '');

  return (
    <div className="min-h-screen flex flex-col items-center justify-center p-4 relative">
      <DynamicBackground />

      <motion.div
        variants={containerVariants}
        initial="hidden"
        animate="visible"
        className="w-full max-w-lg relative z-10"
      >
        {/* Header Section */}
        <motion.div variants={itemVariants} className="text-center mb-8">
          <motion.div
            className="inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/60 mb-6"
            whileHover={{ scale: 1.05 }}
            transition={{ duration: 0.3 }}
          >
            <Shield className="w-6 h-6 text-cyan-500" />
            <span className="text-cyan-700 font-semibold text-lg">
              {dict.title}
            </span>
          </motion.div>

          {/* Fixed Header Logic */}
          <h1 className="text-3xl md:text-4xl font-bold text-gray-800 mb-4">
            {renderWithGradientNumber(dict.description)}
          </h1>
        </motion.div>

        {/* Main Card */}
        <motion.div
          variants={cardVariants}
          className="relative overflow-hidden rounded-3xl bg-white/70 backdrop-blur-xl shadow-2xl border border-white/60 p-8 md:p-10"
        >
          {/* Decorative Elements */}
          <div className="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-cyan-400/20 to-transparent rounded-full transform translate-x-16 -translate-y-16 blur-2xl" />
          <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-pink-400/20 to-transparent rounded-full transform -translate-x-16 translate-y-16 blur-2xl" />
          <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-purple-400/5 to-transparent rounded-full blur-3xl" />

          <div className="relative z-10 space-y-8">
            {/* WhatsApp Icon & Phone Number */}
            <div className="text-center space-y-3">
              <div className="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-green-400 to-green-600 shadow-lg mb-2">
                <MessageSquare className="w-8 h-8 text-white" />
              </div>
              {/* Fixed Code Sent To Logic */}
              <p className="text-gray-600 text-sm md:text-base">
                {renderWithGradientNumber(dict.codeSentTo)}
              </p>
              <p className="text-xl font-bold text-gray-800">
                {getHiddenPhone()}
              </p>
              <p className="text-gray-500 text-sm">{dict.enterCodePrompt}</p>
            </div>

            {/* Alerts */}
            <AnimatePresence mode="wait">
              {error && (
                <motion.div
                  initial={{ opacity: 0, y: -10, scale: 0.95 }}
                  animate={{ opacity: 1, y: 0, scale: 1 }}
                  exit={{ opacity: 0, y: -10, scale: 0.95 }}
                  transition={{ duration: 0.3 }}
                >
                  <Alert
                    variant="destructive"
                    className="border-red-200 bg-red-50"
                  >
                    <AlertCircle className="h-5 w-5" />
                    <AlertTitle className="font-semibold">
                      {dict.errors.title}
                    </AlertTitle>
                    <AlertDescription>{error}</AlertDescription>
                  </Alert>
                </motion.div>
              )}

              {successMessage && (
                <motion.div
                  initial={{ opacity: 0, y: -10, scale: 0.95 }}
                  animate={{ opacity: 1, y: 0, scale: 1 }}
                  exit={{ opacity: 0, y: -10, scale: 0.95 }}
                  transition={{ duration: 0.3 }}
                >
                  <Alert className="border-green-200 bg-green-50">
                    <motion.div
                      animate={{ scale: [1, 1.2, 1] }}
                      transition={{
                        duration: 0.6,
                        repeat: Infinity,
                        repeatDelay: 1,
                      }}
                    >
                      <CheckCircle className="h-5 w-5 text-green-600" />
                    </motion.div>
                    <AlertTitle className="font-semibold text-green-800">
                      {dict.success.title}
                    </AlertTitle>
                    <AlertDescription className="text-green-700">
                      {successMessage}
                    </AlertDescription>
                  </Alert>
                </motion.div>
              )}

              {infoMessage && (
                <motion.div
                  initial={{ opacity: 0, y: -10, scale: 0.95 }}
                  animate={{ opacity: 1, y: 0, scale: 1 }}
                  exit={{ opacity: 0, y: -10, scale: 0.95 }}
                  transition={{ duration: 0.3 }}
                >
                  <Alert className="border-blue-200 bg-blue-50">
                    <Sparkles className="h-5 w-5 text-blue-600" />
                    <AlertTitle className="font-semibold text-blue-800">
                      {dict.info.title}
                    </AlertTitle>
                    <AlertDescription className="text-blue-700">
                      {infoMessage}
                    </AlertDescription>
                  </Alert>
                </motion.div>
              )}
            </AnimatePresence>

            {/* OTP Input Form */}
            <form onSubmit={handleVerifyCode} className="space-y-8">
              {/* Code Input Boxes */}
              <div className="flex justify-center gap-2 md:gap-3" dir="ltr">
                {code.map((digit, index) => (
                  <motion.div
                    key={index}
                    initial={{ opacity: 0, scale: 0.8 }}
                    animate={{ opacity: 1, scale: 1 }}
                    transition={{ duration: 0.3, delay: index * 0.05 }}
                    whileHover={{ scale: 1.05 }}
                  >
                    <Input
                      ref={(el: HTMLInputElement | null) => {
                        inputRefs.current[index] = el;
                      }}
                      type="text"
                      inputMode="numeric"
                      maxLength={1}
                      value={digit}
                      onChange={(e) => handleInputChange(index, e.target.value)}
                      onKeyDown={(e) => handleKeyDown(index, e)}
                      onFocus={() => setFocusedIndex(index)}
                      onBlur={() => setFocusedIndex(null)}
                      disabled={disableForm}
                      required
                      aria-label={dict.digitAriaLabel.replace(
                        '{{index}}',
                        (index + 1).toString()
                      )}
                      className={`
                        w-12 h-14 md:w-14 md:h-16 
                        text-center text-2xl md:text-3xl font-bold 
                        border-2 rounded-xl
                        transition-all duration-300
                        shadow-md
                        ${
                          focusedIndex === index
                            ? 'border-cyan-500 ring-4 ring-cyan-200 scale-105 bg-white'
                            : digit
                              ? 'border-green-400 bg-green-50'
                              : 'border-gray-300 bg-white/50'
                        }
                        ${disableForm ? 'opacity-50 cursor-not-allowed' : 'hover:border-cyan-400'}
                      `}
                    />
                  </motion.div>
                ))}
              </div>

              {/* Progress Indicator */}
              <div className="flex justify-center items-center gap-2">
                {code.map((digit, index) => (
                  <motion.div
                    key={index}
                    className={`h-1.5 rounded-full transition-all duration-300 ${
                      digit
                        ? 'bg-gradient-to-r from-cyan-500 to-pink-500 w-8'
                        : 'bg-gray-200 w-4'
                    }`}
                    animate={{
                      scale: digit ? [1, 1.2, 1] : 1,
                    }}
                    transition={{ duration: 0.3 }}
                  />
                ))}
              </div>

              {/* Verify Button */}
              <motion.div
                whileHover={{ scale: disableForm ? 1 : 1.02 }}
                whileTap={{ scale: disableForm ? 1 : 0.98 }}
              >
                <Button
                  type="submit"
                  disabled={disableForm || !isCodeComplete}
                  className="w-full py-6 text-lg font-bold rounded-xl bg-gradient-to-r from-purple-600 via-pink-600 to-rose-600 hover:from-purple-700 hover:via-pink-700 hover:to-rose-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden group"
                >
                  {isLoading ? (
                    <div className="flex items-center justify-center gap-3">
                      <Loader2 className="animate-spin h-6 w-6" />
                      <span>{dict.verifyingButton}</span>
                    </div>
                  ) : (
                    <div className="flex items-center justify-center gap-3">
                      <CheckCircle className="h-6 w-6" />
                      <span>{dict.verifyButton}</span>
                      {isRTL ? (
                        <ArrowLeft className="h-5 w-5 group-hover:-translate-x-1 transition-transform" />
                      ) : (
                        <ArrowRight className="h-5 w-5 group-hover:translate-x-1 transition-transform" />
                      )}
                    </div>
                  )}
                  {/* Shine effect */}
                  <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent group-hover:translate-x-full transition-transform duration-1000" />
                </Button>
              </motion.div>
            </form>

            {/* Resend Section */}
            <div className="space-y-4 pt-6 border-t border-gray-200">
              <div className="text-center">
                <p className="text-sm text-gray-600 mb-3">
                  {dict.resend.prompt}
                </p>
                <motion.div
                  whileHover={{ scale: disableResend ? 1 : 1.05 }}
                  whileTap={{ scale: disableResend ? 1 : 0.95 }}
                >
                  <Button
                    type="button"
                    variant="outline"
                    onClick={handleResendCode}
                    disabled={disableResend}
                    className={`
                      px-6 py-3 rounded-full border-2 font-semibold
                      transition-all duration-300
                      ${
                        disableResend
                          ? 'border-gray-300 text-gray-400 cursor-not-allowed'
                          : 'border-cyan-500 text-cyan-600 hover:bg-cyan-50 hover:border-cyan-600'
                      }
                    `}
                  >
                    {isResending ? (
                      <div className="flex items-center gap-2">
                        <Loader2 className="animate-spin h-4 w-4" />
                        <span>{dict.resend.buttonLoading}</span>
                      </div>
                    ) : resendDisabled ? (
                      <div className="flex items-center gap-3">
                        <CircularTimer
                          seconds={resendTimer}
                          maxSeconds={RESEND_COOLDOWN}
                        />
                        <span>
                          {dict.resend.timer.replace(
                            '{{timer}}',
                            resendTimer.toString()
                          )}
                        </span>
                      </div>
                    ) : (
                      <div className="flex items-center gap-2">
                        <RefreshCw className="h-4 w-4" />
                        <span>{dict.resend.button}</span>
                      </div>
                    )}
                  </Button>
                </motion.div>
              </div>

              {/* Wrong Number Link */}
              <div className="text-center">
                <Link
                  href={`/${locale}/auth/update-phone`}
                  className={`
                    text-sm font-medium inline-flex items-center gap-2
                    transition-all duration-300
                    ${
                      disableForm
                        ? 'text-gray-400 pointer-events-none'
                        : 'text-cyan-600 hover:text-cyan-700 hover:gap-3'
                    }
                  `}
                >
                  <Clock className="h-4 w-4" />
                  <span>{dict.wrongNumberLink}</span>
                </Link>
              </div>
            </div>

            {/* Back to Sign In */}
            <div className="text-center pt-4 border-t border-gray-200">
              <Link
                href={`/${locale}/auth/signin`}
                className={`
                  text-xs text-gray-500 hover:text-gray-700 
                  transition-colors duration-300
                  inline-flex items-center gap-2
                  ${disableForm ? 'pointer-events-none opacity-50' : ''}
                `}
              >
                {isRTL ? (
                  <ArrowRight className="h-3 w-3" />
                ) : (
                  <ArrowLeft className="h-3 w-3" />
                )}
                <span>{dict.backToSignInLink}</span>
              </Link>
            </div>
          </div>
        </motion.div>

        {/* Bottom Decoration */}
        <motion.div variants={itemVariants} className="mt-8 text-center">
          <div className="inline-flex items-center gap-2 text-sm text-gray-500">
            <Shield className="h-4 w-4" />
            <span>מוגן באמצעות הצפנת SSL</span>
          </div>
        </motion.div>
      </motion.div>

      {/* Custom Styles */}
      <style>{`
        @keyframes shimmer {
          0% {
            background-position: -1000px 0;
          }
          100% {
            background-position: 1000px 0;
          }
        }
      `}</style>
    </div>
  );
};

export default VerifyPhoneClient;
--- End of Content for VerifyPhoneClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-phone\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/verify-phone/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import VerifyPhoneClient from './VerifyPhoneClient';

// ▼▼▼ כאן השינוי ▼▼▼
type VerifyPhonePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function VerifyPhonePage({ params }: VerifyPhonePageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <VerifyPhoneClient
      dict={dictionary.auth.verifyPhone}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

--- End of Content for auth_contents.txt ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\error
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\error\AuthErrorClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/error/AuthErrorClient.tsx
'use client';

import { useSearchParams, useRouter } from "next/navigation";
import { Card, CardHeader, CardTitle, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { AlertTriangle } from "lucide-react";
import type { AuthErrorDict } from '@/types/dictionaries/auth';

interface AuthErrorClientProps {
    dict: AuthErrorDict;
}

export default function AuthErrorClient({ dict }: AuthErrorClientProps) {
  const searchParams = useSearchParams();
  const router = useRouter();
  const error = searchParams.get("error");

  const getErrorMessage = (error: string | null) => {
    switch (error) {
      case "CredentialsSignin":
        return dict.errors.CredentialsSignin;
      case "OAuthAccountNotLinked":
        return dict.errors.OAuthAccountNotLinked;
      default:
        return dict.errors.Default;
    }
  };

  return (
    <Card className="w-full max-w-md">
      <CardHeader className="text-center">
        <AlertTriangle className="mx-auto h-12 w-12 text-red-500" />
        <CardTitle className="text-2xl font-bold text-red-600 mt-4">
          {dict.title}
        </CardTitle>
      </CardHeader>
      <CardContent className="space-y-4 text-center">
        <p className="text-gray-600">{getErrorMessage(error)}</p>
        <Button onClick={() => router.push("/auth/signin")} className="w-full">
          {dict.backButton}
        </Button>
      </CardContent>
    </Card>
  );
}
--- End of Content for AuthErrorClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\error\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/error/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import AuthErrorClient from './AuthErrorClient';

function Loading() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <Loader2 className="h-8 w-8 animate-spin text-gray-500" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼

// 1. הגדרת טיפוס (type) נכון עבור ה-props
type ErrorPageProps = {
  params: Promise<{ locale: Locale }>;
};

// 2. עדכון חתימת הפונקציה והוספת await
export default async function ErrorPage({ params }: ErrorPageProps) {
  const { locale } = await params; // <-- הוספת await
  const dictionary = await getDictionary(locale);

  return (
    <div className="min-h-screen flex items-center justify-center p-4 bg-gray-50">
      <Suspense fallback={<Loading />}>
        <AuthErrorClient dict={dictionary.auth.errorPage} />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\forgot-password
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\forgot-password\ForgotPasswordClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/forgot-password/ForgotPasswordClient.tsx
'use client';

import { useState, FormEvent } from 'react';
import { useRouter } from 'next/navigation';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import {
  Mail,
  Loader2,
  AlertCircle,
  ArrowLeft,
  ArrowRight,
  Send,
  KeyRound,
  Sparkles,
  CheckCircle2,
} from 'lucide-react';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import type { ForgotPasswordDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface ForgotPasswordClientProps {
  dict: ForgotPasswordDict;
  locale: 'he' | 'en';
}

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

// ============================================================================
// BACKGROUND COMPONENT (Teal/Orange Theme)
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-teal-400/20 to-emerald-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-orange-400/20 to-amber-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-rose-400/15 to-orange-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />

    {/* Dot Pattern (Teal) */}
    <div className="absolute inset-0 opacity-[0.03] bg-[radial-gradient(#0d9488_1px,transparent_1px)] [background-size:24px_24px]" />

    {/* SVG Decorative Wave (Teal -> Orange) */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1000 1000"
      xmlns="http://www.w3.org/2000/svg"
      preserveAspectRatio="none"
    >
      <defs>
        <linearGradient id="waveGrad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stopColor="#0d9488" stopOpacity="0.08" />
          <stop offset="100%" stopColor="#f97316" stopOpacity="0.04" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,200 C300,100 700,300 1000,200 L1000,0 L0,0 Z"
        fill="url(#waveGrad)"
        initial={{ opacity: 0.6 }}
        animate={{ opacity: [0.6, 0.9, 0.6] }}
        transition={{ duration: 8, repeat: Infinity, ease: 'easeInOut' }}
      />
    </svg>
  </div>
);

// ============================================================================
// MAIN COMPONENT
// ============================================================================

export default function ForgotPasswordClient({
  dict,
  locale,
}: ForgotPasswordClientProps) {
  const router = useRouter();
  const [email, setEmail] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);

  const isRTL = locale === 'he';

  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);

    if (!email) {
      setError(dict.errors.missingEmail);
      setIsLoading(false);
      return;
    }

    try {
      const response = await fetch(
        `/api/auth/request-password-reset?locale=${locale}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email }),
        }
      );

      const data = await response.json();

      if (!response.ok || !data.success) {
        throw new Error(data.error || dict.errors.default);
      }

      // Show success message before redirect
      setSuccess(true);

      // Redirect after showing success
      setTimeout(() => {
        router.push(
          `/${locale}/auth/reset-password?email=${encodeURIComponent(email)}`
        );
      }, 1500);
    } catch (err) {
      setError(err instanceof Error ? err.message : dict.errors.default);
      setIsLoading(false);
    }
  };

  return (
    <>
      <DynamicBackground />

      <div className="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8 relative z-10">
        {/* Back to Sign In Link */}
        <motion.div
          initial={{ opacity: 0, x: isRTL ? 20 : -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.5 }}
          className={`absolute top-6 ${isRTL ? 'right-6' : 'left-6'}`}
        >
          <Link
            href={`/${locale}/auth/signin`}
            className="group flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors duration-300"
          >
            {isRTL ? (
              <ArrowRight className="w-4 h-4 group-hover:translate-x-1 transition-transform" />
            ) : (
              <ArrowLeft className="w-4 h-4 group-hover:-translate-x-1 transition-transform" />
            )}
            <span className="text-sm font-medium">
              {locale === 'he' ? 'חזרה להתחברות' : 'Back to Sign In'}
            </span>
          </Link>
        </motion.div>

        {/* Hero Section */}
        <motion.div
          variants={containerVariants}
          initial="hidden"
          animate="visible"
          className="mb-8 text-center"
        >
          <motion.div variants={itemVariants} className="mb-4">
            {/* Key Icon Background: Teal -> Orange */}
            <div className="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-teal-400 to-orange-500 rounded-2xl shadow-lg mb-6">
              <motion.div
                animate={{
                  rotate: [0, -10, 10, -10, 0],
                  scale: [1, 1.1, 1],
                }}
                transition={{
                  duration: 3,
                  repeat: Infinity,
                  ease: 'easeInOut',
                }}
              >
                <KeyRound className="w-10 h-10 text-white" />
              </motion.div>
            </div>
          </motion.div>

          <motion.h1
            variants={itemVariants}
            className="text-3xl md:text-4xl font-bold mb-3"
          >
            {/* Title Gradient: Teal -> Orange -> Amber */}
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-teal-500 via-orange-500 to-amber-500 animate-gradient-slow">
              {dict.title}
            </span>
          </motion.h1>

          <motion.p
            variants={itemVariants}
            className="text-gray-600 text-base md:text-lg max-w-md mx-auto px-4"
          >
            {dict.subtitle}
          </motion.p>

          {/* Decorative Line (Teal -> Orange) */}
          <motion.div variants={itemVariants} className="relative mt-6">
            <div className="w-20 h-1 bg-gradient-to-r from-teal-400 via-orange-400 to-amber-400 rounded-full mx-auto" />
          </motion.div>
        </motion.div>

        {/* Main Card */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5, delay: 0.3 }}
          className="w-full max-w-md"
        >
          <div className="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/60 overflow-hidden relative">
            {/* Top Gradient Line */}
            <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-teal-400 via-orange-400 to-amber-400" />

            {/* Decorative Elements */}
            <div className="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-teal-400/10 to-transparent rounded-full transform translate-x-20 -translate-y-20 pointer-events-none" />
            <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-orange-400/10 to-transparent rounded-full transform -translate-x-16 translate-y-16 pointer-events-none" />

            <div className="relative z-10 p-6 sm:p-8">
              {/* Success State */}
              <AnimatePresence mode="wait">
                {success ? (
                  <motion.div
                    key="success"
                    initial={{ opacity: 0, scale: 0.9 }}
                    animate={{ opacity: 1, scale: 1 }}
                    exit={{ opacity: 0, scale: 0.9 }}
                    className="text-center py-8"
                  >
                    {/* Success Icon (Green is usually good to keep for success, or switch to Teal) */}
                    <motion.div
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      transition={{
                        delay: 0.2,
                        type: 'spring',
                        stiffness: 200,
                      }}
                      className="inline-flex items-center justify-center w-20 h-20 bg-emerald-100 rounded-full mb-6"
                    >
                      <CheckCircle2 className="w-10 h-10 text-emerald-600" />
                    </motion.div>

                    <motion.h2
                      initial={{ opacity: 0, y: 10 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ delay: 0.3 }}
                      className="text-2xl font-bold text-gray-800 mb-3"
                    >
                      {locale === 'he' ? 'נשלח בהצלחה!' : 'Email Sent!'}
                    </motion.h2>

                    <motion.p
                      initial={{ opacity: 0, y: 10 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ delay: 0.4 }}
                      className="text-gray-600 mb-6"
                    >
                      {locale === 'he'
                        ? 'מעביר אותך לדף איפוס הסיסמה...'
                        : 'Redirecting to reset password...'}
                    </motion.p>

                    <motion.div
                      initial={{ opacity: 0 }}
                      animate={{ opacity: 1 }}
                      transition={{ delay: 0.5 }}
                    >
                      {/* Loader -> Teal */}
                      <Loader2 className="w-6 h-6 animate-spin text-teal-500 mx-auto" />
                    </motion.div>
                  </motion.div>
                ) : (
                  <motion.div
                    key="form"
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                  >
                    {/* Info Box -> Teal/Orange mix */}
                    <motion.div
                      initial={{ opacity: 0, y: -10 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ delay: 0.2 }}
                      className="mb-6 p-4 bg-gradient-to-r from-teal-50 to-orange-50 rounded-2xl border border-teal-100"
                    >
                      <div className="flex items-start gap-3">
                        <div className="p-2 bg-white rounded-lg flex-shrink-0">
                          {/* Sparkles -> Teal */}
                          <Sparkles className="w-5 h-5 text-teal-500" />
                        </div>
                        <p className="text-sm text-gray-700 leading-relaxed pt-1">
                          {locale === 'he'
                            ? 'נשלח לך קישור לאיפוס הסיסמה למייל שרשמת'
                            : "We'll send you a link to reset your password"}
                        </p>
                      </div>
                    </motion.div>

                    {/* Error Alert */}
                    <AnimatePresence>
                      {error && (
                        <motion.div
                          initial={{ opacity: 0, y: -10, height: 0 }}
                          animate={{ opacity: 1, y: 0, height: 'auto' }}
                          exit={{ opacity: 0, y: -10, height: 0 }}
                          className="mb-6"
                        >
                          <Alert variant="destructive" className="border-2">
                            <div className="flex items-start gap-3">
                              <div className="p-2 bg-red-100 rounded-lg flex-shrink-0">
                                <AlertCircle className="h-5 w-5 text-red-600" />
                              </div>
                              <div className="flex-1">
                                <AlertTitle className="font-bold mb-1">
                                  {dict.errors.title}
                                </AlertTitle>
                                <AlertDescription className="text-sm">
                                  {error}
                                </AlertDescription>
                              </div>
                            </div>
                          </Alert>
                        </motion.div>
                      )}
                    </AnimatePresence>

                    {/* Form */}
                    <form onSubmit={handleSubmit} className="space-y-6">
                      {/* Email Field */}
                      <div className="space-y-2">
                        <label
                          htmlFor="email-forgot"
                          className="block text-sm font-semibold text-gray-700"
                        >
                          {dict.emailLabel}
                        </label>
                        <div className="relative group">
                          <div
                            className={`absolute ${isRTL ? 'right-3' : 'left-3'} top-1/2 transform -translate-y-1/2 transition-colors ${
                              email ? 'text-teal-500' : 'text-gray-400'
                            }`}
                          >
                            <Mail className="h-5 w-5" />
                          </div>
                          <Input
                            type="email"
                            id="email-forgot"
                            value={email}
                            onChange={(e) => setEmail(e.target.value)}
                            placeholder={dict.emailPlaceholder}
                            required
                            // Input Focus -> Teal
                            className={`w-full ${isRTL ? 'pr-11 pl-4' : 'pl-11 pr-4'} py-3.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-200 focus:border-teal-400 focus:outline-none transition-all bg-white/50 backdrop-blur-sm hover:border-gray-300 text-gray-800 placeholder:text-gray-400`}
                            disabled={isLoading}
                            dir={isRTL ? 'rtl' : 'ltr'}
                          />
                        </div>
                      </div>

                      {/* Submit Button -> Teal/Orange/Amber */}
                      <Button
                        type="submit"
                        disabled={isLoading}
                        className="w-full py-4 bg-gradient-to-r from-teal-500 via-orange-500 to-amber-500 hover:from-teal-600 hover:via-orange-600 hover:to-amber-600 shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2 rounded-xl text-base font-semibold group relative overflow-hidden"
                      >
                        {/* Shine effect */}
                        <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000" />

                        {isLoading ? (
                          <>
                            <Loader2 className="h-5 w-5 animate-spin" />
                            <span>{dict.submitButtonLoading}</span>
                          </>
                        ) : (
                          <>
                            <Send className="w-5 h-5" />
                            <span>{dict.submitButton}</span>
                          </>
                        )}
                      </Button>
                    </form>

                    {/* Back Link */}
                    <div className="mt-8 text-center">
                      <p className="text-gray-600 text-sm">
                        {locale === 'he'
                          ? 'זכרת את הסיסמה?'
                          : 'Remember your password?'}{' '}
                        <Link
                          href={`/${locale}/auth/signin`}
                          className="text-teal-600 font-semibold hover:text-teal-700 hover:underline transition-colors inline-flex items-center gap-1"
                        >
                          {dict.backToSignInLink}
                          {isRTL ? (
                            <ArrowLeft className="w-3 h-3" />
                          ) : (
                            <ArrowRight className="w-3 h-3" />
                          )}
                        </Link>
                      </p>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>

            {/* Bottom Shine Effect -> Teal/Orange */}
            <div className="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-teal-400 via-orange-400 to-amber-400 opacity-50" />
          </div>
        </motion.div>

        {/* Help Text */}
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.8, duration: 0.5 }}
          className="mt-8 text-center max-w-md"
        >
          <p className="text-xs text-gray-500">
            {locale === 'he'
              ? 'לא קיבלת מייל? בדוק את תיקיית הספאם או נסה שוב'
              : "Didn't receive an email? Check your spam folder or try again"}
          </p>
        </motion.div>
      </div>

      {/* Animations CSS */}
      <style>{`
        @keyframes gradient-slow {
          0%,
          100% {
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
        }
        .animate-gradient-slow {
          background-size: 200% 200%;
          animation: gradient-slow 6s ease infinite;
        }
      `}</style>
    </>
  );
}
--- End of Content for ForgotPasswordClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\forgot-password\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/forgot-password/page.tsx
import Link from 'next/link';
import { ArrowLeft } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import ForgotPasswordClient from './ForgotPasswordClient';

// ▼▼▼ כאן השינוי ▼▼▼
type ForgotPasswordPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ForgotPasswordPage({ params }: ForgotPasswordPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-cyan-50 via-white to-pink-50 p-4 sm:p-8">
      <Link
        href="/"
        className="absolute top-4 left-4 rtl:right-4 rtl:left-auto text-gray-600 hover:text-gray-800 transition-colors flex items-center gap-1 text-sm z-20"
      >
        <ArrowLeft
          className={`h-4 w-4 ${locale === 'he' ? 'transform rotate-180' : ''}`}
        />{' '}
        חזרה לדף הבית
      </Link>
      <ForgotPasswordClient
        dict={dictionary.auth.forgotPassword}
        locale={locale}
      />
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\register
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\register\RegisterClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/register/RegisterClient.tsx
'use client';

import React, { useEffect, useState } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { useSession } from 'next-auth/react';
import {
  RegistrationProvider,
  useRegistration,
} from '@/components/auth/RegistrationContext';
import Link from 'next/link';
import { motion, AnimatePresence } from 'framer-motion';
import {
  Info,
  Loader2,
  Sparkles,
  Heart,
  Shield,
  ArrowRight,
  ArrowLeft,
} from 'lucide-react';

// Import step components
import WelcomeStep from '@/components/auth/steps/WelcomeStep';
import BasicInfoStep from '@/components/auth/steps/BasicInfoStep';
import EmailVerificationCodeStep from '@/components/auth/steps/EmailVerificationCodeStep';
import PersonalDetailsStep from '@/components/auth/steps/PersonalDetailsStep';
import CompleteStep from '@/components/auth/steps/CompleteStep';
import ProgressBar from '@/components/auth/ProgressBar';

import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import type { User as SessionUserType } from '@/types/next-auth';
import type { RegisterStepsDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface RegisterClientProps {
  dict: RegisterStepsDict;
  locale: 'he' | 'en';
}

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const pageTransition = {
  initial: { opacity: 0, y: 20 },
  animate: { opacity: 1, y: 0 },
  exit: { opacity: 0, y: -20 },
  transition: { duration: 0.4, ease: 'easeOut' },
};

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

// ============================================================================
// BACKGROUND COMPONENT (מעודכן לפלטת Teal/Orange)
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-teal-400/20 to-emerald-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-orange-400/20 to-amber-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-rose-400/15 to-orange-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />
    <motion.div
      className="absolute bottom-20 right-10 w-64 h-64 bg-gradient-to-br from-teal-400/20 to-cyan-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 35, 0],
        scale: [1, 1.12, 1],
      }}
      transition={{
        duration: 16,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 0.5,
      }}
    />

    {/* Dot Pattern (Teal Accent) */}
    <div className="absolute inset-0 opacity-[0.03] bg-[radial-gradient(#0d9488_1px,transparent_1px)] [background-size:24px_24px]" />

    {/* SVG Decorative Waves (Teal -> Orange) */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1000 1000"
      xmlns="http://www.w3.org/2000/svg"
      preserveAspectRatio="none"
    >
      <defs>
        <linearGradient id="waveGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stopColor="#0d9488" stopOpacity="0.08" />{' '}
          {/* Teal */}
          <stop offset="100%" stopColor="#f97316" stopOpacity="0.04" />{' '}
          {/* Orange */}
        </linearGradient>
        <linearGradient id="waveGrad2" x1="100%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stopColor="#f59e0b" stopOpacity="0.06" />{' '}
          {/* Amber */}
          <stop offset="100%" stopColor="#14b8a6" stopOpacity="0.03" />{' '}
          {/* Teal */}
        </linearGradient>
      </defs>
      <motion.path
        d="M0,200 C300,100 700,300 1000,200 L1000,0 L0,0 Z"
        fill="url(#waveGrad1)"
        initial={{ opacity: 0.6 }}
        animate={{ opacity: [0.6, 0.9, 0.6] }}
        transition={{ duration: 8, repeat: Infinity, ease: 'easeInOut' }}
      />
      <motion.path
        d="M0,800 C300,700 700,900 1000,800 L1000,1000 L0,1000 Z"
        fill="url(#waveGrad2)"
        initial={{ opacity: 0.6 }}
        animate={{ opacity: [0.6, 0.8, 0.6] }}
        transition={{
          duration: 10,
          repeat: Infinity,
          ease: 'easeInOut',
          delay: 2,
        }}
      />
    </svg>
  </div>
);

// ============================================================================
// HERO SECTION
// ============================================================================

interface HeroSectionProps {
  title: string;
  subtitle: string;
  locale: 'he' | 'en';
}

const HeroSection: React.FC<HeroSectionProps> = ({
  title,
  subtitle,
  locale,
}) => {
  const isRTL = locale === 'he';

  return (
    <motion.div
      variants={containerVariants}
      initial="hidden"
      animate="visible"
      className="mb-8 text-center"
    >
      <motion.div variants={itemVariants} className="mb-4">
        <div className="inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/60 mb-6">
          <motion.div
            animate={{ rotate: [0, 10, -10, 0] }}
            transition={{ duration: 2, repeat: Infinity, ease: 'easeInOut' }}
          >
            {/* Sparkles - Teal (Tech) */}
            <Sparkles className="w-5 h-5 text-teal-500" />
          </motion.div>
          <span className="text-sm font-medium text-gray-700">
            {locale === 'he' ? 'הצעד הראשון למסע שלכם' : 'Your First Step'}
          </span>
          {/* Heart - Orange (Human) */}
          <Heart className="w-5 h-5 text-orange-500" />
        </div>
      </motion.div>

      <motion.h1
        variants={itemVariants}
        className="text-3xl md:text-4xl lg:text-5xl font-bold mb-4"
      >
        {/* Main Gradient Text */}
        <span className="text-transparent bg-clip-text bg-gradient-to-r from-teal-500 via-orange-500 to-amber-500 animate-gradient-slow">
          {title}
        </span>
      </motion.h1>

      <motion.p
        variants={itemVariants}
        className="text-gray-600 text-base md:text-lg max-w-2xl mx-auto leading-relaxed px-4"
        style={{
          direction: isRTL ? 'rtl' : 'ltr',
          textAlign: 'center',
        }}
      >
        {subtitle}
      </motion.p>

      {/* Decorative Line (Teal -> Orange) */}
      <motion.div variants={itemVariants} className="relative mt-6">
        <div className="w-24 h-1 bg-gradient-to-r from-teal-400 via-orange-400 to-amber-400 rounded-full mx-auto" />
        <motion.div
          className="absolute top-0 left-1/2 -translate-x-1/2 w-2 h-2 bg-white rounded-full border-2 border-orange-400"
          animate={{ scale: [1, 1.3, 1] }}
          transition={{ duration: 2, repeat: Infinity, ease: 'easeInOut' }}
        />
      </motion.div>
    </motion.div>
  );
};

// ============================================================================
// MAIN REGISTRATION STEPS CONTENT
// ============================================================================

const RegisterStepsContent: React.FC<{
  dict: RegisterStepsDict;
  locale: 'he' | 'en';
}> = ({ dict, locale }) => {
  const {
    data: registrationContextData,
    initializeFromSession,
    resetForm,
    goToStep,
  } = useRegistration();
  const router = useRouter();
  const { data: session, status: sessionStatus } = useSession();
  const searchParams = useSearchParams();

  const [showIncompleteProfileMessage, setShowIncompleteProfileMessage] =
    useState(false);
  const [initializationAttempted, setInitializationAttempted] = useState(false);

  const isRTL = locale === 'he';

  // Handle incomplete profile message
  useEffect(() => {
    const reasonParam = searchParams.get('reason');
    if (
      (reasonParam === 'complete_profile' || reasonParam === 'verify_phone') &&
      !registrationContextData.isCompletingProfile
    ) {
      setShowIncompleteProfileMessage(true);
    } else {
      setShowIncompleteProfileMessage(false);
    }
  }, [searchParams, registrationContextData.isCompletingProfile]);

  // Initialize from session
  useEffect(() => {
    if (sessionStatus === 'loading') return;

    if (sessionStatus === 'authenticated' && session?.user) {
      const user = session.user as SessionUserType;
      if (
        user.isProfileComplete &&
        user.isPhoneVerified &&
        user.termsAndPrivacyAcceptedAt
      ) {
        if (
          typeof window !== 'undefined' &&
          window.location.pathname !== `/${locale}/profile`
        ) {
          router.push(`/${locale}/profile`);
        }
        return;
      }

      const needsSetup =
        !user.termsAndPrivacyAcceptedAt ||
        !user.isProfileComplete ||
        !user.isPhoneVerified;
      if (
        needsSetup &&
        (!initializationAttempted ||
          (registrationContextData.step === 0 &&
            !registrationContextData.isVerifyingEmailCode))
      ) {
        initializeFromSession(user);
        setInitializationAttempted(true);
      }
    }
  }, [
    sessionStatus,
    session,
    router,
    registrationContextData,
    initializeFromSession,
    resetForm,
    goToStep,
    initializationAttempted,
    searchParams,
    locale,
  ]);

  // Render appropriate step
  const renderStep = (): React.ReactNode => {
    if (sessionStatus === 'loading') {
      return (
        <div className="flex flex-col items-center justify-center p-16">
          <Loader2 className="h-10 w-10 animate-spin text-teal-600 mb-4" />
          <p className="text-gray-600 text-sm">
            {locale === 'he' ? 'טוען...' : 'Loading...'}
          </p>
        </div>
      );
    }

    if (
      registrationContextData.isVerifyingEmailCode &&
      !registrationContextData.isCompletingProfile
    ) {
      return (
        <EmailVerificationCodeStep
          dict={dict.steps.emailVerification}
          locale={locale}
        />
      );
    }

    if (registrationContextData.isCompletingProfile) {
      switch (registrationContextData.step) {
        case 2:
          return (
            <PersonalDetailsStep
              personalDetailsDict={dict.steps.personalDetails}
              optionalInfoDict={dict.steps.optionalInfo}
              consentDict={dict.consentCheckbox}
              locale={locale}
            />
          );
        case 4:
          return <CompleteStep dict={dict.steps.complete} />;
        default:
          resetForm();
          return <WelcomeStep dict={dict.steps.welcome} locale={locale} />;
      }
    }

    switch (registrationContextData.step) {
      case 0:
        return <WelcomeStep dict={dict.steps.welcome} locale={locale} />;
      case 1:
        return (
          <BasicInfoStep
            dict={dict.steps.basicInfo}
            consentDict={dict.consentCheckbox}
            locale={locale}
          />
        );
      default:
        resetForm();
        return <WelcomeStep dict={dict.steps.welcome} locale={locale} />;
    }
  };

  // Determine page title and progress
  let pageTitle = dict.headers.registerTitle;
  let stepDescription = dict.headers.welcomeDescription;
  let currentProgressBarStep = 0;
  let totalProgressBarSteps = 3;
  let showProgressBar = false;

  if (
    registrationContextData.isVerifyingEmailCode &&
    !registrationContextData.isCompletingProfile
  ) {
    pageTitle = dict.headers.verifyEmailTitle;
    stepDescription = dict.headers.verifyEmailDescription.replace(
      '{{email}}',
      registrationContextData.emailForVerification || ''
    );
    showProgressBar = true;
    currentProgressBarStep = 1;
  } else if (registrationContextData.isCompletingProfile) {
    pageTitle = dict.headers.completeProfileTitle;
    totalProgressBarSteps = 1;
    if (registrationContextData.step === 2) {
      stepDescription = session?.user?.termsAndPrivacyAcceptedAt
        ? dict.headers.personalDetailsConsentedDescription
        : dict.headers.personalDetailsDescription;
      currentProgressBarStep = 1;
      showProgressBar = true;
    } else if (registrationContextData.step === 4) {
      stepDescription = session?.user?.isPhoneVerified
        ? dict.headers.completionReadyDescription
        : dict.headers.completionPhoneVerificationDescription;
      showProgressBar = false;
    } else {
      stepDescription = dict.headers.loadingProfileDescription;
      showProgressBar = false;
    }
  } else {
    if (registrationContextData.step === 1) {
      pageTitle = dict.headers.registerTitle;
      stepDescription = dict.headers.accountCreationDescription;
      currentProgressBarStep = 1;
      showProgressBar = true;
    }
  }

  const isWideStep =
    registrationContextData.isCompletingProfile &&
    registrationContextData.step === 2;

  return (
    <>
      <DynamicBackground />

      <div className="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8 relative z-10">
        {/* Hero Section */}
        <HeroSection
          title={pageTitle}
          subtitle={stepDescription}
          locale={locale}
        />

        {/* Incomplete Profile Alert */}
        <AnimatePresence>
          {showIncompleteProfileMessage && (
            <motion.div
              initial={{ opacity: 0, y: -20, scale: 0.95 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, y: -20, scale: 0.95 }}
              transition={{ duration: 0.3 }}
              className="w-full max-w-md md:max-w-2xl mb-6 mx-auto"
            >
              <Alert className="bg-gradient-to-r from-amber-50 to-orange-50 border-2 border-amber-200 shadow-lg">
                <div className="flex items-start gap-3">
                  <div className="p-2 bg-amber-100 rounded-lg">
                    <Info className="h-5 w-5 text-amber-600" />
                  </div>
                  <div className="flex-1">
                    <AlertTitle className="font-bold text-amber-900 mb-1">
                      {dict.incompleteProfileAlert.title}
                    </AlertTitle>
                    <AlertDescription className="text-sm text-amber-800 leading-relaxed">
                      {searchParams.get('reason') === 'verify_phone'
                        ? dict.incompleteProfileAlert.verifyPhoneDescription
                        : dict.incompleteProfileAlert.description}
                    </AlertDescription>
                  </div>
                </div>
              </Alert>
            </motion.div>
          )}
        </AnimatePresence>

        {/* Progress Bar */}
        <AnimatePresence>
          {showProgressBar && (
            <motion.div
              initial={{ opacity: 0, y: -10 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -10 }}
              transition={{ duration: 0.4 }}
              className="w-full max-w-md md:max-w-2xl mb-6 mx-auto"
            >
              <ProgressBar
                currentStep={currentProgressBarStep}
                totalSteps={totalProgressBarSteps}
                stepLabel={dict.progressBar.stepLabel}
                locale={locale}
              />
            </motion.div>
          )}
        </AnimatePresence>

        {/* Main Card Container */}
        <motion.div
          {...pageTransition}
          className="w-full max-w-md md:max-w-2xl relative"
        >
          <div className="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/60 overflow-hidden relative">
            {/* Decorative Elements - POINTER EVENTS NONE */}
            <div className="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-teal-400/10 to-transparent rounded-full transform translate-x-20 -translate-y-20 pointer-events-none" />
            <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-orange-400/10 to-transparent rounded-full transform -translate-x-16 translate-y-16 pointer-events-none" />

            {/* Content - Z-10 RELATIVE */}
            <div className="relative z-10 p-6 sm:p-8 md:p-12">
              <AnimatePresence mode="wait">
                <motion.div
                  key={registrationContextData.step}
                  initial={{ opacity: 0, x: isRTL ? -20 : 20 }}
                  animate={{ opacity: 1, x: 0 }}
                  exit={{ opacity: 0, x: isRTL ? 20 : -20 }}
                  transition={{ duration: 0.3 }}
                  className={isWideStep ? 'w-full' : 'max-w-md mx-auto'}
                >
                  {renderStep()}
                </motion.div>
              </AnimatePresence>
            </div>

            {/* Bottom Shine Effect (Teal -> Orange) */}
            <div className="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-teal-400 via-orange-400 to-amber-400 opacity-50 pointer-events-none" />
          </div>
        </motion.div>

        {/* Support Link */}
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.5, duration: 0.5 }}
          className="mt-8 text-center"
        >
          <p className="text-sm text-gray-500">
            {dict.contactSupport}{' '}
            <Link
              href={`/${locale}/contact`}
              className="text-teal-600 hover:text-teal-700 font-medium hover:underline transition-colors inline-flex items-center gap-1"
            >
              {dict.contactSupportLink}
              <Shield className="w-3 h-3" />
            </Link>
          </p>
        </motion.div>
      </div>

      {/* Animations CSS */}
      <style>{`
        @keyframes gradient-slow {
          0%,
          100% {
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
        }
        .animate-gradient-slow {
          background-size: 200% 200%;
          animation: gradient-slow 6s ease infinite;
        }
      `}</style>
    </>
  );
};

// ============================================================================
// MAIN EXPORT WITH PROVIDER
// ============================================================================

export default function RegisterClient({ dict, locale }: RegisterClientProps) {
  return (
    <RegistrationProvider>
      <RegisterStepsContent dict={dict} locale={locale} />
    </RegistrationProvider>
  );
}
--- End of Content for RegisterClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\register\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/register/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import RegisterClient from './RegisterClient';

function Loading() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <Loader2 className="h-10 w-10 animate-spin text-cyan-600" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type RegisterPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function RegisterPage({ params }: RegisterPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <Suspense fallback={<Loading />}>
      <RegisterClient
        dict={dictionary.auth.register}
        locale={locale}
      />
    </Suspense>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\reset-password
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\reset-password\ResetPasswordClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/reset-password/ResetPasswordClient.tsx
'use client';

import { useState, FormEvent, useEffect } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Lock,
  KeySquare,
  Loader2,
  AlertCircle,
  CheckCircle,
  Eye,
  EyeOff,
  Mail,
} from 'lucide-react';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import Link from 'next/link';
import type { ResetPasswordDict } from '@/types/dictionaries/auth';

interface ResetPasswordClientProps {
  dict: ResetPasswordDict;
  locale: 'he' | 'en'; // הוסף
}

const validatePassword = (
  value: string,
  validationMessage: string
): string | null => {
  const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
  if (!passwordRegex.test(value)) {
    return validationMessage;
  }
  return null;
};

export default function ResetPasswordClient({
  dict,
  locale,
}: ResetPasswordClientProps) {
  const router = useRouter();
  const searchParams = useSearchParams();

  const [email, setEmail] = useState('');
  const [otp, setOtp] = useState('');
  const [newPassword, setNewPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [passwordError, setPasswordError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);

  useEffect(() => {
    const emailFromQuery = searchParams.get('email');
    if (emailFromQuery) setEmail(emailFromQuery);
  }, [searchParams]);

  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);
    setPasswordError(null);

    if (!email) {
      setError(dict.errors.missingEmail);
      setIsLoading(false);
      return;
    }
    if (!otp || otp.length !== 6 || !/^\d+$/.test(otp)) {
      setError(dict.errors.invalidOtp);
      setIsLoading(false);
      return;
    }
    const passValidationError = validatePassword(
      newPassword,
      dict.passwordValidation.length
    );
    if (passValidationError) {
      setPasswordError(passValidationError);
      setIsLoading(false);
      return;
    }
    if (newPassword !== confirmPassword) {
      setError(dict.errors.passwordsMismatch);
      setIsLoading(false);
      return;
    }

    try {
      const response = await fetch(
        `/api/auth/reset-password?locale=${locale}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, otp, newPassword }),
        }
      );
      const data = await response.json();
      if (!response.ok) throw new Error(data.error || dict.errors.default);

      setSuccessMessage(dict.successMessage);
      setTimeout(() => router.push('/auth/signin?reset=success'), 3000);
    } catch (err) {
      setError(err instanceof Error ? err.message : dict.errors.default);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="w-full max-w-md bg-white rounded-xl shadow-xl overflow-hidden relative">
      <div className="absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-cyan-500 to-pink-500"></div>
      <div className="p-6 sm:p-8">
        <div className="text-center mb-6">
          <h1 className="text-2xl font-bold text-gray-800 mb-2">
            {dict.title}
          </h1>
          <p className="text-gray-600 text-sm">{dict.subtitle}</p>
        </div>

        {error && (
          <Alert variant="destructive" className="mb-4" role="alert">
            <AlertCircle className="h-4 w-4" />
            <AlertTitle>שגיאה</AlertTitle>
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        )}
        {passwordError && !error && (
          <Alert variant="destructive" className="mb-4" role="alert">
            <AlertCircle className="h-4 w-4" />
            <AlertTitle>שגיאת סיסמה</AlertTitle>
            <AlertDescription>{passwordError}</AlertDescription>
          </Alert>
        )}
        {successMessage && (
          <Alert className="mb-4 bg-green-50">
            <CheckCircle className="h-4 w-4 text-green-600" />
            <AlertTitle>הצלחה!</AlertTitle>
            <AlertDescription>
              {successMessage} {dict.successRedirect}
            </AlertDescription>
          </Alert>
        )}

        {!successMessage && (
          <form onSubmit={handleSubmit} className="space-y-5">
            <div className="space-y-1">
              <label
                htmlFor="email-reset"
                className="block text-sm font-medium text-gray-700"
              >
                {dict.emailLabel} <span className="text-red-500">*</span>
              </label>
              <div className="relative">
                <Mail className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5" />
                <Input
                  type="email"
                  id="email-reset"
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  placeholder={dict.emailPlaceholder}
                  required
                  disabled={isLoading || !!searchParams.get('email')}
                />
              </div>
            </div>
            <div className="space-y-1">
              <label
                htmlFor="otp-reset"
                className="block text-sm font-medium text-gray-700"
              >
                {dict.otpLabel} <span className="text-red-500">*</span>
              </label>
              <div className="relative">
                <KeySquare className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5" />
                <Input
                  type="text"
                  id="otp-reset"
                  value={otp}
                  onChange={(e) =>
                    setOtp(e.target.value.replace(/[^0-9]/g, '').slice(0, 6))
                  }
                  placeholder={dict.otpPlaceholder}
                  maxLength={6}
                  required
                  disabled={isLoading}
                  inputMode="numeric"
                />
              </div>
            </div>
            <div className="space-y-1">
              <label
                htmlFor="new-password-reset"
                className="block text-sm font-medium text-gray-700"
              >
                {dict.newPasswordLabel} <span className="text-red-500">*</span>
              </label>
              <div className="relative">
                <Lock className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5" />
                <Input
                  type={showPassword ? 'text' : 'password'}
                  id="new-password-reset"
                  value={newPassword}
                  onChange={(e) => setNewPassword(e.target.value)}
                  onBlur={(e) =>
                    setPasswordError(
                      validatePassword(
                        e.target.value,
                        dict.passwordValidation.length
                      )
                    )
                  }
                  placeholder={dict.newPasswordPlaceholder}
                  required
                  disabled={isLoading}
                />
                <button
                  type="button"
                  onClick={() => setShowPassword(!showPassword)}
                  className="absolute left-3 top-1/2 -translate-y-1/2"
                  aria-label={
                    showPassword ? dict.hidePasswordAria : dict.showPasswordAria
                  }
                >
                  {showPassword ? (
                    <EyeOff className="h-5 w-5" />
                  ) : (
                    <Eye className="h-5 w-5" />
                  )}
                </button>
              </div>
              {!passwordError && (
                <p className="mt-1 text-xs text-gray-500">
                  {dict.passwordHint}
                </p>
              )}
            </div>
            <div className="space-y-1">
              <label
                htmlFor="confirm-password-reset"
                className="block text-sm font-medium text-gray-700"
              >
                {dict.confirmPasswordLabel}{' '}
                <span className="text-red-500">*</span>
              </label>
              <div className="relative">
                <Lock className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5" />
                <Input
                  type={showConfirmPassword ? 'text' : 'password'}
                  id="confirm-password-reset"
                  value={confirmPassword}
                  onChange={(e) => setConfirmPassword(e.target.value)}
                  placeholder={dict.confirmPasswordPlaceholder}
                  required
                  disabled={isLoading}
                />
                <button
                  type="button"
                  onClick={() => setShowConfirmPassword(!showConfirmPassword)}
                  className="absolute left-3 top-1/2 -translate-y-1/2"
                  aria-label={
                    showConfirmPassword
                      ? dict.hidePasswordAria
                      : dict.showPasswordAria
                  }
                >
                  {showConfirmPassword ? (
                    <EyeOff className="h-5 w-5" />
                  ) : (
                    <Eye className="h-5 w-5" />
                  )}
                </button>
              </div>
            </div>
            <Button
              type="submit"
              disabled={
                isLoading ||
                !!passwordError ||
                !otp ||
                !newPassword ||
                !confirmPassword ||
                newPassword !== confirmPassword
              }
              className="w-full"
            >
              {isLoading ? (
                <>
                  <Loader2 className="h-5 w-5 animate-spin mr-2" />
                  <span>{dict.submitButtonLoading}</span>
                </>
              ) : (
                dict.submitButton
              )}
            </Button>
          </form>
        )}

        <div className="mt-6 text-center">
          <Link
            href="/auth/signin"
            className="text-sm text-cyan-600 hover:text-cyan-700 hover:underline"
          >
            {dict.backToSignInLink}
          </Link>
        </div>
      </div>
    </div>
  );
}
--- End of Content for ResetPasswordClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\reset-password\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/reset-password/page.tsx
import { Suspense } from 'react';
import Link from 'next/link';
import { ArrowLeft, Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import ResetPasswordClient from './ResetPasswordClient';

function Loading() {
  return (
    <div className="flex flex-col items-center justify-center p-8 bg-white rounded-xl shadow-xl">
      <Loader2 className="h-8 w-8 animate-spin text-cyan-500" />
      <p className="mt-4 text-gray-600">טוען...</p>
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type ResetPasswordPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ResetPasswordPage({ params }: ResetPasswordPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-cyan-50 via-white to-pink-50 p-4 sm:p-8">
      <Link
        href="/"
        className="absolute top-4 left-4 rtl:right-4 rtl:left-auto text-gray-600 hover:text-gray-800 transition-colors flex items-center gap-1 text-sm z-20"
      >
        <ArrowLeft
          className={`h-4 w-4 ${locale === 'he' ? 'transform rotate-180' : ''}`}
        />{' '}
        חזרה לדף הבית
      </Link>
      <Suspense fallback={<Loading />}>
        <ResetPasswordClient
          dict={dictionary.auth.resetPassword}
          locale={locale}
        />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\setup-account
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\setup-account\SetupAccountClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/setup-account/SetupAccountClient.tsx
"use client";

import React, { useState, useEffect } from 'react';
import { useSearchParams } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { toast } from 'sonner';
import { Loader2, KeyRound, CheckCircle } from "lucide-react";
import type { SetupAccountDict } from '@/types/dictionaries/auth';

interface SetupAccountClientProps {
    dict: SetupAccountDict;
}

export default function SetupAccountClient({ dict }: SetupAccountClientProps) {
  const searchParams = useSearchParams();
  const [token, setToken] = useState<string | null>(null);
  const [password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState(false);

  useEffect(() => {
    const tokenFromUrl = searchParams.get('token');
    if (tokenFromUrl) {
      setToken(tokenFromUrl);
    } else {
      setError(dict.errors.linkInvalid);
    }
  }, [searchParams, dict.errors.linkInvalid]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError('');

    if (password.length < 8) {
      setError(dict.errors.passwordLength);
      return;
    }
    if (password !== confirmPassword) {
      setError(dict.errors.passwordsMismatch);
      return;
    }
    
    setIsLoading(true);

    try {
      const response = await fetch('/api/auth/complete-setup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token, password }),
      });
      const result = await response.json();
      if (!response.ok) throw new Error(result.error || dict.errors.default);
      
      setSuccess(true);
      toast.success(dict.success.title);

      setTimeout(() => { window.location.assign('/profile'); }, 1500);
    } catch (err) {
      setError(err instanceof Error ? err.message : dict.errors.unexpected);
      setIsLoading(false); 
    }
  };
  
  if (success) {
    return (
        <Card className="w-full max-w-md mx-auto text-center">
            <CardHeader>
                <div className="mx-auto bg-green-100 rounded-full p-3 w-fit">
                    <CheckCircle className="h-10 w-10 text-green-600" />
                </div>
                <CardTitle className="mt-4">{dict.success.title}</CardTitle>
            </CardHeader>
            <CardContent>
                <p className="text-muted-foreground">{dict.success.description}</p>
                <Loader2 className="mt-4 h-6 w-6 animate-spin mx-auto" />
            </CardContent>
        </Card>
    );
  }

  return (
    <Card className="w-full max-w-md mx-auto">
      <CardHeader>
        <CardTitle>{dict.title}</CardTitle>
        <CardDescription>{dict.description}</CardDescription>
      </CardHeader>
      <CardContent>
        {!token ? (
            <div className="text-red-500 text-center p-4 bg-red-50 rounded-md">{error}</div>
        ) : (
            <form onSubmit={handleSubmit} className="space-y-4">
                <div>
                    <Label htmlFor="password">{dict.newPasswordLabel}</Label>
                    <Input id="password" type="password" value={password} onChange={(e) => setPassword(e.target.value)} required />
                    <p className="text-xs text-muted-foreground mt-1">{dict.passwordHint}</p>
                </div>
                <div>
                    <Label htmlFor="confirmPassword">{dict.confirmPasswordLabel}</Label>
                    <Input id="confirmPassword" type="password" value={confirmPassword} onChange={(e) => setConfirmPassword(e.target.value)} required />
                </div>
                {error && <p className="text-sm font-medium text-destructive">{error}</p>}
                <CardFooter className="p-0 pt-4">
                    <Button type="submit" className="w-full" disabled={isLoading}>
                        {isLoading ? <Loader2 className="mr-2 h-4 w-4 animate-spin" /> : <KeyRound className="mr-2 h-4 w-4" />}
                        {isLoading ? dict.submitButtonLoading : dict.submitButton}
                    </Button>
                </CardFooter>
            </form>
        )}
      </CardContent>
    </Card>
  );
}
--- End of Content for SetupAccountClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\setup-account\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/setup-account/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import SetupAccountClient from './SetupAccountClient';

function Loading() {
  return (
    <div className="flex items-center justify-center min-h-screen">
      <Loader2 className="h-8 w-8 animate-spin text-cyan-600" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type SetupAccountPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function SetupAccountPage({ params }: SetupAccountPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="flex items-center justify-center min-h-screen bg-gray-100 p-4">
      <Suspense fallback={<Loading />}>
        <SetupAccountClient dict={dictionary.auth.setupAccount} />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\signin
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\signin\SignInClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/signin/SignInClient.tsx
'use client';

import { useState, useEffect, FormEvent } from 'react';
import { useSearchParams, useRouter } from 'next/navigation';
import { useSession, signIn } from 'next-auth/react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import {
  Mail,
  Lock,
  AlertCircle,
  Loader2,
  ArrowLeft,
  ArrowRight,
  Sparkles,
  Heart,
  Shield,
  CheckCircle2,
  Eye,
  EyeOff,
} from 'lucide-react';

import { Button } from '@/components/ui/button';
import { Label } from '@/components/ui/label';
import type { SignInDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface SignInClientProps {
  dict: SignInDict;
  locale: 'he' | 'en';
}

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

// ============================================================================
// BACKGROUND COMPONENT (מעודכן לפלטת Teal/Orange)
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-teal-400/20 to-emerald-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-orange-400/20 to-amber-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-rose-400/15 to-orange-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />
    <motion.div
      className="absolute bottom-20 right-10 w-64 h-64 bg-gradient-to-br from-teal-400/20 to-cyan-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 35, 0],
        scale: [1, 1.12, 1],
      }}
      transition={{
        duration: 16,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 0.5,
      }}
    />

    {/* Dot Pattern (Teal) */}
    <div className="absolute inset-0 opacity-[0.03] bg-[radial-gradient(#0d9488_1px,transparent_1px)] [background-size:24px_24px]" />

    {/* SVG Decorative Waves (Teal -> Orange) */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1000 1000"
      xmlns="http://www.w3.org/2000/svg"
      preserveAspectRatio="none"
    >
      <defs>
        <linearGradient id="waveGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stopColor="#0d9488" stopOpacity="0.08" />
          <stop offset="100%" stopColor="#f97316" stopOpacity="0.04" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,200 C300,100 700,300 1000,200 L1000,0 L0,0 Z"
        fill="url(#waveGrad1)"
        initial={{ opacity: 0.6 }}
        animate={{ opacity: [0.6, 0.9, 0.6] }}
        transition={{ duration: 8, repeat: Infinity, ease: 'easeInOut' }}
      />
    </svg>
  </div>
);

// ============================================================================
// LOADING STATE COMPONENT (Colors Updated)
// ============================================================================

interface LoadingStateProps {
  status: 'loading' | 'authenticated';
  dict: SignInDict;
}

const LoadingState: React.FC<LoadingStateProps> = ({ status, dict }) => (
  <motion.div
    initial={{ opacity: 0, scale: 0.9 }}
    animate={{ opacity: 1, scale: 1 }}
    className="flex w-full max-w-md flex-col items-center justify-center rounded-3xl bg-white/80 backdrop-blur-xl p-12 text-center shadow-2xl border border-white/60"
    style={{ minHeight: '420px' }}
  >
    <motion.div
      animate={{ rotate: 360 }}
      transition={{ duration: 2, repeat: Infinity, ease: 'linear' }}
      className="mb-6"
    >
      {/* Loading Gradient: Teal -> Orange */}
      <div className="p-4 bg-gradient-to-br from-teal-400 to-orange-400 rounded-full">
        <Loader2 className="h-12 w-12 text-white" />
      </div>
    </motion.div>

    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ delay: 0.2 }}
    >
      <h2 className="mb-3 text-2xl font-bold text-gray-800">
        {status === 'authenticated' ? dict.loader.success : dict.loader.loading}
      </h2>
      <p className="text-gray-600 mb-4">
        {status === 'authenticated'
          ? dict.loader.redirecting
          : dict.loader.checking}
      </p>

      {status === 'authenticated' && (
        <motion.div
          initial={{ scale: 0 }}
          animate={{ scale: 1 }}
          transition={{ delay: 0.3, type: 'spring' }}
          className="inline-flex items-center gap-2 bg-emerald-50 text-emerald-700 px-4 py-2 rounded-full text-sm font-medium"
        >
          <CheckCircle2 className="w-4 h-4" />
          <span>{dict.loader.success}</span>
        </motion.div>
      )}
    </motion.div>

    {/* Decorative circles (Teal/Orange) */}
    <div className="absolute inset-0 pointer-events-none overflow-hidden rounded-3xl">
      <motion.div
        className="absolute -top-10 -right-10 w-32 h-32 bg-gradient-to-br from-teal-400/20 to-transparent rounded-full pointer-events-none"
        animate={{ scale: [1, 1.2, 1], rotate: [0, 90, 0] }}
        transition={{ duration: 4, repeat: Infinity }}
      />
      <motion.div
        className="absolute -bottom-10 -left-10 w-32 h-32 bg-gradient-to-br from-orange-400/20 to-transparent rounded-full pointer-events-none"
        animate={{ scale: [1, 1.2, 1], rotate: [0, -90, 0] }}
        transition={{ duration: 4, repeat: Infinity, delay: 1 }}
      />
    </div>
  </motion.div>
);

// ============================================================================
// MAIN SIGNIN COMPONENT
// ============================================================================

export default function SignInClient({ dict, locale }: SignInClientProps) {
  const router = useRouter();
  const searchParams = useSearchParams();
  const { data: session, status } = useSession();

  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [error, setError] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [isGoogleLoading, setIsGoogleLoading] = useState(false);
  const [shouldShake, setShouldShake] = useState(false);

  const isRTL = locale === 'he';

  // Handle authenticated redirect
  useEffect(() => {
    if (status === 'authenticated') {
      const redirectUrl = session?.redirectUrl || `/${locale}/profile`;
      router.push(redirectUrl);
    }
  }, [status, session, router, locale]);

  // Handle URL error parameters
  useEffect(() => {
    const errorMessage = searchParams.get('error');
    if (errorMessage) {
      switch (errorMessage) {
        case 'CredentialsSignin':
          setError(dict.errors.credentialsSignin);
          break;
        case 'OAuthAccountNotLinked':
          setError(dict.errors.oauthAccountNotLinked);
          break;
        default:
          setError(dict.errors.default.replace('{errorMessage}', errorMessage));
      }
      setShouldShake(true);
      setTimeout(() => setShouldShake(false), 500);
    }
  }, [searchParams, dict.errors]);

  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    setError('');
    setIsLoading(true);

    if (!email || !password) {
      setError(dict.errors.missingFields);
      setShouldShake(true);
      setTimeout(() => setShouldShake(false), 500);
      setIsLoading(false);
      return;
    }

    const result = await signIn('credentials', {
      email: email.toLowerCase(),
      password,
      redirect: false,
    });

    if (result?.error) {
      setError(dict.errors.credentialsSignin);
      setShouldShake(true);
      setTimeout(() => setShouldShake(false), 500);
    }

    setIsLoading(false);
  };

  const handleGoogleSignIn = async () => {
    setIsGoogleLoading(true);
    setError('');
    await signIn('google', undefined, { hl: locale });
  };

  // Show loading state
  if (status === 'loading' || status === 'authenticated') {
    return (
      <>
        <DynamicBackground />
        <div className="min-h-screen flex items-center justify-center p-4">
          <LoadingState status={status} dict={dict} />
        </div>
      </>
    );
  }

  // Main sign-in form
  return (
    <>
      <DynamicBackground />

      <div className="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8 relative z-10">
        {/* Hero Section */}
        <motion.div
          variants={containerVariants}
          initial="hidden"
          animate="visible"
          className="mb-8 text-center"
        >
          <motion.div variants={itemVariants} className="mb-4">
            <div className="inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/60 mb-6">
              <motion.div
                animate={{ rotate: [0, 10, -10, 0] }}
                transition={{
                  duration: 2,
                  repeat: Infinity,
                  ease: 'easeInOut',
                }}
              >
                {/* Heart -> Orange */}
                <Heart className="w-5 h-5 text-orange-500" />
              </motion.div>
              <span className="text-sm font-medium text-gray-700">
                {locale === 'he' ? 'ברוכים השבים' : 'Welcome Back'}
              </span>
              {/* Sparkles -> Teal */}
              <Sparkles className="w-5 h-5 text-teal-500" />
            </div>
          </motion.div>

          <motion.h1
            variants={itemVariants}
            className="text-3xl md:text-4xl font-bold mb-3"
          >
            {/* Title Gradient -> Teal-Orange-Amber */}
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-teal-500 via-orange-500 to-amber-500 animate-gradient-slow">
              {dict.title}
            </span>
          </motion.h1>

          <motion.p
            variants={itemVariants}
            className="text-gray-600 text-base md:text-lg max-w-md mx-auto"
          >
            {dict.subtitle}
          </motion.p>

          {/* Decorative Line (Teal -> Orange) */}
          <motion.div variants={itemVariants} className="relative mt-6">
            <div className="w-20 h-1 bg-gradient-to-r from-teal-400 via-orange-400 to-amber-400 rounded-full mx-auto" />
          </motion.div>
        </motion.div>

        {/* Main Card */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={
            shouldShake
              ? { opacity: 1, y: 0, x: [-10, 10, -10, 10, 0] }
              : { opacity: 1, y: 0 }
          }
          transition={
            shouldShake ? { duration: 0.5 } : { duration: 0.5, delay: 0.3 }
          }
          className="w-full max-w-md"
        >
          <div className="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/60 overflow-hidden relative">
            {/* Top Gradient Line (Teal -> Orange) */}
            <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-teal-400 via-orange-400 to-amber-400 pointer-events-none" />

            {/* Decorative Elements */}
            <div className="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-teal-400/10 to-transparent rounded-full transform translate-x-20 -translate-y-20 pointer-events-none" />
            <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-orange-400/10 to-transparent rounded-full transform -translate-x-16 translate-y-16 pointer-events-none" />

            <div className="relative z-10 p-6 sm:p-8">
              {/* Error Alert */}
              <AnimatePresence>
                {error && (
                  <motion.div
                    initial={{ opacity: 0, y: -10, height: 0 }}
                    animate={{ opacity: 1, y: 0, height: 'auto' }}
                    exit={{ opacity: 0, y: -10, height: 0 }}
                    className="mb-6"
                  >
                    <div
                      role="alert"
                      className="p-4 bg-red-50 border-2 border-red-200 rounded-2xl flex items-start gap-3 shadow-sm"
                    >
                      <div className="p-2 bg-red-100 rounded-lg flex-shrink-0">
                        <AlertCircle className="h-5 w-5 text-red-600" />
                      </div>
                      <div className="flex-1">
                        <p className="text-red-800 text-sm font-medium leading-relaxed">
                          {error}
                        </p>
                      </div>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>

              {/* Sign In Form */}
              <form onSubmit={handleSubmit} className="space-y-5 mb-6">
                {/* Email Field */}
                <div className="space-y-2">
                  <Label
                    htmlFor="email"
                    className="block text-sm font-semibold text-gray-700"
                  >
                    {dict.emailLabel}
                  </Label>
                  <div className="relative group">
                    <div
                      className={`absolute ${isRTL ? 'right-3' : 'left-3'} top-1/2 transform -translate-y-1/2 transition-colors ${
                        email ? 'text-teal-500' : 'text-gray-400'
                      }`}
                    >
                      <Mail className="h-5 w-5" />
                    </div>
                    <input
                      type="email"
                      id="email"
                      name="email"
                      autoComplete="email"
                      value={email}
                      onChange={(e) => setEmail(e.target.value)}
                      // Focus Colors: Teal
                      className={`w-full ${isRTL ? 'pr-11 pl-4' : 'pl-11 pr-4'} py-3.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-200 focus:border-teal-400 focus:outline-none transition-colors bg-white/50 backdrop-blur-sm hover:border-gray-300 text-gray-800 placeholder:text-gray-400 relative z-10 touch-manipulation`}
                      placeholder={dict.emailPlaceholder}
                      required
                      disabled={isLoading || isGoogleLoading}
                      dir={isRTL ? 'rtl' : 'ltr'}
                    />
                  </div>
                </div>

                {/* Password Field */}
                <div className="space-y-2">
                  <div className="flex items-center justify-between">
                    <Label
                      htmlFor="password"
                      className="block text-sm font-semibold text-gray-700"
                    >
                      {dict.passwordLabel}
                    </Label>
                  </div>
                  <div className="relative group">
                    <div
                      className={`absolute ${isRTL ? 'right-3' : 'left-3'} top-1/2 transform -translate-y-1/2 transition-colors ${
                        password ? 'text-teal-500' : 'text-gray-400'
                      }`}
                    >
                      <Lock className="h-5 w-5" />
                    </div>
                    <input
                      type={showPassword ? 'text' : 'password'}
                      id="password"
                      name="password"
                      autoComplete="current-password"
                      value={password}
                      onChange={(e) => setPassword(e.target.value)}
                      // Focus Colors: Teal
                      className={`w-full ${isRTL ? 'pr-11 pl-12' : 'pl-11 pr-12'} py-3.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-teal-200 focus:border-teal-400 focus:outline-none transition-colors bg-white/50 backdrop-blur-sm hover:border-gray-300 text-gray-800 placeholder:text-gray-400 relative z-10 touch-manipulation`}
                      placeholder={dict.passwordPlaceholder}
                      required
                      disabled={isLoading || isGoogleLoading}
                      dir={isRTL ? 'rtl' : 'ltr'}
                    />
                    <button
                      type="button"
                      onClick={() => setShowPassword(!showPassword)}
                      className={`absolute ${isRTL ? 'left-3' : 'right-3'} top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors z-20 touch-manipulation p-1`}
                      tabIndex={-1}
                    >
                      {showPassword ? (
                        <EyeOff className="h-5 w-5" />
                      ) : (
                        <Eye className="h-5 w-5" />
                      )}
                    </button>
                  </div>
                  <div
                    className={`flex ${isRTL ? 'justify-start' : 'justify-end'}`}
                  >
                    <Link
                      href={`/${locale}/auth/forgot-password`}
                      // Link Color: Teal
                      className="text-sm text-teal-600 hover:text-teal-700 hover:underline font-medium transition-colors relative z-20 touch-manipulation"
                    >
                      {dict.forgotPasswordLink}
                    </Link>
                  </div>
                </div>

                {/* Submit Button (Teal -> Orange -> Amber) */}
                <Button
                  type="submit"
                  disabled={isLoading || isGoogleLoading}
                  className="w-full relative z-20 py-4 bg-gradient-to-r from-teal-500 via-orange-500 to-amber-500 hover:from-teal-600 hover:via-orange-600 hover:to-amber-600 shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center gap-2 rounded-xl text-base font-semibold group overflow-hidden touch-manipulation active:scale-[0.98]"
                >
                  {/* Shine effect */}
                  <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 pointer-events-none" />

                  {isLoading ? (
                    <>
                      <Loader2 className="h-5 w-5 animate-spin" />
                      <span>{dict.submitButtonLoading}</span>
                    </>
                  ) : (
                    <>
                      <span>{dict.submitButton}</span>
                      {isRTL ? (
                        <ArrowLeft className="w-5 h-5 group-hover:-translate-x-1 transition-transform" />
                      ) : (
                        <ArrowRight className="w-5 h-5 group-hover:translate-x-1 transition-transform" />
                      )}
                    </>
                  )}
                </Button>
              </form>

              {/* Divider */}
              <div className="relative mb-6">
                <div className="absolute inset-0 flex items-center">
                  <div className="w-full border-t-2 border-gray-200" />
                </div>
                <div className="relative flex justify-center">
                  <span className="px-4 bg-white/80 text-sm font-medium text-gray-500">
                    {dict.orDivider}
                  </span>
                </div>
              </div>

              {/* Google Sign In Button */}
              <Button
                type="button"
                onClick={handleGoogleSignIn}
                disabled={isLoading || isGoogleLoading}
                variant="outline"
                className="w-full relative z-20 border-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50 py-4 rounded-xl flex items-center justify-center gap-3 group transition-all duration-200 bg-white/50 backdrop-blur-sm touch-manipulation active:scale-[0.98]"
              >
                {isGoogleLoading ? (
                  <>
                    <Loader2 className="animate-spin h-5 w-5" />
                    <span className="font-medium">
                      {dict.googleButtonLoading}
                    </span>
                  </>
                ) : (
                  <>
                    <svg
                      className="h-5 w-5 flex-shrink-0"
                      viewBox="0 0 24 24"
                      aria-hidden="true"
                    >
                      <path
                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                        fill="#4285F4"
                      />
                      <path
                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                        fill="#34A853"
                      />
                      <path
                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                        fill="#FBBC05"
                      />
                      <path
                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                        fill="#EA4335"
                      />
                    </svg>
                    <span className="text-gray-700 font-medium group-hover:text-gray-900 transition-colors">
                      {dict.googleButton}
                    </span>
                  </>
                )}
              </Button>

              {/* Sign Up Link */}
              <div className="mt-8 text-center">
                <p className="text-gray-600 text-sm">
                  {dict.noAccountPrompt}{' '}
                  <Link
                    href={`/${locale}/auth/register`}
                    // Link Color: Teal
                    className="text-teal-600 font-semibold hover:text-teal-700 hover:underline transition-colors inline-flex items-center gap-1 relative z-20 touch-manipulation"
                  >
                    {dict.signUpLink}
                    {isRTL ? (
                      <ArrowLeft className="w-3 h-3" />
                    ) : (
                      <ArrowRight className="w-3 h-3" />
                    )}
                  </Link>
                </p>
              </div>
            </div>

            {/* Bottom Shine Effect (Teal -> Orange) */}
            <div className="absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-teal-400 via-orange-400 to-amber-400 opacity-50 pointer-events-none" />
          </div>
        </motion.div>

        {/* Trust Badge */}
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.8, duration: 0.5 }}
          className="mt-8 flex items-center gap-2 text-sm text-gray-500"
        >
          {/* Shield -> Teal */}
          <Shield className="w-4 h-4 text-teal-500" />
          <span>
            {locale === 'he'
              ? 'המידע שלך מוגן ומאובטח'
              : 'Your data is protected and secure'}
          </span>
        </motion.div>
      </div>

      {/* Animations CSS */}
      <style>{`
        @keyframes gradient-slow {
          0%,
          100% {
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
        }
        .animate-gradient-slow {
          background-size: 200% 200%;
          animation: gradient-slow 6s ease infinite;
        }
      `}</style>
    </>
  );
}
--- End of Content for SignInClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\signin\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/signin/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import SignInClient from './SignInClient';

function Loading() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <Loader2 className="h-8 w-8 animate-spin text-cyan-600" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type SignInPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function SignInPage({ params }: SignInPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-cyan-50 via-white to-pink-50 p-4">
      <Suspense fallback={<Loading />}>
        <SignInClient dict={dictionary.auth.signIn} locale={locale} />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\update-phone
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\update-phone\UpdatePhoneClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/update-phone/UpdatePhoneClient.tsx
'use client';

import { useState, useCallback, FormEvent } from 'react';
import { useRouter } from 'next/navigation';
import { useSession } from 'next-auth/react';
import { Button } from '@/components/ui/button';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { AlertCircle, Loader2 } from 'lucide-react';
import Link from 'next/link';
import type { UpdatePhoneDict } from '@/types/dictionaries/auth';

// ======================= ייבואים חדשים =======================
import PhoneNumberInput from '@/components/auth/PhoneNumberInput';
import { isPossiblePhoneNumber } from 'react-phone-number-input';
// =============================================================

interface UpdatePhoneClientProps {
  dict: UpdatePhoneDict;
  // הוספת locale לממשק כדי שנוכל לקבל אותו
  locale: 'he' | 'en';
}

const UpdatePhoneClient = ({ dict, locale }: UpdatePhoneClientProps) => {
  const router = useRouter();
  const { status: sessionStatus } = useSession();
  const [newPhone, setNewPhone] = useState<string | undefined>('');
  const [error, setError] = useState<string | null>(null);
  const [isLoading, setIsLoading] = useState(false);

  const handleSubmit = useCallback(
    async (e: FormEvent) => {
      e.preventDefault();
      setError(null);

      // ======================= ולידציה מעודכנת =======================
      if (!newPhone || !isPossiblePhoneNumber(newPhone)) {
        setError(dict.errors.invalidFormat);
        return;
      }
      // ===============================================================

      setIsLoading(true);
      try {
        const response = await fetch('/api/auth/update-and-resend-code', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ newPhone }),
        });
        const result = await response.json();
        if (!response.ok) {
          throw new Error(result.error || dict.errors.updateFailed);
        }
        // הניווט הוא יחסי ולכן אין צורך ב-locale כאן
        router.push('/auth/verify-phone');
      } catch (err: unknown) {
        if (err instanceof Error) {
          setError(err.message);
        } else {
          setError(dict.errors.unexpected);
        }
      } finally {
        setIsLoading(false);
      }
    },
    [newPhone, router, dict]
  );

  if (sessionStatus === 'loading') {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <Loader2 className="h-8 w-8 animate-spin text-cyan-600" />
        <span className="ml-2">{dict.loaderText}</span>
      </div>
    );
  }
  if (sessionStatus === 'unauthenticated') {
    router.push('/auth/signin?callbackUrl=/auth/update-phone');
    return null;
  }

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-cyan-50 via-white to-pink-50 p-4">
      <div className="w-full max-w-sm bg-white rounded-xl shadow-xl p-6 sm:p-8 space-y-6">
        <div className="text-center">
          <h1 className="text-2xl font-bold text-gray-800">{dict.title}</h1>
          <p
            className="text-gray-600 mt-2 text-sm sm:text-base"
            dangerouslySetInnerHTML={{
              __html: dict.description.replace(/\n/g, '<br />'),
            }}
          />
        </div>

        {error && (
          <Alert variant="destructive">
            <AlertCircle className="h-4 w-4" />
            <AlertTitle>{dict.errors.title}</AlertTitle>
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        )}

        <form onSubmit={handleSubmit} className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1 text-right">
              {dict.newPhoneLabel}
            </label>
            {/* ======================= החלפת שדה הקלט הישן ======================= */}
            <PhoneNumberInput
              value={newPhone}
              onChange={setNewPhone}
              disabled={isLoading}
              locale={locale}
            />
            {/* ====================================================================== */}
          </div>
          <Button
            type="submit"
            disabled={isLoading || !newPhone}
            className="w-full"
          >
            {isLoading ? (
              <Loader2 className="animate-spin h-5 w-5" />
            ) : (
              dict.submitButton
            )}
          </Button>
        </form>

        <div className="text-center mt-4">
          <Link
            href="/auth/verify-phone"
            className="text-sm text-cyan-600 hover:underline"
          >
            {dict.backToVerificationLink}
          </Link>
        </div>
      </div>
    </div>
  );
};

export default UpdatePhoneClient;
--- End of Content for UpdatePhoneClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\update-phone\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/update-phone/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import UpdatePhoneClient from './UpdatePhoneClient';

// ▼▼▼ כאן השינוי ▼▼▼
type UpdatePhonePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function UpdatePhonePage({ params }: UpdatePhonePageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <UpdatePhoneClient dict={dictionary.auth.updatePhone} locale={locale} />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-email
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-email\VerifyEmailClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/verify-email/VerifyEmailClient.tsx
'use client';

import { useState, useEffect, useRef } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { useSession } from 'next-auth/react';
import { motion, AnimatePresence } from 'framer-motion';
import {
  Loader2,
  AlertCircle,
  CheckCircle,
  Mail,
  ArrowRight,
  ArrowLeft,
  Sparkles,
  Send,
  Shield,
  Clock,
  RefreshCw,
} from 'lucide-react';

import { Button } from '@/components/ui/button';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import type { VerifyEmailDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface VerificationState {
  status: 'pending' | 'verifying' | 'success' | 'error';
  message: string;
}

interface VerifyEmailClientProps {
  dict: VerifyEmailDict;
  locale: 'he' | 'en';
}

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

const cardVariants = {
  hidden: { opacity: 0, scale: 0.95, y: 30 },
  visible: {
    opacity: 1,
    scale: 1,
    y: 0,
    transition: { duration: 0.6, ease: [0.25, 0.46, 0.45, 0.94] },
  },
};

// ============================================================================
// DYNAMIC BACKGROUND COMPONENT (Teal/Orange Theme)
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-teal-400/20 to-emerald-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-orange-400/20 to-amber-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-rose-400/15 to-orange-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />
    <motion.div
      className="absolute bottom-20 right-10 w-64 h-64 bg-gradient-to-br from-teal-400/20 to-cyan-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 20, 0],
        x: [0, -10, 0],
        scale: [1, 1.12, 1],
      }}
      transition={{
        duration: 16,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 0.5,
      }}
    />

    {/* Decorative Dots Pattern (Teal) */}
    <div className="absolute inset-0 opacity-5 bg-[radial-gradient(#0d9488_1px,transparent_1px)] [background-size:30px_30px]"></div>

    {/* SVG Decorative Paths (Teal -> Orange) */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1200 800"
      xmlns="http://www.w3.org/2000/svg"
    >
      <defs>
        <linearGradient
          id="decorativeGradient"
          x1="0%"
          y1="0%"
          x2="100%"
          y2="100%"
        >
          <stop offset="0%" stopColor="#0d9488" stopOpacity="0.08" />
          <stop offset="50%" stopColor="#f97316" stopOpacity="0.06" />
          <stop offset="100%" stopColor="#14b8a6" stopOpacity="0.08" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,100 C300,50 600,150 1200,100 L1200,0 L0,0 Z"
        fill="url(#decorativeGradient)"
        initial={{ opacity: 0.8 }}
        animate={{ opacity: [0.8, 1, 0.8] }}
        transition={{ duration: 4, repeat: Infinity, ease: 'easeInOut' }}
      />
      <motion.path
        d="M0,700 C400,650 800,750 1200,700 L1200,800 L0,800 Z"
        fill="url(#decorativeGradient)"
        initial={{ opacity: 0.8 }}
        animate={{ opacity: [0.8, 1, 0.8] }}
        transition={{
          duration: 4,
          repeat: Infinity,
          ease: 'easeInOut',
          delay: 2,
        }}
      />
    </svg>
  </div>
);

// ============================================================================
// ANIMATED ICON COMPONENTS (Colors Updated)
// ============================================================================

const AnimatedMailIcon: React.FC = () => (
  <motion.div
    className="relative inline-flex items-center justify-center w-24 h-24 mb-6"
    initial={{ scale: 0, rotate: -180 }}
    animate={{ scale: 1, rotate: 0 }}
    transition={{ duration: 0.6, ease: 'easeOut' }}
  >
    <motion.div
      // Gradient: Teal -> Emerald
      className="absolute inset-0 rounded-full bg-gradient-to-br from-teal-400/20 to-emerald-500/20"
      animate={{
        scale: [1, 1.2, 1],
        opacity: [0.5, 0.8, 0.5],
      }}
      transition={{
        duration: 2,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    {/* Inner Gradient: Teal -> Emerald */}
    <div className="relative w-20 h-20 rounded-2xl bg-gradient-to-br from-teal-400 to-emerald-500 flex items-center justify-center shadow-lg">
      <Mail className="w-10 h-10 text-white" />
    </div>
  </motion.div>
);

const AnimatedSuccessIcon: React.FC = () => (
  <motion.div
    className="relative inline-flex items-center justify-center w-24 h-24 mb-6"
    initial={{ scale: 0 }}
    animate={{ scale: 1 }}
    transition={{ duration: 0.5, ease: 'backOut' }}
  >
    <motion.div
      // Gradient: Green -> Emerald (Success state stays green/emerald, fits palette)
      className="absolute inset-0 rounded-full bg-gradient-to-br from-green-400/30 to-emerald-500/30"
      animate={{
        scale: [1, 1.3, 1],
        opacity: [0.5, 0, 0.5],
      }}
      transition={{
        duration: 1.5,
        repeat: Infinity,
        ease: 'easeOut',
      }}
    />
    <div className="relative w-20 h-20 rounded-full bg-gradient-to-br from-green-400 to-emerald-500 flex items-center justify-center shadow-lg">
      <motion.div
        initial={{ scale: 0 }}
        animate={{ scale: 1 }}
        transition={{ delay: 0.2, duration: 0.3 }}
      >
        <CheckCircle className="w-10 h-10 text-white" />
      </motion.div>
    </div>
  </motion.div>
);

const AnimatedErrorIcon: React.FC = () => (
  <motion.div
    className="relative inline-flex items-center justify-center w-24 h-24 mb-6"
    initial={{ scale: 0, rotate: 180 }}
    animate={{ scale: 1, rotate: 0 }}
    transition={{ duration: 0.5, ease: 'easeOut' }}
  >
    <motion.div
      // Gradient: Red -> Rose (Fits 'Rose' from palette)
      className="absolute inset-0 rounded-full bg-gradient-to-br from-red-400/30 to-rose-500/30"
      animate={{
        scale: [1, 1.2, 1],
      }}
      transition={{
        duration: 2,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <div className="relative w-20 h-20 rounded-full bg-gradient-to-br from-red-400 to-rose-500 flex items-center justify-center shadow-lg">
      <AlertCircle className="w-10 h-10 text-white" />
    </div>
  </motion.div>
);

const AnimatedLoadingIcon: React.FC = () => (
  <motion.div
    className="relative inline-flex items-center justify-center w-24 h-24 mb-6"
    initial={{ opacity: 0 }}
    animate={{ opacity: 1 }}
    transition={{ duration: 0.3 }}
  >
    <motion.div
      // Gradient: Teal -> Orange (Main Palette)
      className="absolute inset-0 rounded-full bg-gradient-to-br from-teal-400/20 to-orange-500/20"
      animate={{
        scale: [1, 1.3, 1],
        rotate: [0, 360],
      }}
      transition={{
        duration: 3,
        repeat: Infinity,
        ease: 'linear',
      }}
    />
    {/* Inner Gradient: Teal -> Orange */}
    <div className="relative w-20 h-20 rounded-2xl bg-gradient-to-br from-teal-400 to-orange-500 flex items-center justify-center shadow-lg">
      <Loader2 className="w-10 h-10 text-white animate-spin" />
    </div>
  </motion.div>
);

// ============================================================================
// MAIN COMPONENT
// ============================================================================

export default function VerifyEmailClient({
  dict,
  locale,
}: VerifyEmailClientProps) {
  const router = useRouter();
  const searchParams = useSearchParams();
  const { data: session } = useSession();
  const verificationApiCallMadeRef = useRef(false);
  const isRTL = locale === 'he';

  const [verification, setVerification] = useState<VerificationState>({
    status: 'pending',
    message: '',
  });
  const [isResending, setIsResending] = useState(false);
  const [infoMessage, setInfoMessage] = useState<string | null>(null);

  useEffect(() => {
    if (verificationApiCallMadeRef.current) return;
    verificationApiCallMadeRef.current = true;

    const token = searchParams.get('token');
    const email = searchParams.get('email');

    if (!token) {
      if (email) {
        setInfoMessage(dict.pendingMessage);
      } else {
        setVerification({
          status: 'error',
          message: dict.errors.linkInvalid,
        });
      }
      return;
    }

    verifyToken(token);
  }, [searchParams, dict]);

  const verifyToken = async (token: string) => {
    setVerification({ status: 'verifying', message: '' });

    if (
      session?.user?.email &&
      searchParams.get('email') &&
      session.user.email !== searchParams.get('email')
    ) {
      setVerification({
        status: 'error',
        message: dict.errors.sessionMismatch,
      });
      return;
    }

    try {
      const response = await fetch('/api/auth/verify', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token: token, type: 'EMAIL' }),
      });
      const data = await response.json();
      if (!response.ok) throw new Error(data.error);

      setVerification({ status: 'success', message: dict.successMessage });
      setTimeout(() => router.push(`/${locale}/auth/signin`), 2000);
    } catch (error) {
      let errorMessage = dict.errors.default;
      if (error instanceof Error) {
        if (error.message.includes('הטוקן כבר נוצל'))
          errorMessage = dict.errors.tokenUsed;
        else if (error.message.includes('תוקף הטוקן פג'))
          errorMessage = dict.errors.tokenExpired;
        else errorMessage = error.message;
      }
      setVerification({ status: 'error', message: errorMessage });
    }
  };

  const handleResendVerification = async () => {
    const email = searchParams.get('email');
    if (!email) {
      setVerification({ status: 'error', message: dict.errors.noEmail });
      return;
    }
    setIsResending(true);
    setVerification({ status: 'pending', message: '' });
    try {
      const response = await fetch('/api/auth/resend-verification', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email: email, type: 'EMAIL' }),
      });
      const data = await response.json();
      if (!response.ok) throw new Error(data.error || dict.errors.resendFailed);
      setInfoMessage(dict.alerts.resendSuccess);
    } catch (error) {
      setVerification({
        status: 'error',
        message:
          error instanceof Error ? error.message : dict.errors.resendFailed,
      });
    } finally {
      setIsResending(false);
    }
  };

  const emailParam = searchParams.get('email');

  return (
    <div className="min-h-screen flex flex-col items-center justify-center p-4 relative">
      <DynamicBackground />

      <motion.div
        variants={containerVariants}
        initial="hidden"
        animate="visible"
        className="w-full max-w-lg relative z-10"
      >
        {/* Header Section */}
        <motion.div variants={itemVariants} className="text-center mb-8">
          <motion.div
            className="inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/60 mb-6"
            whileHover={{ scale: 1.05 }}
            transition={{ duration: 0.3 }}
          >
            {/* Shield: Teal */}
            <Shield className="w-6 h-6 text-teal-500" />
            <span className="text-teal-700 font-semibold text-lg">
              {dict.title}
            </span>
          </motion.div>
        </motion.div>

        {/* Main Card */}
        <motion.div
          variants={cardVariants}
          className="relative overflow-hidden rounded-3xl bg-white/70 backdrop-blur-xl shadow-2xl border border-white/60 p-8 md:p-12"
        >
          {/* Decorative Elements (Teal/Orange) */}
          <div className="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-teal-400/20 to-transparent rounded-full transform translate-x-16 -translate-y-16 blur-2xl" />
          <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-orange-400/20 to-transparent rounded-full transform -translate-x-16 translate-y-16 blur-2xl" />
          <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-amber-400/5 to-transparent rounded-full blur-3xl" />

          <div className="relative z-10">
            <AnimatePresence mode="wait">
              {/* Pending State */}
              {verification.status === 'pending' && (
                <motion.div
                  key="pending"
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  exit={{ opacity: 0, y: -20 }}
                  transition={{ duration: 0.4 }}
                  className="text-center space-y-6"
                >
                  <AnimatedMailIcon />

                  <div className="space-y-3">
                    <h2 className="text-3xl font-bold text-gray-800">
                      {dict.title}
                    </h2>

                    {infoMessage && (
                      <motion.div
                        initial={{ opacity: 0, scale: 0.95 }}
                        animate={{ opacity: 1, scale: 1 }}
                        transition={{ duration: 0.3 }}
                      >
                        {/* Info Alert: Teal/Blue */}
                        <Alert className="border-teal-200 bg-teal-50">
                          <Sparkles className="h-5 w-5 text-teal-600" />
                          <AlertDescription className="text-teal-700">
                            {infoMessage}
                          </AlertDescription>
                        </Alert>
                      </motion.div>
                    )}

                    {emailParam && (
                      <div className="space-y-4 pt-4">
                        {/* Email Box: Teal Light */}
                        <div className="bg-gradient-to-r from-teal-50 to-emerald-50 rounded-2xl p-6 border border-teal-100">
                          <p className="text-gray-600 text-sm mb-2">
                            {dict.emailSentTo}
                          </p>
                          <p className="text-xl font-bold text-gray-800 break-all">
                            {emailParam}
                          </p>
                        </div>

                        <p className="text-gray-600 leading-relaxed">
                          {dict.checkYourInbox}
                        </p>

                        <motion.div
                          whileHover={{ scale: 1.02 }}
                          whileTap={{ scale: 0.98 }}
                        >
                          {/* Resend Button: Teal -> Orange */}
                          <Button
                            onClick={handleResendVerification}
                            disabled={isResending}
                            className="w-full py-6 text-lg font-semibold rounded-xl bg-gradient-to-r from-teal-500 via-orange-500 to-amber-500 hover:from-teal-600 hover:via-orange-600 hover:to-amber-600 text-white shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 relative overflow-hidden group"
                          >
                            {isResending ? (
                              <div className="flex items-center justify-center gap-3">
                                <Loader2 className="animate-spin h-5 w-5" />
                                <span>{dict.resendButtonLoading}</span>
                              </div>
                            ) : (
                              <div className="flex items-center justify-center gap-3">
                                <RefreshCw className="h-5 w-5" />
                                <span>{dict.resendButton}</span>
                                <Send className="h-5 w-5" />
                              </div>
                            )}
                            <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent group-hover:translate-x-full transition-transform duration-1000" />
                          </Button>
                        </motion.div>
                      </div>
                    )}
                  </div>
                </motion.div>
              )}

              {/* Verifying State */}
              {verification.status === 'verifying' && (
                <motion.div
                  key="verifying"
                  initial={{ opacity: 0, scale: 0.9 }}
                  animate={{ opacity: 1, scale: 1 }}
                  exit={{ opacity: 0, scale: 0.9 }}
                  transition={{ duration: 0.4 }}
                  className="text-center space-y-6"
                >
                  <AnimatedLoadingIcon />

                  <div className="space-y-3">
                    <h2 className="text-2xl font-bold text-gray-800">
                      {dict.verifyingMessage}
                    </h2>
                    <div className="flex justify-center gap-2 py-4">
                      {[0, 1, 2].map((i) => (
                        <motion.div
                          key={i}
                          // Loading dots: Teal -> Orange
                          className="w-3 h-3 bg-gradient-to-r from-teal-500 to-orange-500 rounded-full"
                          animate={{
                            scale: [1, 1.5, 1],
                            opacity: [0.5, 1, 0.5],
                          }}
                          transition={{
                            duration: 1.5,
                            repeat: Infinity,
                            delay: i * 0.2,
                          }}
                        />
                      ))}
                    </div>
                  </div>
                </motion.div>
              )}

              {/* Success State */}
              {verification.status === 'success' && (
                <motion.div
                  key="success"
                  initial={{ opacity: 0, scale: 0.9 }}
                  animate={{ opacity: 1, scale: 1 }}
                  exit={{ opacity: 0, scale: 0.9 }}
                  transition={{ duration: 0.4 }}
                  className="text-center space-y-6"
                >
                  <AnimatedSuccessIcon />

                  <div className="space-y-4">
                    <h2 className="text-2xl md:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-teal-600 to-emerald-600">
                      {verification.message}
                    </h2>

                    <div className="bg-gradient-to-r from-teal-50 to-emerald-50 rounded-2xl p-6 border border-teal-100">
                      <div className="flex items-center justify-center gap-3">
                        <Clock className="w-5 h-5 text-teal-600" />
                        <p className="text-gray-700">{dict.successRedirect}</p>
                      </div>
                      <motion.div
                        className="mt-4"
                        animate={{ rotate: 360 }}
                        transition={{
                          duration: 2,
                          repeat: Infinity,
                          ease: 'linear',
                        }}
                      >
                        <Loader2 className="h-6 w-6 mx-auto text-teal-600" />
                      </motion.div>
                    </div>
                  </div>
                </motion.div>
              )}

              {/* Error State */}
              {verification.status === 'error' && (
                <motion.div
                  key="error"
                  initial={{ opacity: 0, scale: 0.9 }}
                  animate={{ opacity: 1, scale: 1 }}
                  exit={{ opacity: 0, scale: 0.9 }}
                  transition={{ duration: 0.4 }}
                  className="text-center space-y-6"
                >
                  <AnimatedErrorIcon />

                  <div className="space-y-4">
                    <h2 className="text-2xl font-bold text-red-600">
                      {dict.errorMessage}
                    </h2>

                    <Alert
                      variant="destructive"
                      className="border-red-200 bg-red-50"
                    >
                      <AlertCircle className="h-5 w-5" />
                      <AlertTitle className="font-semibold">
                        {dict.errors.title || 'שגיאה'}
                      </AlertTitle>
                      <AlertDescription>
                        {verification.message}
                      </AlertDescription>
                    </Alert>

                    <motion.div
                      whileHover={{ scale: 1.02 }}
                      whileTap={{ scale: 0.98 }}
                      className="pt-4"
                    >
                      {/* Back Button: Gray/Teal */}
                      <Button
                        onClick={() => router.push(`/${locale}/auth/signin`)}
                        className="w-full py-6 text-lg font-semibold rounded-xl bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white shadow-lg hover:shadow-xl transition-all duration-300"
                      >
                        <div className="flex items-center justify-center gap-3">
                          {isRTL ? (
                            <ArrowRight className="h-5 w-5" />
                          ) : (
                            <ArrowLeft className="h-5 w-5" />
                          )}
                          <span>{dict.backToSignInButton}</span>
                        </div>
                      </Button>
                    </motion.div>
                  </div>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </motion.div>

        {/* Bottom Decoration */}
        <motion.div variants={itemVariants} className="mt-8 text-center">
          <div className="inline-flex items-center gap-2 text-sm text-gray-500">
            <Shield className="h-4 w-4" />
            <span>מוגן באמצעות הצפנת SSL</span>
          </div>
        </motion.div>
      </motion.div>
    </div>
  );
}
--- End of Content for VerifyEmailClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-email\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/verify-email/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import VerifyEmailClient from './VerifyEmailClient';

function Loading() {
  return (
    <div className="flex items-center justify-center min-h-screen">
      <Loader2 className="h-8 w-8 animate-spin text-cyan-600" />
    </div>
  );
}

type VerifyEmailPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function VerifyEmailPage({ params }: VerifyEmailPageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <div className="flex items-center justify-center min-h-screen bg-gray-50 p-4">
      <Suspense fallback={<Loading />}>
        <VerifyEmailClient 
          dict={dictionary.auth.verifyEmail} 
          locale={locale} 
        />
      </Suspense>
    </div>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-phone
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-phone\VerifyPhoneClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/verify-phone/VerifyPhoneClient.tsx
'use client';

import { useState, useCallback, useRef, useEffect, FormEvent } from 'react';
import { useSession } from 'next-auth/react';
import { useRouter } from 'next/navigation';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import {
  Loader2,
  AlertCircle,
  CheckCircle,
  MessageSquare,
  ArrowRight,
  ArrowLeft,
  Sparkles,
  Shield,
  Clock,
  RefreshCw,
} from 'lucide-react';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import type { VerifyPhoneDict } from '@/types/dictionaries/auth';

// ============================================================================
// TYPE DEFINITIONS
// ============================================================================

interface VerifyPhoneClientProps {
  dict: VerifyPhoneDict;
  locale: 'he' | 'en';
}

const OTP_LENGTH = 6;
const RESEND_COOLDOWN = 60;

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: 'easeOut' },
  },
};

const cardVariants = {
  hidden: { opacity: 0, scale: 0.95, y: 30 },
  visible: {
    opacity: 1,
    scale: 1,
    y: 0,
    transition: { duration: 0.6, ease: [0.25, 0.46, 0.45, 0.94] },
  },
};

// ============================================================================
// DYNAMIC BACKGROUND COMPONENT (Teal/Orange Theme)
// ============================================================================

const DynamicBackground: React.FC = () => (
  <div className="fixed inset-0 overflow-hidden pointer-events-none -z-10">
    {/* Floating Gradients */}
    <motion.div
      className="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-teal-400/20 to-emerald-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, -30, 0],
        x: [0, 20, 0],
        scale: [1, 1.1, 1],
      }}
      transition={{
        duration: 15,
        repeat: Infinity,
        ease: 'easeInOut',
      }}
    />
    <motion.div
      className="absolute top-40 right-20 w-80 h-80 bg-gradient-to-br from-orange-400/20 to-amber-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 40, 0],
        x: [0, -30, 0],
        scale: [1, 1.15, 1],
      }}
      transition={{
        duration: 18,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 1,
      }}
    />
    <motion.div
      className="absolute bottom-32 left-1/4 w-72 h-72 bg-gradient-to-br from-rose-400/15 to-orange-500/15 rounded-full blur-3xl"
      animate={{
        y: [0, -25, 0],
        x: [0, 15, 0],
        scale: [1, 1.08, 1],
      }}
      transition={{
        duration: 20,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 2,
      }}
    />
    <motion.div
      className="absolute bottom-20 right-10 w-64 h-64 bg-gradient-to-br from-teal-400/20 to-cyan-500/20 rounded-full blur-3xl"
      animate={{
        y: [0, 20, 0],
        x: [0, -10, 0],
        scale: [1, 1.12, 1],
      }}
      transition={{
        duration: 16,
        repeat: Infinity,
        ease: 'easeInOut',
        delay: 0.5,
      }}
    />

    {/* Decorative Dots Pattern (Teal) */}
    <div className="absolute inset-0 opacity-5 bg-[radial-gradient(#0d9488_1px,transparent_1px)] [background-size:30px_30px]"></div>

    {/* SVG Decorative Paths (Teal -> Orange) */}
    <svg
      className="absolute inset-0 w-full h-full"
      viewBox="0 0 1200 800"
      xmlns="http://www.w3.org/2000/svg"
    >
      <defs>
        <linearGradient
          id="decorativeGradient"
          x1="0%"
          y1="0%"
          x2="100%"
          y2="100%"
        >
          <stop offset="0%" stopColor="#0d9488" stopOpacity="0.08" />
          <stop offset="50%" stopColor="#f97316" stopOpacity="0.06" />
          <stop offset="100%" stopColor="#14b8a6" stopOpacity="0.08" />
        </linearGradient>
      </defs>
      <motion.path
        d="M0,100 C300,50 600,150 1200,100 L1200,0 L0,0 Z"
        fill="url(#decorativeGradient)"
        initial={{ opacity: 0.8 }}
        animate={{ opacity: [0.8, 1, 0.8] }}
        transition={{ duration: 4, repeat: Infinity, ease: 'easeInOut' }}
      />
      <motion.path
        d="M0,700 C400,650 800,750 1200,700 L1200,800 L0,800 Z"
        fill="url(#decorativeGradient)"
        initial={{ opacity: 0.8 }}
        animate={{ opacity: [0.8, 1, 0.8] }}
        transition={{
          duration: 4,
          repeat: Infinity,
          ease: 'easeInOut',
          delay: 2,
        }}
      />
    </svg>
  </div>
);

// ============================================================================
// CIRCULAR TIMER COMPONENT
// ============================================================================

interface CircularTimerProps {
  seconds: number;
  maxSeconds: number;
}

const CircularTimer: React.FC<CircularTimerProps> = ({
  seconds,
  maxSeconds,
}) => {
  const progress = (seconds / maxSeconds) * 100;
  const circumference = 2 * Math.PI * 20;
  const strokeDashoffset = circumference - (progress / 100) * circumference;

  return (
    <div className="relative inline-flex items-center justify-center w-10 h-10">
      <svg className="w-10 h-10 transform -rotate-90">
        <circle
          cx="20"
          cy="20"
          r="18"
          stroke="currentColor"
          strokeWidth="2"
          fill="none"
          className="text-gray-200"
        />
        <motion.circle
          cx="20"
          cy="20"
          r="18"
          stroke="currentColor"
          strokeWidth="2"
          fill="none"
          strokeDasharray={circumference}
          strokeDashoffset={strokeDashoffset}
          strokeLinecap="round"
          // Color updated to Teal
          className="text-teal-500"
          initial={{ strokeDashoffset: circumference }}
          animate={{ strokeDashoffset }}
          transition={{ duration: 0.3, ease: 'linear' }}
        />
      </svg>
      <span className="absolute text-xs font-semibold text-gray-600">
        {seconds}
      </span>
    </div>
  );
};

// ============================================================================
// MAIN COMPONENT
// ============================================================================

const VerifyPhoneClient: React.FC<VerifyPhoneClientProps> = ({
  dict,
  locale,
}) => {
  const { data: session, update: updateSession } = useSession();
  const router = useRouter();
  const isRTL = locale === 'he';

  // Debug logging
  useEffect(() => {
    console.log('[VerifyPhoneClient] Component mounted');
    console.log('[VerifyPhoneClient] Session data:', session);
    console.log('[VerifyPhoneClient] User phone:', session?.user?.phone);
  }, [session]);

  // State
  const [code, setCode] = useState<string[]>(Array(OTP_LENGTH).fill(''));
  const [isLoading, setIsLoading] = useState(false);
  const [isResending, setIsResending] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);
  const [infoMessage, setInfoMessage] = useState<string | null>(null);
  const [resendTimer, setResendTimer] = useState(0);
  const [focusedIndex, setFocusedIndex] = useState<number | null>(null);

  const inputRefs = useRef<(HTMLInputElement | null)[]>([]);
  const resendTimerRef = useRef<NodeJS.Timeout | null>(null);

  const resendDisabled = resendTimer > 0;

  // Timer Management
  const startResendTimer = useCallback(() => {
    setResendTimer(RESEND_COOLDOWN);
    if (resendTimerRef.current) {
      clearInterval(resendTimerRef.current);
    }
    resendTimerRef.current = setInterval(() => {
      setResendTimer((prev) => {
        if (prev <= 1) {
          if (resendTimerRef.current) {
            clearInterval(resendTimerRef.current);
            resendTimerRef.current = null;
          }
          return 0;
        }
        return prev - 1;
      });
    }, 1000);
  }, []);

  useEffect(() => {
    startResendTimer();
    return () => {
      if (resendTimerRef.current) {
        clearInterval(resendTimerRef.current);
      }
    };
  }, [startResendTimer]);

  // Input Handling
  const handleInputChange = useCallback(
    (index: number, value: string) => {
      if (!/^\d*$/.test(value)) return;
      const newCode = [...code];
      newCode[index] = value.slice(0, 1);
      setCode(newCode);
      setError(null);

      if (value && index < OTP_LENGTH - 1) {
        inputRefs.current[index + 1]?.focus();
      }
    },
    [code]
  );

  const handleKeyDown = useCallback(
    (index: number, e: React.KeyboardEvent<HTMLInputElement>) => {
      if (e.key === 'Backspace' && !code[index] && index > 0) {
        inputRefs.current[index - 1]?.focus();
      }
      if (e.key === 'ArrowLeft' && index > 0) {
        inputRefs.current[index - 1]?.focus();
      }
      if (e.key === 'ArrowRight' && index < OTP_LENGTH - 1) {
        inputRefs.current[index + 1]?.focus();
      }
    },
    [code]
  );

  // Verify Code
  const handleVerifyCode = useCallback(
    async (e: FormEvent<HTMLFormElement>) => {
      e.preventDefault();
      setError(null);
      setInfoMessage(null);

      const fullCode = code.join('');
      if (fullCode.length !== OTP_LENGTH) {
        setError(dict.errors.incompleteCode);
        return;
      }

      setIsLoading(true);

      try {
        const response = await fetch(
          `/api/auth/verify-phone-code?locale=${locale}`,
          {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ code: fullCode }),
          }
        );

        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.error || dict.errors.default);
        }

        setSuccessMessage(dict.success.verifying);

        const updatedSession = await updateSession();

        if (updatedSession?.user?.isPhoneVerified) {
          router.push(`/${locale}/profile`);
        } else {
          setError('Failed to update session. Please try logging in again.');
          setIsLoading(false);
        }
      } catch (err: unknown) {
        setError(err instanceof Error ? err.message : dict.errors.unexpected);
        setIsLoading(false);
      }
    },
    [code, updateSession, dict, locale, router]
  );

  // Resend Code
  const handleResendCode = useCallback(async () => {
    if (resendDisabled || isResending) return;
    setError(null);
    setInfoMessage(null);
    setIsResending(true);

    try {
      const response = await fetch(
        `/api/auth/resend-phone-code?locale=${locale}`,
        {
          method: 'POST',
        }
      );
      if (!response.ok) throw new Error((await response.json()).error);
      setInfoMessage(dict.info.resent);
      startResendTimer();
    } catch (err: unknown) {
      setError(err instanceof Error ? err.message : dict.errors.unexpected);
    } finally {
      setIsResending(false);
    }
  }, [isResending, resendDisabled, startResendTimer, dict, locale]);

  // Get Hidden Phone
  const getHiddenPhone = () => {
    const phone = session?.user?.phone;
    if (!phone || phone.length < 4) {
      return dict.yourPhoneNumber;
    }
    const hiddenPhone = `${phone.substring(0, 3)}••••${phone.substring(phone.length - 3)}`;
    return hiddenPhone;
  };

  // --- Helper to safely render text with dynamic OTP length ---
  const renderWithGradientNumber = (text: string) => {
    // If the JSON contains the placeholder, we split and insert the styled number
    if (text.includes('{{OTP_LENGTH}}')) {
      const parts = text.split('{{OTP_LENGTH}}');
      return (
        <>
          {parts[0]}
          {/* Number Accent: Teal -> Pink (retained for contrast) or Teal -> Orange */}
          <span className="text-transparent bg-clip-text bg-gradient-to-r from-teal-600 to-orange-600">
            {OTP_LENGTH}
          </span>
          {parts[1]}
        </>
      );
    }
    // Fallback: Return text as is (avoids double number bug)
    return text;
  };

  const disableForm = isLoading || !!successMessage;
  const disableResend = isResending || resendDisabled || !!successMessage;
  const isCodeComplete = code.every((digit) => digit !== '');

  return (
    <div className="min-h-screen flex flex-col items-center justify-center p-4 relative">
      <DynamicBackground />

      <motion.div
        variants={containerVariants}
        initial="hidden"
        animate="visible"
        className="w-full max-w-lg relative z-10"
      >
        {/* Header Section */}
        <motion.div variants={itemVariants} className="text-center mb-8">
          <motion.div
            className="inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/60 mb-6"
            whileHover={{ scale: 1.05 }}
            transition={{ duration: 0.3 }}
          >
            {/* Shield: Teal */}
            <Shield className="w-6 h-6 text-teal-500" />
            <span className="text-teal-700 font-semibold text-lg">
              {dict.title}
            </span>
          </motion.div>

          {/* Fixed Header Logic */}
          <h1 className="text-3xl md:text-4xl font-bold text-gray-800 mb-4">
            {renderWithGradientNumber(dict.description)}
          </h1>
        </motion.div>

        {/* Main Card */}
        <motion.div
          variants={cardVariants}
          className="relative overflow-hidden rounded-3xl bg-white/70 backdrop-blur-xl shadow-2xl border border-white/60 p-8 md:p-10"
        >
          {/* Decorative Elements (Teal/Orange) */}
          <div className="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-teal-400/20 to-transparent rounded-full transform translate-x-16 -translate-y-16 blur-2xl" />
          <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-br from-orange-400/20 to-transparent rounded-full transform -translate-x-16 translate-y-16 blur-2xl" />
          <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-amber-400/5 to-transparent rounded-full blur-3xl" />

          <div className="relative z-10 space-y-8">
            {/* WhatsApp/Phone Icon & Phone Number */}
            <div className="text-center space-y-3">
              <div className="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-teal-400 to-emerald-600 shadow-lg mb-2">
                <MessageSquare className="w-8 h-8 text-white" />
              </div>
              {/* Fixed Code Sent To Logic */}
              <p className="text-gray-600 text-sm md:text-base">
                {renderWithGradientNumber(dict.codeSentTo)}
              </p>
              <p className="text-xl font-bold text-gray-800">
                {getHiddenPhone()}
              </p>
              <p className="text-gray-500 text-sm">{dict.enterCodePrompt}</p>
            </div>

            {/* Alerts */}
            <AnimatePresence mode="wait">
              {error && (
                <motion.div
                  initial={{ opacity: 0, y: -10, scale: 0.95 }}
                  animate={{ opacity: 1, y: 0, scale: 1 }}
                  exit={{ opacity: 0, y: -10, scale: 0.95 }}
                  transition={{ duration: 0.3 }}
                >
                  <Alert
                    variant="destructive"
                    className="border-red-200 bg-red-50"
                  >
                    <AlertCircle className="h-5 w-5" />
                    <AlertTitle className="font-semibold">
                      {dict.errors.title}
                    </AlertTitle>
                    <AlertDescription>{error}</AlertDescription>
                  </Alert>
                </motion.div>
              )}

              {successMessage && (
                <motion.div
                  initial={{ opacity: 0, y: -10, scale: 0.95 }}
                  animate={{ opacity: 1, y: 0, scale: 1 }}
                  exit={{ opacity: 0, y: -10, scale: 0.95 }}
                  transition={{ duration: 0.3 }}
                >
                  <Alert className="border-emerald-200 bg-emerald-50">
                    <motion.div
                      animate={{ scale: [1, 1.2, 1] }}
                      transition={{
                        duration: 0.6,
                        repeat: Infinity,
                        repeatDelay: 1,
                      }}
                    >
                      <CheckCircle className="h-5 w-5 text-emerald-600" />
                    </motion.div>
                    <AlertTitle className="font-semibold text-emerald-800">
                      {dict.success.title}
                    </AlertTitle>
                    <AlertDescription className="text-emerald-700">
                      {successMessage}
                    </AlertDescription>
                  </Alert>
                </motion.div>
              )}

              {infoMessage && (
                <motion.div
                  initial={{ opacity: 0, y: -10, scale: 0.95 }}
                  animate={{ opacity: 1, y: 0, scale: 1 }}
                  exit={{ opacity: 0, y: -10, scale: 0.95 }}
                  transition={{ duration: 0.3 }}
                >
                  {/* Info: Teal */}
                  <Alert className="border-teal-200 bg-teal-50">
                    <Sparkles className="h-5 w-5 text-teal-600" />
                    <AlertTitle className="font-semibold text-teal-800">
                      {dict.info.title}
                    </AlertTitle>
                    <AlertDescription className="text-teal-700">
                      {infoMessage}
                    </AlertDescription>
                  </Alert>
                </motion.div>
              )}
            </AnimatePresence>

            {/* OTP Input Form */}
            <form onSubmit={handleVerifyCode} className="space-y-8">
              {/* Code Input Boxes */}
              <div className="flex justify-center gap-2 md:gap-3" dir="ltr">
                {code.map((digit, index) => (
                  <motion.div
                    key={index}
                    initial={{ opacity: 0, scale: 0.8 }}
                    animate={{ opacity: 1, scale: 1 }}
                    transition={{ duration: 0.3, delay: index * 0.05 }}
                    whileHover={{ scale: 1.05 }}
                  >
                    <Input
                      ref={(el: HTMLInputElement | null) => {
                        inputRefs.current[index] = el;
                      }}
                      type="text"
                      inputMode="numeric"
                      maxLength={1}
                      value={digit}
                      onChange={(e) => handleInputChange(index, e.target.value)}
                      onKeyDown={(e) => handleKeyDown(index, e)}
                      onFocus={() => setFocusedIndex(index)}
                      onBlur={() => setFocusedIndex(null)}
                      disabled={disableForm}
                      required
                      aria-label={dict.digitAriaLabel.replace(
                        '{{index}}',
                        (index + 1).toString()
                      )}
                      // Updated Focus and Filled Colors (Teal/Emerald)
                      className={`
                        w-12 h-14 md:w-14 md:h-16 
                        text-center text-2xl md:text-3xl font-bold 
                        border-2 rounded-xl
                        transition-all duration-300
                        shadow-md
                        ${
                          focusedIndex === index
                            ? 'border-teal-500 ring-4 ring-teal-200 scale-105 bg-white'
                            : digit
                              ? 'border-teal-400 bg-teal-50'
                              : 'border-gray-300 bg-white/50'
                        }
                        ${disableForm ? 'opacity-50 cursor-not-allowed' : 'hover:border-teal-400'}
                      `}
                    />
                  </motion.div>
                ))}
              </div>

              {/* Progress Indicator (Teal -> Orange) */}
              <div className="flex justify-center items-center gap-2">
                {code.map((digit, index) => (
                  <motion.div
                    key={index}
                    className={`h-1.5 rounded-full transition-all duration-300 ${
                      digit
                        ? 'bg-gradient-to-r from-teal-500 to-orange-500 w-8'
                        : 'bg-gray-200 w-4'
                    }`}
                    animate={{
                      scale: digit ? [1, 1.2, 1] : 1,
                    }}
                    transition={{ duration: 0.3 }}
                  />
                ))}
              </div>

              {/* Verify Button (Main Gradient) */}
              <motion.div
                whileHover={{ scale: disableForm ? 1 : 1.02 }}
                whileTap={{ scale: disableForm ? 1 : 0.98 }}
              >
                <Button
                  type="submit"
                  disabled={disableForm || !isCodeComplete}
                  className="w-full py-6 text-lg font-bold rounded-xl bg-gradient-to-r from-teal-500 via-orange-500 to-amber-500 hover:from-teal-600 hover:via-orange-600 hover:to-amber-600 text-white shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden group"
                >
                  {isLoading ? (
                    <div className="flex items-center justify-center gap-3">
                      <Loader2 className="animate-spin h-6 w-6" />
                      <span>{dict.verifyingButton}</span>
                    </div>
                  ) : (
                    <div className="flex items-center justify-center gap-3">
                      <CheckCircle className="h-6 w-6" />
                      <span>{dict.verifyButton}</span>
                      {isRTL ? (
                        <ArrowLeft className="h-5 w-5 group-hover:-translate-x-1 transition-transform" />
                      ) : (
                        <ArrowRight className="h-5 w-5 group-hover:translate-x-1 transition-transform" />
                      )}
                    </div>
                  )}
                  {/* Shine effect */}
                  <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent group-hover:translate-x-full transition-transform duration-1000" />
                </Button>
              </motion.div>
            </form>

            {/* Resend Section */}
            <div className="space-y-4 pt-6 border-t border-gray-200">
              <div className="text-center">
                <p className="text-sm text-gray-600 mb-3">
                  {dict.resend.prompt}
                </p>
                <motion.div
                  whileHover={{ scale: disableResend ? 1 : 1.05 }}
                  whileTap={{ scale: disableResend ? 1 : 0.95 }}
                >
                  <Button
                    type="button"
                    variant="outline"
                    onClick={handleResendCode}
                    disabled={disableResend}
                    className={`
                      px-6 py-3 rounded-full border-2 font-semibold
                      transition-all duration-300
                      ${
                        disableResend
                          ? 'border-gray-300 text-gray-400 cursor-not-allowed'
                          : 'border-teal-500 text-teal-600 hover:bg-teal-50 hover:border-teal-600'
                      }
                    `}
                  >
                    {isResending ? (
                      <div className="flex items-center gap-2">
                        <Loader2 className="animate-spin h-4 w-4" />
                        <span>{dict.resend.buttonLoading}</span>
                      </div>
                    ) : resendDisabled ? (
                      <div className="flex items-center gap-3">
                        <CircularTimer
                          seconds={resendTimer}
                          maxSeconds={RESEND_COOLDOWN}
                        />
                        <span>
                          {dict.resend.timer.replace(
                            '{{timer}}',
                            resendTimer.toString()
                          )}
                        </span>
                      </div>
                    ) : (
                      <div className="flex items-center gap-2">
                        <RefreshCw className="h-4 w-4" />
                        <span>{dict.resend.button}</span>
                      </div>
                    )}
                  </Button>
                </motion.div>
              </div>

              {/* Wrong Number Link */}
              <div className="text-center">
                <Link
                  href={`/${locale}/auth/update-phone`}
                  className={`
                    text-sm font-medium inline-flex items-center gap-2
                    transition-all duration-300
                    ${
                      disableForm
                        ? 'text-gray-400 pointer-events-none'
                        : 'text-teal-600 hover:text-teal-700 hover:gap-3'
                    }
                  `}
                >
                  <Clock className="h-4 w-4" />
                  <span>{dict.wrongNumberLink}</span>
                </Link>
              </div>
            </div>

            {/* Back to Sign In */}
            <div className="text-center pt-4 border-t border-gray-200">
              <Link
                href={`/${locale}/auth/signin`}
                className={`
                  text-xs text-gray-500 hover:text-gray-700 
                  transition-colors duration-300
                  inline-flex items-center gap-2
                  ${disableForm ? 'pointer-events-none opacity-50' : ''}
                `}
              >
                {isRTL ? (
                  <ArrowRight className="h-3 w-3" />
                ) : (
                  <ArrowLeft className="h-3 w-3" />
                )}
                <span>{dict.backToSignInLink}</span>
              </Link>
            </div>
          </div>
        </motion.div>

        {/* Bottom Decoration */}
        <motion.div variants={itemVariants} className="mt-8 text-center">
          <div className="inline-flex items-center gap-2 text-sm text-gray-500">
            <Shield className="h-4 w-4" />
            <span>מוגן באמצעות הצפנת SSL</span>
          </div>
        </motion.div>
      </motion.div>

      {/* Custom Styles */}
      <style>{`
        @keyframes shimmer {
          0% {
            background-position: -1000px 0;
          }
          100% {
            background-position: 1000px 0;
          }
        }
      `}</style>
    </div>
  );
};

export default VerifyPhoneClient;
--- End of Content for VerifyPhoneClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\auth\verify-phone\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/auth/verify-phone/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../../i18n-config';
import VerifyPhoneClient from './VerifyPhoneClient';

// ▼▼▼ כאן השינוי ▼▼▼
type VerifyPhonePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function VerifyPhonePage({ params }: VerifyPhonePageProps) {
  const { locale } = await params;
  const dictionary = await getDictionary(locale);

  return (
    <VerifyPhoneClient
      dict={dictionary.auth.verifyPhone}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact\ContactClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/contact/ContactClient.tsx
'use client';
import React, { useState, useRef } from 'react';
import { useRouter } from 'next/navigation';
import { motion, useInView } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import {
  Card,
  CardContent,
  CardHeader,
  CardTitle,
  CardDescription,
} from '@/components/ui/card';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import {
  Loader2,
  Send,
  CheckCircle,
  AlertTriangle,
  HeartHandshake,
  MessageCircle,
  Phone,
  Mail,
  Clock,
  Shield,
  Users,
  UserPlus,
  HelpCircle,
  Lightbulb,
  Target,
} from 'lucide-react';
import { z } from 'zod';
import Image from 'next/image';
import Link from 'next/link';
import { getRelativeCloudinaryPath } from '@/lib/utils';
// --- START: FIX 2 ---
// Import the type from the main dictionary file
import type { ContactPageDict } from '@/types/dictionary';
// --- END: FIX 2 ---

// Map string keys from the dictionary to actual Icon components
const iconsMap: { [key: string]: React.ElementType } = {
  process: HelpCircle,
  consultation: HeartHandshake,
  general: MessageCircle,
  technical: Users,
};

interface ContactClientProps {
  dict: ContactPageDict;
}

export default function ContactClient({ dict }: ContactClientProps) {
  // --- START: FIX 1 ---
  // Define the teamMembers constant inside the component that uses it
  const teamMembers = [
    {
      name: dict.sidebar.team.members[0].name,
      image:
        'https://res.cloudinary.com/dmfxoi6g0/image/upload/v1753700882/dina4_gr0ako.jpg',
    },
    {
      name: dict.sidebar.team.members[1].name,
      image:
        'https://res.cloudinary.com/dmfxoi6g0/image/upload/v1753700884/eitan_h9ylkc.jpg',
    },
  ];
  // --- END: FIX 1 ---

  const [name, setName] = useState('');
  const [email, setEmail] = useState('');
  const [category, setCategory] = useState('');
  const [message, setMessage] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);
  const [validationErrors, setValidationErrors] = useState<Record<
    string,
    string[] | undefined
  > | null>(null);

  const heroRef = useRef(null);
  const formRef = useRef(null);
  const isHeroInView = useInView(heroRef, { once: true });
  const isFormInView = useInView(formRef, { once: true });

  const contactSchema = z.object({
    name: z.string().min(2, { message: dict.form.errors.nameMin }),
    email: z.string().email({ message: dict.form.errors.emailInvalid }),
    category: z.string().min(1, { message: dict.form.errors.categoryRequired }),
    message: z.string().min(10, { message: dict.form.errors.messageMin }),
  });

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);
    setSuccess(false);
    setValidationErrors(null);
    const validationResult = contactSchema.safeParse({
      name,
      email,
      category,
      message,
    });
    if (!validationResult.success) {
      setValidationErrors(validationResult.error.flatten().fieldErrors);
      setIsLoading(false);
      return;
    }

    try {
      const response = await fetch('/api/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(validationResult.data),
      });
      const data = await response.json();
      if (!response.ok)
        throw new Error(data.error || dict.form.errors.sendError);
      setSuccess(true);
    } catch (err: unknown) {
      setError(
        err instanceof Error ? err.message : dict.form.errors.unexpectedError
      );
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-cyan-50 via-white to-pink-50">
      <motion.section
        ref={heroRef}
        className="relative pt-20 pb-12 px-4 text-center"
        initial={{ opacity: 0 }}
        animate={isHeroInView ? { opacity: 1 } : {}}
      >
        <div className="relative max-w-4xl mx-auto">
          <motion.div
            initial={{ opacity: 0, y: 30 }}
            animate={isHeroInView ? { opacity: 1, y: 0 } : {}}
            transition={{ duration: 0.8, delay: 0.2 }}
            className="inline-flex items-center gap-3 mb-8"
          >
            <HeartHandshake className="w-6 h-6 text-cyan-500" />
            <span className="text-cyan-700 font-semibold">
              {dict.hero.header}
            </span>
          </motion.div>
          <motion.h1
            className="text-4xl sm:text-6xl font-bold text-gray-800 my-6"
            initial={{ opacity: 0, y: 50 }}
            animate={isHeroInView ? { opacity: 1, y: 0 } : {}}
            transition={{ duration: 0.8, delay: 0.4 }}
          >
            {dict.hero.title}
            <br />
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-600 to-pink-600">
              {dict.hero.highlightedTitle}
            </span>
          </motion.h1>
          <motion.p
            className="text-xl text-gray-600 mb-8"
            initial={{ opacity: 0, y: 30 }}
            animate={isHeroInView ? { opacity: 1, y: 0 } : {}}
            transition={{ duration: 0.8, delay: 0.6 }}
          >
            {dict.hero.subtitle}
            <br />
            <span className="font-semibold text-cyan-700">
              {dict.hero.guarantee}
            </span>
          </motion.p>
        </div>
      </motion.section>

      <div className="max-w-7xl mx-auto px-4 pb-20 pt-8">
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <motion.div
            ref={formRef}
            className="lg:col-span-2"
            initial={{ opacity: 0, x: -50 }}
            animate={isFormInView ? { opacity: 1, x: 0 } : {}}
            transition={{ duration: 0.8 }}
          >
            <Card className="shadow-2xl">
              <CardHeader className="text-center">
                <Mail className="w-8 h-8 mx-auto mb-4 text-cyan-600" />
                <CardTitle>{dict.form.title}</CardTitle>
                <CardDescription>{dict.form.description}</CardDescription>
              </CardHeader>
              <CardContent className="p-8">
                {success ? (
                  <motion.div
                    initial={{ opacity: 0, scale: 0.9 }}
                    animate={{ opacity: 1, scale: 1 }}
                  >
                    <Alert className="bg-green-50">
                      <CheckCircle className="h-5 w-5 text-green-600" />
                      <AlertTitle>{dict.successMessage.title}</AlertTitle>
                      <AlertDescription>
                        {dict.successMessage.description}
                        <div className="mt-4 flex gap-3">
                          <Link href="/auth/register">
                            <Button size="sm">
                              <UserPlus className="w-4 h-4 ml-2" />
                              {dict.successMessage.signUpButton}
                            </Button>
                          </Link>
                          <Link href="/questionnaire">
                            <Button variant="outline" size="sm">
                              {dict.successMessage.questionnaireButton}
                            </Button>
                          </Link>
                        </div>
                      </AlertDescription>
                    </Alert>
                  </motion.div>
                ) : (
                  <form onSubmit={handleSubmit} className="space-y-6">
                    <div className="grid md:grid-cols-2 gap-4">
                      <div>
                        <label htmlFor="name">{dict.form.nameLabel}</label>
                        <Input
                          id="name"
                          value={name}
                          onChange={(e) => setName(e.target.value)}
                          placeholder={dict.form.namePlaceholder}
                        />
                        {validationErrors?.name && (
                          <p className="text-xs text-red-600 mt-1">
                            {validationErrors.name[0]}
                          </p>
                        )}
                      </div>
                      <div>
                        <label htmlFor="email">{dict.form.emailLabel}</label>
                        <Input
                          id="email"
                          type="email"
                          value={email}
                          onChange={(e) => setEmail(e.target.value)}
                          placeholder={dict.form.emailPlaceholder}
                        />
                        {validationErrors?.email && (
                          <p className="text-xs text-red-600 mt-1">
                            {validationErrors.email[0]}
                          </p>
                        )}
                      </div>
                    </div>
                    <div>
                      <label>{dict.form.categoryLabel}</label>
                      <div className="grid md:grid-cols-2 gap-3 mt-2">
                        {dict.form.categories.map((cat) => {
                          const IconComponent =
                            iconsMap[cat.value] || HelpCircle;
                          return (
                            <label
                              key={cat.value}
                              className={`flex items-center gap-3 p-4 rounded-xl border-2 cursor-pointer ${category === cat.value ? 'border-cyan-500 bg-cyan-50' : 'border-gray-200'}`}
                            >
                              <input
                                type="radio"
                                name="category"
                                value={cat.value}
                                checked={category === cat.value}
                                onChange={(e) => setCategory(e.target.value)}
                                className="sr-only"
                              />
                              <IconComponent
                                className={`w-5 h-5 ${category === cat.value ? 'text-cyan-600' : 'text-gray-400'}`}
                              />
                              <span>{cat.label}</span>
                            </label>
                          );
                        })}
                      </div>
                      {validationErrors?.category && (
                        <p className="text-xs text-red-600 mt-1">
                          {validationErrors.category[0]}
                        </p>
                      )}
                    </div>
                    <div>
                      <label htmlFor="message">{dict.form.messageLabel}</label>
                      <Textarea
                        id="message"
                        value={message}
                        onChange={(e) => setMessage(e.target.value)}
                        placeholder={dict.form.messagePlaceholder}
                        rows={6}
                      />
                      {validationErrors?.message && (
                        <p className="text-xs text-red-600 mt-1">
                          {validationErrors.message[0]}
                        </p>
                      )}
                    </div>
                    {error && (
                      <Alert variant="destructive">
                        <AlertTriangle className="h-4 w-4" />
                        <AlertTitle>Error</AlertTitle>
                        <AlertDescription>{error}</AlertDescription>
                      </Alert>
                    )}
                    <Button
                      type="submit"
                      className="w-full"
                      disabled={isLoading}
                    >
                      {isLoading ? (
                        <>
                          <Loader2 className="ml-2 h-5 w-5 animate-spin" />
                          {dict.form.submitButtonLoading}
                        </>
                      ) : (
                        <>
                          <Send className="ml-2 h-5 w-5" />
                          {dict.form.submitButton}
                        </>
                      )}
                    </Button>
                    <div className="text-center text-sm text-gray-500">
                      <Shield className="w-4 h-4 inline ml-2" />
                      {dict.form.privacyCommitment}
                    </div>
                  </form>
                )}
              </CardContent>
            </Card>
          </motion.div>

          <motion.div
            className="space-y-6"
            initial={{ opacity: 0, x: 50 }}
            animate={isFormInView ? { opacity: 1, x: 0 } : {}}
            transition={{ duration: 0.8, delay: 0.2 }}
          >
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Users className="w-6 h-6 text-cyan-500" />
                  {dict.sidebar.team.title}
                </CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                {dict.sidebar.team.members.map((member, index) => (
                  <div key={index} className="flex items-center gap-4">
                    <div className="relative w-16 h-16 rounded-full overflow-hidden border-2 border-white shadow-md flex-shrink-0">
                      <Image
                        src={getRelativeCloudinaryPath(
                          teamMembers[index].image
                        )}
                        alt={member.name}
                        fill
                        sizes="64px"
                        className="object-cover"
                      />
                    </div>
                    <div>
                      <h4 className="font-bold">{member.name}</h4>
                      <p className="text-sm text-cyan-600">{member.role}</p>
                      <p className="text-xs text-gray-500">
                        {member.description}
                      </p>
                    </div>
                  </div>
                ))}
              </CardContent>
            </Card>
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Lightbulb className="w-6 h-6 text-orange-500" />
                  {dict.sidebar.faq.title}
                </CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                {dict.sidebar.faq.items.map((item, index) => (
                  <div key={index} className="p-4 bg-gray-50 rounded-xl">
                    <h4 className="font-semibold">{item.question}</h4>
                    <p className="text-sm">{item.answer}</p>
                  </div>
                ))}
              </CardContent>
            </Card>
            <Card className="bg-gradient-to-br from-cyan-600 to-pink-600 text-white">
              <CardContent className="p-6">
                <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                  <Phone className="w-6 h-6" />
                  {dict.sidebar.otherWays.title}
                </h3>
                <div className="space-y-3">
                  <div className="flex items-center gap-3">
                    <Phone className="w-5 h-5" />
                    <span>{dict.sidebar.otherWays.phone}</span>
                  </div>
                  <div className="flex items-center gap-3">
                    <Mail className="w-5 h-5" />
                    <span>{dict.sidebar.otherWays.email}</span>
                  </div>
                  <div className="flex items-center gap-3">
                    <Clock className="w-5 h-5" />
                    <span>{dict.sidebar.otherWays.hours}</span>
                  </div>
                </div>
                <div className="mt-6 p-4 bg-white/20 rounded-xl">
                  <p className="text-sm">
                    <strong>{dict.sidebar.otherWays.commitment.title}</strong>{' '}
                    {dict.sidebar.otherWays.commitment.body}
                  </p>
                </div>
              </CardContent>
            </Card>
            <Card>
              <CardContent className="p-6 text-center">
                <Target className="w-12 h-12 mx-auto mb-4 text-pink-500" />
                <h3 className="text-xl font-bold">{dict.sidebar.cta.title}</h3>
                <p className="text-gray-600 mb-6">
                  {dict.sidebar.cta.description}
                </p>
                <div className="space-y-3">
                  <Link href="/auth/register">
                    <Button className="w-full">
                      <UserPlus className="w-4 h-4 ml-2" />
                      {dict.sidebar.cta.signUpButton}
                    </Button>
                  </Link>
                  <Link href="/questionnaire">
                    <Button variant="outline" className="w-full">
                      {dict.sidebar.cta.questionnaireButton}
                    </Button>
                  </Link>
                </div>
              </CardContent>
            </Card>
          </motion.div>
        </div>
      </div>

      <footer className="bg-gray-800 text-white py-8 px-4">
        <div className="max-w-4xl mx-auto text-center">
          {/* Logo is hardcoded, can be moved to a shared component if needed */}
          <p className="text-gray-400 mb-4">{dict.footer.tagline}</p>
          <p className="text-sm text-gray-500">
            {dict.footer.copyright.replace(
              '{year}',
              new Date().getFullYear().toString()
            )}
          </p>
        </div>
      </footer>
    </div>
  );
}
--- End of Content for ContactClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact\contact_contents.txt
--------------------------------------------------------------------------------
Content:
################################################################################
# Directory Content Map For: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact
# Generated on: 2025-11-04 14:59:04
################################################################################

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact\ContactClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/contact/ContactClient.tsx
'use client';
import React, { useState, useRef } from 'react';
import { useRouter } from 'next/navigation';
import { motion, useInView } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import {
  Card,
  CardContent,
  CardHeader,
  CardTitle,
  CardDescription,
} from '@/components/ui/card';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import {
  Loader2,
  Send,
  CheckCircle,
  AlertTriangle,
  HeartHandshake,
  MessageCircle,
  Phone,
  Mail,
  Clock,
  Shield,
  Users,
  UserPlus,
  HelpCircle,
  Lightbulb,
  Target,
} from 'lucide-react';
import { z } from 'zod';
import Image from 'next/image';
import Link from 'next/link';
import { getRelativeCloudinaryPath } from '@/lib/utils';
// --- START: FIX 2 ---
// Import the type from the main dictionary file
import type { ContactPageDict } from '@/types/dictionary';
// --- END: FIX 2 ---

// Map string keys from the dictionary to actual Icon components
const iconsMap: { [key: string]: React.ElementType } = {
  process: HelpCircle,
  consultation: HeartHandshake,
  general: MessageCircle,
  technical: Users,
};

interface ContactClientProps {
  dict: ContactPageDict;
}

export default function ContactClient({ dict }: ContactClientProps) {
  // --- START: FIX 1 ---
  // Define the teamMembers constant inside the component that uses it
  const teamMembers = [
    {
      name: dict.sidebar.team.members[0].name,
      image:
        'https://res.cloudinary.com/dmfxoi6g0/image/upload/v1753700882/dina4_gr0ako.jpg',
    },
    {
      name: dict.sidebar.team.members[1].name,
      image:
        'https://res.cloudinary.com/dmfxoi6g0/image/upload/v1753700884/eitan_h9ylkc.jpg',
    },
  ];
  // --- END: FIX 1 ---

  const [name, setName] = useState('');
  const [email, setEmail] = useState('');
  const [category, setCategory] = useState('');
  const [message, setMessage] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);
  const [validationErrors, setValidationErrors] = useState<Record<
    string,
    string[] | undefined
  > | null>(null);

  const heroRef = useRef(null);
  const formRef = useRef(null);
  const isHeroInView = useInView(heroRef, { once: true });
  const isFormInView = useInView(formRef, { once: true });

  const contactSchema = z.object({
    name: z.string().min(2, { message: dict.form.errors.nameMin }),
    email: z.string().email({ message: dict.form.errors.emailInvalid }),
    category: z.string().min(1, { message: dict.form.errors.categoryRequired }),
    message: z.string().min(10, { message: dict.form.errors.messageMin }),
  });

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);
    setSuccess(false);
    setValidationErrors(null);
    const validationResult = contactSchema.safeParse({
      name,
      email,
      category,
      message,
    });
    if (!validationResult.success) {
      setValidationErrors(validationResult.error.flatten().fieldErrors);
      setIsLoading(false);
      return;
    }

    try {
      const response = await fetch('/api/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(validationResult.data),
      });
      const data = await response.json();
      if (!response.ok)
        throw new Error(data.error || dict.form.errors.sendError);
      setSuccess(true);
    } catch (err: unknown) {
      setError(
        err instanceof Error ? err.message : dict.form.errors.unexpectedError
      );
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-cyan-50 via-white to-pink-50">
      <motion.section
        ref={heroRef}
        className="relative pt-20 pb-12 px-4 text-center"
        initial={{ opacity: 0 }}
        animate={isHeroInView ? { opacity: 1 } : {}}
      >
        <div className="relative max-w-4xl mx-auto">
          <motion.div
            initial={{ opacity: 0, y: 30 }}
            animate={isHeroInView ? { opacity: 1, y: 0 } : {}}
            transition={{ duration: 0.8, delay: 0.2 }}
            className="inline-flex items-center gap-3 mb-8"
          >
            <HeartHandshake className="w-6 h-6 text-cyan-500" />
            <span className="text-cyan-700 font-semibold">
              {dict.hero.header}
            </span>
          </motion.div>
          <motion.h1
            className="text-4xl sm:text-6xl font-bold text-gray-800 my-6"
            initial={{ opacity: 0, y: 50 }}
            animate={isHeroInView ? { opacity: 1, y: 0 } : {}}
            transition={{ duration: 0.8, delay: 0.4 }}
          >
            {dict.hero.title}
            <br />
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-600 to-pink-600">
              {dict.hero.highlightedTitle}
            </span>
          </motion.h1>
          <motion.p
            className="text-xl text-gray-600 mb-8"
            initial={{ opacity: 0, y: 30 }}
            animate={isHeroInView ? { opacity: 1, y: 0 } : {}}
            transition={{ duration: 0.8, delay: 0.6 }}
          >
            {dict.hero.subtitle}
            <br />
            <span className="font-semibold text-cyan-700">
              {dict.hero.guarantee}
            </span>
          </motion.p>
        </div>
      </motion.section>

      <div className="max-w-7xl mx-auto px-4 pb-20 pt-8">
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <motion.div
            ref={formRef}
            className="lg:col-span-2"
            initial={{ opacity: 0, x: -50 }}
            animate={isFormInView ? { opacity: 1, x: 0 } : {}}
            transition={{ duration: 0.8 }}
          >
            <Card className="shadow-2xl">
              <CardHeader className="text-center">
                <Mail className="w-8 h-8 mx-auto mb-4 text-cyan-600" />
                <CardTitle>{dict.form.title}</CardTitle>
                <CardDescription>{dict.form.description}</CardDescription>
              </CardHeader>
              <CardContent className="p-8">
                {success ? (
                  <motion.div
                    initial={{ opacity: 0, scale: 0.9 }}
                    animate={{ opacity: 1, scale: 1 }}
                  >
                    <Alert className="bg-green-50">
                      <CheckCircle className="h-5 w-5 text-green-600" />
                      <AlertTitle>{dict.successMessage.title}</AlertTitle>
                      <AlertDescription>
                        {dict.successMessage.description}
                        <div className="mt-4 flex gap-3">
                          <Link href="/auth/register">
                            <Button size="sm">
                              <UserPlus className="w-4 h-4 ml-2" />
                              {dict.successMessage.signUpButton}
                            </Button>
                          </Link>
                          <Link href="/questionnaire">
                            <Button variant="outline" size="sm">
                              {dict.successMessage.questionnaireButton}
                            </Button>
                          </Link>
                        </div>
                      </AlertDescription>
                    </Alert>
                  </motion.div>
                ) : (
                  <form onSubmit={handleSubmit} className="space-y-6">
                    <div className="grid md:grid-cols-2 gap-4">
                      <div>
                        <label htmlFor="name">{dict.form.nameLabel}</label>
                        <Input
                          id="name"
                          value={name}
                          onChange={(e) => setName(e.target.value)}
                          placeholder={dict.form.namePlaceholder}
                        />
                        {validationErrors?.name && (
                          <p className="text-xs text-red-600 mt-1">
                            {validationErrors.name[0]}
                          </p>
                        )}
                      </div>
                      <div>
                        <label htmlFor="email">{dict.form.emailLabel}</label>
                        <Input
                          id="email"
                          type="email"
                          value={email}
                          onChange={(e) => setEmail(e.target.value)}
                          placeholder={dict.form.emailPlaceholder}
                        />
                        {validationErrors?.email && (
                          <p className="text-xs text-red-600 mt-1">
                            {validationErrors.email[0]}
                          </p>
                        )}
                      </div>
                    </div>
                    <div>
                      <label>{dict.form.categoryLabel}</label>
                      <div className="grid md:grid-cols-2 gap-3 mt-2">
                        {dict.form.categories.map((cat) => {
                          const IconComponent =
                            iconsMap[cat.value] || HelpCircle;
                          return (
                            <label
                              key={cat.value}
                              className={`flex items-center gap-3 p-4 rounded-xl border-2 cursor-pointer ${category === cat.value ? 'border-cyan-500 bg-cyan-50' : 'border-gray-200'}`}
                            >
                              <input
                                type="radio"
                                name="category"
                                value={cat.value}
                                checked={category === cat.value}
                                onChange={(e) => setCategory(e.target.value)}
                                className="sr-only"
                              />
                              <IconComponent
                                className={`w-5 h-5 ${category === cat.value ? 'text-cyan-600' : 'text-gray-400'}`}
                              />
                              <span>{cat.label}</span>
                            </label>
                          );
                        })}
                      </div>
                      {validationErrors?.category && (
                        <p className="text-xs text-red-600 mt-1">
                          {validationErrors.category[0]}
                        </p>
                      )}
                    </div>
                    <div>
                      <label htmlFor="message">{dict.form.messageLabel}</label>
                      <Textarea
                        id="message"
                        value={message}
                        onChange={(e) => setMessage(e.target.value)}
                        placeholder={dict.form.messagePlaceholder}
                        rows={6}
                      />
                      {validationErrors?.message && (
                        <p className="text-xs text-red-600 mt-1">
                          {validationErrors.message[0]}
                        </p>
                      )}
                    </div>
                    {error && (
                      <Alert variant="destructive">
                        <AlertTriangle className="h-4 w-4" />
                        <AlertTitle>Error</AlertTitle>
                        <AlertDescription>{error}</AlertDescription>
                      </Alert>
                    )}
                    <Button
                      type="submit"
                      className="w-full"
                      disabled={isLoading}
                    >
                      {isLoading ? (
                        <>
                          <Loader2 className="ml-2 h-5 w-5 animate-spin" />
                          {dict.form.submitButtonLoading}
                        </>
                      ) : (
                        <>
                          <Send className="ml-2 h-5 w-5" />
                          {dict.form.submitButton}
                        </>
                      )}
                    </Button>
                    <div className="text-center text-sm text-gray-500">
                      <Shield className="w-4 h-4 inline ml-2" />
                      {dict.form.privacyCommitment}
                    </div>
                  </form>
                )}
              </CardContent>
            </Card>
          </motion.div>

          <motion.div
            className="space-y-6"
            initial={{ opacity: 0, x: 50 }}
            animate={isFormInView ? { opacity: 1, x: 0 } : {}}
            transition={{ duration: 0.8, delay: 0.2 }}
          >
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Users className="w-6 h-6 text-cyan-500" />
                  {dict.sidebar.team.title}
                </CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                {dict.sidebar.team.members.map((member, index) => (
                  <div key={index} className="flex items-center gap-4">
                    <div className="relative w-16 h-16 rounded-full overflow-hidden border-2 border-white shadow-md flex-shrink-0">
                      <Image
                        src={getRelativeCloudinaryPath(
                          teamMembers[index].image
                        )}
                        alt={member.name}
                        fill
                        sizes="64px"
                        className="object-cover"
                      />
                    </div>
                    <div>
                      <h4 className="font-bold">{member.name}</h4>
                      <p className="text-sm text-cyan-600">{member.role}</p>
                      <p className="text-xs text-gray-500">
                        {member.description}
                      </p>
                    </div>
                  </div>
                ))}
              </CardContent>
            </Card>
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Lightbulb className="w-6 h-6 text-orange-500" />
                  {dict.sidebar.faq.title}
                </CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                {dict.sidebar.faq.items.map((item, index) => (
                  <div key={index} className="p-4 bg-gray-50 rounded-xl">
                    <h4 className="font-semibold">{item.question}</h4>
                    <p className="text-sm">{item.answer}</p>
                  </div>
                ))}
              </CardContent>
            </Card>
            <Card className="bg-gradient-to-br from-cyan-600 to-pink-600 text-white">
              <CardContent className="p-6">
                <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                  <Phone className="w-6 h-6" />
                  {dict.sidebar.otherWays.title}
                </h3>
                <div className="space-y-3">
                  <div className="flex items-center gap-3">
                    <Phone className="w-5 h-5" />
                    <span>{dict.sidebar.otherWays.phone}</span>
                  </div>
                  <div className="flex items-center gap-3">
                    <Mail className="w-5 h-5" />
                    <span>{dict.sidebar.otherWays.email}</span>
                  </div>
                  <div className="flex items-center gap-3">
                    <Clock className="w-5 h-5" />
                    <span>{dict.sidebar.otherWays.hours}</span>
                  </div>
                </div>
                <div className="mt-6 p-4 bg-white/20 rounded-xl">
                  <p className="text-sm">
                    <strong>{dict.sidebar.otherWays.commitment.title}</strong>{' '}
                    {dict.sidebar.otherWays.commitment.body}
                  </p>
                </div>
              </CardContent>
            </Card>
            <Card>
              <CardContent className="p-6 text-center">
                <Target className="w-12 h-12 mx-auto mb-4 text-pink-500" />
                <h3 className="text-xl font-bold">{dict.sidebar.cta.title}</h3>
                <p className="text-gray-600 mb-6">
                  {dict.sidebar.cta.description}
                </p>
                <div className="space-y-3">
                  <Link href="/auth/register">
                    <Button className="w-full">
                      <UserPlus className="w-4 h-4 ml-2" />
                      {dict.sidebar.cta.signUpButton}
                    </Button>
                  </Link>
                  <Link href="/questionnaire">
                    <Button variant="outline" className="w-full">
                      {dict.sidebar.cta.questionnaireButton}
                    </Button>
                  </Link>
                </div>
              </CardContent>
            </Card>
          </motion.div>
        </div>
      </div>

      <footer className="bg-gray-800 text-white py-8 px-4">
        <div className="max-w-4xl mx-auto text-center">
          {/* Logo is hardcoded, can be moved to a shared component if needed */}
          <p className="text-gray-400 mb-4">{dict.footer.tagline}</p>
          <p className="text-sm text-gray-500">
            {dict.footer.copyright.replace(
              '{year}',
              new Date().getFullYear().toString()
            )}
          </p>
        </div>
      </footer>
    </div>
  );
}
--- End of Content for ContactClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact\contact_contents.txt
--------------------------------------------------------------------------------
[This is the output log file itself. Content not included.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/contact/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../i18n-config';
import ContactClient from './ContactClient';

// ▼▼▼ כאן השינוי ▼▼▼
type ContactPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ContactPage({ params }: ContactPageProps) {
  const { locale } = await params; // הוספת await
  const dictionary = await getDictionary(locale);

  return <ContactClient dict={dictionary.contactPage} />;
}
--- End of Content for page.tsx ---

--- End of Content for contact_contents.txt ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contact\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/contact/page.tsx
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../i18n-config';
import ContactClient from './ContactClient';

// ▼▼▼ כאן השינוי ▼▼▼
type ContactPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function ContactPage({ params }: ContactPageProps) {
  const { locale } = await params; // הוספת await
  const dictionary = await getDictionary(locale);

  return <ContactClient dict={dictionary.contactPage} />;
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contexts
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contexts\NotificationContext.tsx
--------------------------------------------------------------------------------
Content:
// src/app/contexts/NotificationContext.tsx
"use client";
import React, {
  createContext,
  useContext,
  useEffect,
  useRef,
  useState,
  useCallback,
} from "react";
import { useSession } from "next-auth/react";
import type { Session } from "next-auth";
// --- START OF CHANGE: Import new types ---
import type { NotificationCount } from "@/types/messages"; // This type will now be defined in the new file
import type { FeedItem } from "@/types/messages";
// --- END OF CHANGE ---

interface NotificationContextType {
  notifications: NotificationCount;
  refreshNotifications: () => Promise<void>;
  isLoadingNotifications: boolean;
}

const NotificationContext = createContext<NotificationContextType>({
  notifications: { availabilityRequests: 0, messages: 0, total: 0 },
  refreshNotifications: async () => {},
  isLoadingNotifications: true,
});

export const useNotifications = () => useContext(NotificationContext);

export function NotificationProvider({
  children,
}: {
  children: React.ReactNode;
}) {
  const { data: session, status } = useSession() as {
    data: Session | null;
    status: string;
  };
  const [notifications, setNotifications] = useState<NotificationCount>({
    availabilityRequests: 0,
    messages: 0,
    total: 0,
  });
  const [isLoadingNotifications, setIsLoadingNotifications] = useState(true);

  // --- FIX: Provide 'undefined' as the initial value for useRef ---
  const pollingInterval = useRef<NodeJS.Timeout | undefined>(undefined);

  const fetchNotifications = useCallback(async () => {
    if (status !== "authenticated" || !session?.user?.id) {
      setNotifications({ availabilityRequests: 0, messages: 0, total: 0 });
      setIsLoadingNotifications(false);
      return;
    }

    setIsLoadingNotifications(true);
    try {
      // --- START OF CHANGE: Call the new API endpoint ---
      const response = await fetch("/api/messages/feed");
      if (!response.ok) {
        throw new Error(`Server responded with ${response.status}`);
      }
      const data = await response.json();
      
      // --- START OF CHANGE: Calculate counts from the new feed ---
      if (data.success && Array.isArray(data.feed)) {
        const feed: FeedItem[] = data.feed;
        const actionRequiredCount = feed.filter(item => item.type === 'ACTION_REQUIRED').length;
        
        // כאן ניתן בעתיד להוסיף ספירה של הודעות שלא נקראו
        const unreadMessagesCount = 0; 
        
        const newNotifications: NotificationCount = {
          // availabilityRequests נשאר כאן למקרה שנרצה להשתמש בו בעתיד, כרגע הוא משולב ב-total
          availabilityRequests: actionRequiredCount, 
          messages: unreadMessagesCount,
          total: actionRequiredCount + unreadMessagesCount,
        };
        setNotifications(newNotifications);
      } else {
        // אם ה-API לא החזיר מבנה תקין
        setNotifications({ availabilityRequests: 0, messages: 0, total: 0 });
      }
      // --- END OF CHANGE ---
      
    } catch (error) {
      console.error("[NotificationContext] Error fetching notifications:", error);
      setNotifications({ availabilityRequests: 0, messages: 0, total: 0 });
    } finally {
      setIsLoadingNotifications(false);
    }
  }, [status, session?.user?.id]);

  useEffect(() => {
    // The rest of the useEffect remains the same, it will now call the updated fetchNotifications
    if (status === "authenticated" && session?.user?.id) {
      fetchNotifications();
      if (pollingInterval.current) clearInterval(pollingInterval.current);
      pollingInterval.current = setInterval(fetchNotifications, 60000); // Poll every 60 seconds
    } else {
      if (pollingInterval.current) clearInterval(pollingInterval.current);
      setNotifications({ availabilityRequests: 0, messages: 0, total: 0 });
      if (status !== "loading") setIsLoadingNotifications(false);
    }
    
    return () => {
      if (pollingInterval.current) clearInterval(pollingInterval.current);
    };
  }, [session?.user?.id, status, fetchNotifications]);

  const value = {
    notifications,
    refreshNotifications: fetchNotifications,
    isLoadingNotifications,
  };

  return (
    <NotificationContext.Provider value={value}>
      {children}
    </NotificationContext.Provider>
  );
}
--- End of Content for NotificationContext.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\contexts\QuestionnaireStateContext.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/contexts/QuestionnaireStateContext.tsx
'use client';

import React, {
  createContext,
  useContext,
  useState,
  useCallback,
  useRef,
} from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';
import { AlertTriangle, Save, X } from 'lucide-react';
import type { Dictionary } from '@/types/dictionary'; // ודא שהנתיב נכון

// הגדרת ה-Props עבור המודאל
interface UnsavedChangesModalProps {
  isOpen: boolean;
  onCancel: () => void;
  onConfirm: () => void; // המשך ללא שמירה
  onSaveAndConfirm: () => Promise<void>; // שמור והמשך
  isSaving: boolean;
  dict: Dictionary['unsavedChangesModal'];
}

// רכיב המודאל עצמו
const UnsavedChangesModal: React.FC<UnsavedChangesModalProps> = ({
  isOpen,
  onCancel,
  onConfirm,
  onSaveAndConfirm,
  isSaving,
  dict,
}) => {
  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 bg-black/60 z-[300] flex items-center justify-center p-4">
      <Card className="max-w-md w-full">
        <CardHeader>
          <CardTitle className="flex items-center">
            <AlertTriangle className="w-6 h-6 mr-3 text-amber-500" />
            {dict.title}
          </CardTitle>
        </CardHeader>
        <CardContent>
          <p className="text-gray-600 mb-6">{dict.description}</p>
          <div className="flex flex-col sm:flex-row justify-end gap-2">
            <Button variant="ghost" onClick={onCancel}>
              {dict.cancelButton}
            </Button>
            <Button variant="destructive" onClick={onConfirm}>
              <X className="w-4 h-4 mr-2" />
              {dict.continueWithoutSavingButton}
            </Button>
            <Button onClick={onSaveAndConfirm} disabled={isSaving}>
              <Save className="w-4 h-4 mr-2" />
              {isSaving ? dict.savingButton : dict.saveAndContinueButton}
            </Button>
          </div>
        </CardContent>
      </Card>
    </div>
  );
};

// הגדרת הטיפוסים עבור ה-Context
interface QuestionnaireStateContextType {
  isDirty: boolean;
  setIsDirty: (isDirty: boolean) => void;
  promptNavigation: (onConfirmCallback: () => void) => void;
  setSaveHandler: (handler: (() => Promise<void>) | null) => void;
}

const QuestionnaireStateContext = createContext<
  QuestionnaireStateContextType | undefined
>(undefined);

// ה-Provider שיעטוף את האפליקציה
export const QuestionnaireStateProvider = ({
  children,
  dict,
}: {
  children: React.ReactNode;
  dict: Dictionary;
}) => {
  const [isDirty, setIsDirty] = useState(false);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [isSaving, setIsSaving] = useState(false);

  const onConfirmCallbackRef = useRef<() => void>(() => {});
  const saveHandlerRef = useRef<(() => Promise<void>) | null>(null);

  const promptNavigation = (onConfirm: () => void) => {
    onConfirmCallbackRef.current = onConfirm;
    setIsModalOpen(true);
  };

  const setSaveHandler = useCallback(
    (handler: (() => Promise<void>) | null) => {
      saveHandlerRef.current = handler;
    },
    []
  );

  const handleCancel = () => {
    setIsModalOpen(false);
  };

  const handleConfirm = () => {
    setIsDirty(false); // מאפסים את המצב כי המשתמש בחר להמשיך
    onConfirmCallbackRef.current();
    setIsModalOpen(false);
  };

  const handleSaveAndConfirm = async () => {
    if (saveHandlerRef.current) {
      setIsSaving(true);
      await saveHandlerRef.current();
      setIsSaving(false);
      setIsDirty(false);
      onConfirmCallbackRef.current();
      setIsModalOpen(false);
    }
  };

  const value = {
    isDirty,
    setIsDirty,
    promptNavigation,
    setSaveHandler,
  };

  return (
    <QuestionnaireStateContext.Provider value={value}>
      {children}
      <UnsavedChangesModal
        isOpen={isModalOpen}
        onCancel={handleCancel}
        onConfirm={handleConfirm}
        onSaveAndConfirm={handleSaveAndConfirm}
        isSaving={isSaving}
        dict={dict.unsavedChangesModal}
      />
    </QuestionnaireStateContext.Provider>
  );
};

// Hook מותאם אישית לשימוש קל
export const useQuestionnaireState = () => {
  const context = useContext(QuestionnaireStateContext);
  if (context === undefined) {
    throw new Error(
      'useQuestionnaireState must be used within a QuestionnaireStateProvider'
    );
  }
  return context;
};
--- End of Content for QuestionnaireStateContext.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\legal_contents.txt
--------------------------------------------------------------------------------
Content:
################################################################################
# Directory Content Map For: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal
# Generated on: 2025-10-26 16:21:50
################################################################################

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\legal_contents.txt
--------------------------------------------------------------------------------
[This is the output log file itself. Content not included.]

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\accessibility-statement
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\accessibility-statement\AccessibilityStatementClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/accessibility-statement/AccessibilityStatementClient.tsx
'use client';

import React from 'react';
import Head from 'next/head';
import {
  Accessibility,
  CheckCircle,
  Type,
  Contrast,
  Eye,
  Hand,
  Speech,
  MousePointer,
  Sparkles,
} from 'lucide-react';
import { AccessibilityStatementDict } from '@/types/dictionaries/auth';

// Helper component for creating feature list items
const FeatureItem: React.FC<{
  icon: React.ElementType;
  title: string;
  description: string;
}> = ({ icon: Icon, title, description }) => (
  <li className="flex items-start gap-4">
    <div className="flex-shrink-0 mt-1 p-2 bg-cyan-100 rounded-full">
      <Icon className="w-5 h-5 text-cyan-700" />
    </div>
    <div>
      <h3 className="font-semibold text-gray-800">{title}</h3>
      <p className="text-gray-600 text-sm">{description}</p>
    </div>
  </li>
);

interface AccessibilityStatementClientProps {
  dict: AccessibilityStatementDict;
  locale: string;
}

const AccessibilityStatementClient: React.FC<AccessibilityStatementClientProps> = ({ dict, locale }) => {
  const brandName = 'NeshamaTech';
  const companyNameLegal = `ג'ואיש מאצ'פוינט בע"מ`; // This can also be moved to dict if needed
  const lastUpdatedDate = '28 באוגוסט 2025';
  const accessibilityCoordinatorName = 'איתן אנגלרד';
  const accessibilityCoordinatorEmail = 'eytanenglard@gmail.com';

  const pageTitle = dict.pageTitle.replace('{brandName}', brandName);
  const pageDescription = dict.pageDescription.replace('{brandName}', brandName);

  return (
    <>
      <Head>
        <title>{pageTitle}</title>
        <meta name="description" content={pageDescription} />
        <meta property="og:title" content={pageTitle} />
        <meta property="og:description" content={pageDescription} />
      </Head>
      <div className="bg-gradient-to-br from-cyan-50 via-white to-pink-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
        <div className="container mx-auto max-w-4xl bg-white shadow-xl rounded-2xl p-8 sm:p-12 border border-gray-200/50">
          <header className="mb-10 text-center border-b pb-6 border-gray-200">
            <div className="inline-block p-4 bg-gradient-to-r from-cyan-100 to-pink-100 rounded-2xl mb-4">
              <Accessibility className="w-10 h-10 text-cyan-700" />
            </div>
            <h1 className="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-600 to-pink-600">
              {dict.mainTitle}
            </h1>
            <p className="mt-3 text-lg text-gray-600">
              {dict.siteName.replace('{brandName}', brandName)}
            </p>
            <p className="mt-2 text-sm text-gray-500">
              {dict.lastUpdated.replace('{lastUpdatedDate}', lastUpdatedDate)}
            </p>
          </header>

          <article
            className="prose prose-lg max-w-none text-gray-700 leading-relaxed"
            dir={locale === 'he' ? 'rtl' : 'ltr'}
          >
            <h2 id="commitment">{dict.commitment.title}</h2>
            <p dangerouslySetInnerHTML={{ __html: dict.commitment.p1.replace('{companyNameLegal}', companyNameLegal).replace('{brandName}', brandName) }} />
            <p>{dict.commitment.p2}</p>
            
            <h2 id="level">{dict.level.title}</h2>
            <ul>
                <li dangerouslySetInnerHTML={{ __html: dict.level.item1 }} />
                <li dangerouslySetInnerHTML={{ __html: dict.level.item2 }} />
            </ul>

            <h2 id="features">{dict.features.title}</h2>
            <p>{dict.features.p1}</p>

            <h3 className="flex items-center gap-3">
              <Sparkles className="text-blue-600" />
              {dict.features.dedicatedToolbarTitle}
            </h3>
            <p>{dict.features.p2}</p>
            <ul className="space-y-4 not-prose list-none p-0">
                <FeatureItem icon={Type} title={dict.features.fontAdjustment.title} description={dict.features.fontAdjustment.description} />
                <FeatureItem icon={Contrast} title={dict.features.contrastModes.title} description={dict.features.contrastModes.description} />
                <FeatureItem icon={Eye} title={dict.features.readableFont.title} description={dict.features.readableFont.description} />
                <FeatureItem icon={MousePointer} title={dict.features.largeCursor.title} description={dict.features.largeCursor.description} />
                <FeatureItem icon={Speech} title={dict.features.textToSpeech.title} description={dict.features.textToSpeech.description} />
                <FeatureItem icon={Hand} title={dict.features.reduceMotion.title} description={dict.features.reduceMotion.description} />
            </ul>
            
            <h3 className="flex items-center gap-3 mt-8">
              <CheckCircle className="text-emerald-600" />
              {dict.features.additionalAdjustmentsTitle}
            </h3>
            <ul>
              <li dangerouslySetInnerHTML={{ __html: dict.features.keyboardNav }} />
              <li dangerouslySetInnerHTML={{ __html: dict.features.screenReader }} />
              <li dangerouslySetInnerHTML={{ __html: dict.features.altText }} />
              <li dangerouslySetInnerHTML={{ __html: dict.features.accessibleForms }} />
              <li dangerouslySetInnerHTML={{ __html: dict.features.noFlashing }} />
            </ul>

            <h2 id="limitations">{dict.limitations.title}</h2>
            <p>{dict.limitations.p1}</p>
            <p>{dict.limitations.p2}</p>

            <h2 id="contact">{dict.contact.title}</h2>
            <p>{dict.contact.p1}</p>
            <ul>
                <li dangerouslySetInnerHTML={{ __html: dict.contact.name.replace('{accessibilityCoordinatorName}', accessibilityCoordinatorName) }} />
                <li>{dict.contact.email} <a href={`mailto:${accessibilityCoordinatorEmail}`} className="text-cyan-600 hover:text-cyan-700">{accessibilityCoordinatorEmail}</a></li>
            </ul>
            <p>{dict.contact.p2}</p>
            <p dangerouslySetInnerHTML={{ __html: dict.contact.p3.replace('{lastUpdatedDate}', lastUpdatedDate) }} />
          </article>
        </div>
      </div>
    </>
  );
};

export default AccessibilityStatementClient;
--- End of Content for AccessibilityStatementClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\accessibility-statement\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/accessibility-statement/page.tsx
import React from 'react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '@/../i18n-config';
import AccessibilityStatementClient from './AccessibilityStatementClient';

// Server Component
export default async function AccessibilityStatementPage({
  params: { locale },
}: {
  params: { locale: Locale };
}) {
  const dictionary = await getDictionary(locale);

  return (
    <AccessibilityStatementClient
      dict={dictionary.auth.legal.accessibilityStatement}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\privacy-policy
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\privacy-policy\PrivacyPolicyClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/privacy-policy/PrivacyPolicyClient.tsx
'use client';

import React from 'react';
import Head from 'next/head';
import { PrivacyPolicyDict } from '@/types/dictionaries/auth';

interface PrivacyPolicyClientProps {
  dict: PrivacyPolicyDict;
  locale: string;
}

const PrivacyPolicyClient: React.FC<PrivacyPolicyClientProps> = ({ dict, locale }) => {
  const brandName = `נשמה טק (NeshamaTech)`;
  const companyNameLegal = `ג'ואיש מאצ'פוינט בע"מ`;
  const companyNumber = '517172631';
  const lastUpdatedDate = '11 באוגוסט 2025';
  const companyEmail = 'jewish.matchpoint@gmail.com';
  const siteUrl = 'https://www.jewishmatchpoint.com';
  const companyRegisteredAddress = 'גולומב 7, רעננה, ישראל';

  const pageTitle = dict.pageTitle.replace('{brandName}', brandName);
  const pageDescription = dict.pageDescription.replace('{brandName}', brandName);

  return (
    <>
      <Head>
        <title>{pageTitle}</title>
        <meta name="description" content={pageDescription} />
        <meta property="og:title" content={pageTitle} />
        <meta property="og:description" content={pageDescription} />
        <meta property="og:url" content={`${siteUrl}/legal/privacy-policy`} />
        <meta name="twitter:card" content="summary_large_image" />
      </Head>
      <div className="bg-gradient-to-br from-cyan-50 via-white to-pink-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
        <div className="container mx-auto max-w-4xl bg-white shadow-xl rounded-lg p-8 sm:p-12">
          <header className="mb-10 text-center border-b pb-6 border-gray-200">
            <h1 className="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 to-pink-500">
              {dict.mainTitle}
            </h1>
            <p className="mt-2 text-sm text-gray-500">
              {dict.lastUpdated.replace('{lastUpdatedDate}', lastUpdatedDate)}
            </p>
          </header>

          <article
            className="prose prose-lg max-w-none text-gray-700 leading-relaxed"
            dir={locale === 'he' ? 'rtl' : 'ltr'}
          >
            <p><strong>{dict.introduction.title}</strong></p>
            <p>{dict.introduction.p1.replace('{companyNameLegal}', companyNameLegal).replace('{companyNumber}', companyNumber)}</p>
            <p>{dict.introduction.p2}</p>
            <p>{dict.introduction.p3}</p>
            
            <h2 id="consent">{dict.consent.title}</h2>
            <p>{dict.consent.p1}</p>
            <p>{dict.consent.p2}</p>
            <p>{dict.consent.p3.replace('{companyNameLegal}', companyNameLegal).replace('{companyNumber}', companyNumber).replace('{companyRegisteredAddress}', companyRegisteredAddress)}</p>
            <p dangerouslySetInnerHTML={{ __html: dict.consent.p4 }} />

            <h2 id="collected-info">{dict.collectedInfo.title}</h2>
            <p>{dict.collectedInfo.p1}</p>
            <p><strong>{dict.collectedInfo.subTitle1}</strong></p>
            <ul>
                <li>{dict.collectedInfo.list1.item1}</li>
                <li>
                    {dict.collectedInfo.list1.item2.title}
                    <ul>
                        <li>{dict.collectedInfo.list1.item2.subItem1}</li>
                        <li>{dict.collectedInfo.list1.item2.subItem2}</li>
                        <li>{dict.collectedInfo.list1.item2.subItem3}</li>
                    </ul>
                </li>
                <li>{dict.collectedInfo.list1.item3}</li>
                <li>{dict.collectedInfo.list1.item4}</li>
                <li>{dict.collectedInfo.list1.item5}</li>
                <li>{dict.collectedInfo.list1.item6}</li>
            </ul>

            <p><strong>{dict.collectedInfo.subTitle2}</strong></p>
            <p>{dict.collectedInfo.p2}</p>

            <p><strong>{dict.collectedInfo.subTitle3}</strong></p>
            <p><strong>{dict.collectedInfo.p3_1}</strong></p>
            <p>{dict.collectedInfo.p3_2}</p>
            <p>{dict.collectedInfo.p3_3}</p>
            <p>{dict.collectedInfo.p3_4}</p>
            <p dangerouslySetInnerHTML={{ __html: dict.collectedInfo.p3_5 }} />
            <p dangerouslySetInnerHTML={{ __html: dict.collectedInfo.p3_6 }} />
            <p>{dict.collectedInfo.p3_7}</p>

            <p><strong>{dict.collectedInfo.subTitle4}</strong></p>
            <ul>
                <li>{dict.collectedInfo.list2.item1}</li>
                <li>{dict.collectedInfo.list2.item2}</li>
            </ul>

            <h2 id="how-we-use">{dict.howWeUse.title}</h2>
            <p>{dict.howWeUse.p1}</p>
            <ul>
                {Object.values(dict.howWeUse.list).map((item, index) => (
                    <li key={index}>{item}</li>
                ))}
            </ul>

            <h2 id="sharing-info">{dict.sharingInfo.title}</h2>
            <p>{dict.sharingInfo.p1}</p>
            <ul>
                {Object.values(dict.sharingInfo.list).map((item, index) => (
                    <li key={index}>{item}</li>
                ))}
            </ul>
            
            <h2 id="security">{dict.security.title}</h2>
            <p>{dict.security.p1}</p>
            
            <h2 id="retention">{dict.retention.title}</h2>
            <p>{dict.retention.p1}</p>
            
            <h2 id="your-rights">{dict.yourRights.title}</h2>
            <p>{dict.yourRights.p1}</p>
            
            <h2 id="cross-border">{dict.crossBorder.title}</h2>
            <p>{dict.crossBorder.p1}</p>
            
            <h2 id="minors">{dict.minors.title}</h2>
            <p>{dict.minors.p1}</p>
            
            <h2 id="changes">{dict.changes.title}</h2>
            <p>{dict.changes.p1}</p>
            
            <h2 id="contact">{dict.contact.title}</h2>
            <p>{dict.contact.p1}</p>
            <p dangerouslySetInnerHTML={{ __html: dict.contact.companyName.replace('{companyNameLegal}', companyNameLegal).replace('{companyNumber}', companyNumber) }} />
            <p>{dict.contact.email} <a href={`mailto:${companyEmail}`} className="text-cyan-600 hover:text-cyan-700">{companyEmail}</a></p>
            <p dangerouslySetInnerHTML={{ __html: dict.contact.address.replace('{companyRegisteredAddress}', companyRegisteredAddress) }} />
          </article>
        </div>
      </div>
    </>
  );
};

export default PrivacyPolicyClient;
--- End of Content for PrivacyPolicyClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\privacy-policy\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/privacy-policy/page.tsx
import React from 'react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '@/../i18n-config';
import PrivacyPolicyClient from './PrivacyPolicyClient';

// Server Component
export default async function PrivacyPolicyPage({
  params: { locale },
}: {
  params: { locale: Locale };
}) {
  const dictionary = await getDictionary(locale);

  return (
    <PrivacyPolicyClient
      dict={dictionary.auth.legal.privacyPolicy}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\terms-of-service
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\terms-of-service\TermsOfServiceClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/terms-of-service/TermsOfServiceClient.tsx
'use client';

import React from 'react';
import Head from 'next/head';
import { TermsOfServiceDict } from '@/types/dictionaries/auth';

interface TermsOfServiceClientProps {
  dict: TermsOfServiceDict;
  locale: string;
}

const TermsOfServiceClient: React.FC<TermsOfServiceClientProps> = ({ dict, locale }) => {
    const brandName = 'NeshamaTech';
    const companyNameLegal = `ג'ואיש מאצ'פוינט בע"מ`;
    const companyNumber = '517172631';
    const lastUpdatedDate = '11 באוגוסט 2025';
    const supportEmail = 'jewish.matchpoint@gmail.com';
    const siteUrl = 'https://www.jewishmatchpoint.com';
    const privacyPolicyUrl = '/legal/privacy-policy';
    const jurisdictionDistrict = 'תל-אביב-יפו';
    
    const pageTitle = dict.pageTitle.replace('{brandName}', brandName);
    const pageDescription = dict.pageDescription.replace('{brandName}', brandName);

    return (
        <>
        <Head>
            <title>{pageTitle}</title>
            <meta name="description" content={pageDescription} />
            <meta property="og:title" content={pageTitle} />
            <meta property="og:description" content={pageDescription} />
            <meta property="og:url" content={`${siteUrl}/legal/terms-of-service`} />
            <meta name="twitter:card" content="summary_large_image" />
        </Head>
        <div className="bg-gradient-to-br from-cyan-50 via-white to-pink-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
            <div className="container mx-auto max-w-4xl bg-white shadow-xl rounded-lg p-8 sm:p-12">
            <header className="mb-10 text-center border-b pb-6 border-gray-200">
                <h1 className="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 to-pink-500">
                {dict.mainTitle}
                </h1>
                <p className="mt-3 text-lg text-gray-600">
                {dict.subTitle.replace('{brandName}', brandName).replace('{companyNameLegal}', companyNameLegal)}
                </p>
                <p className="mt-2 text-sm text-gray-500">
                {dict.lastUpdated.replace('{lastUpdatedDate}', lastUpdatedDate)}
                </p>
            </header>

            <article
                className="prose prose-lg max-w-none text-gray-700 leading-relaxed"
                dir={locale === 'he' ? 'rtl' : 'ltr'}
            >
                <h2 id="intro">{dict.introduction.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_1.replace('{companyNameLegal}', companyNameLegal).replace('{companyNumber}', companyNumber) }} />
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_2.replace('{privacyPolicyUrl}', privacyPolicyUrl) }} />
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_3 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_4 }} />
                <ul>
                    <li dangerouslySetInnerHTML={{ __html: dict.introduction.list.itemA }} />
                    <li dangerouslySetInnerHTML={{ __html: dict.introduction.list.itemB }} />
                    <li dangerouslySetInnerHTML={{ __html: dict.introduction.list.itemC }} />
                </ul>
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_5 }} />
                
                <h2 id="user-account">{dict.userAccount.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.userAccount.p2_1 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.userAccount.p2_2 }} />
                <ul>
                    {Object.values(dict.userAccount.list).map((item, index) => (
                        <li key={index} dangerouslySetInnerHTML={{ __html: item }} />
                    ))}
                </ul>
                <p dangerouslySetInnerHTML={{ __html: dict.userAccount.p2_3 }} />

                <h2 id="service-fees">{dict.serviceFees.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.serviceFees.p3_1 }} />
                <ul>
                    <li dangerouslySetInnerHTML={{ __html: dict.serviceFees.list.itemA }} />
                    <li dangerouslySetInnerHTML={{ __html: dict.serviceFees.list.itemB }} />
                    <li dangerouslySetInnerHTML={{ __html: dict.serviceFees.list.itemC }} />
                </ul>
                <p dangerouslySetInnerHTML={{ __html: dict.serviceFees.p3_2 }} />
                <p>{dict.serviceFees.p3_3}</p>
                <p dangerouslySetInnerHTML={{ __html: dict.serviceFees.p3_4 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.serviceFees.p3_5 }} />

                <h2 id="intellectual-property">{dict.intellectualProperty.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.intellectualProperty.p4_1 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.intellectualProperty.p4_2 }} />
                
                <h2 id="third-party-links">{dict.thirdPartyLinks.title}</h2>
                <p>{dict.thirdPartyLinks.p1}</p>
                
                <h2 id="limitation-of-liability">{dict.limitationOfLiability.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.limitationOfLiability.p6_1 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.limitationOfLiability.p6_2 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.limitationOfLiability.p6_3 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.limitationOfLiability.p6_4 }} />
                
                <h2 id="indemnification">{dict.indemnification.title}</h2>
                <p>{dict.indemnification.p1}</p>

                <h2 id="termination-law">{dict.terminationLaw.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.terminationLaw.p8_1 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.terminationLaw.p8_2.replace('{jurisdictionDistrict}', jurisdictionDistrict) }} />
                <p dangerouslySetInnerHTML={{ __html: dict.terminationLaw.p8_3 }} />

                <h2 id="contact">{dict.contact.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.contact.p9_1 }} />
                <p>
                    <a href={`mailto:${supportEmail}`} className="text-cyan-600 hover:text-cyan-700">{supportEmail}</a>
                </p>
                <p dangerouslySetInnerHTML={{ __html: dict.contact.p9_2 }} />
            </article>
            </div>
        </div>
        </>
    );
};

export default TermsOfServiceClient;
--- End of Content for TermsOfServiceClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\terms-of-service\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/terms-of-service/page.tsx
import React from 'react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '@/../i18n-config';
import TermsOfServiceClient from './TermsOfServiceClient';

// Server Component
export default async function TermsOfServicePage({
  params: { locale },
}: {
  params: { locale: Locale };
}) {
  const dictionary = await getDictionary(locale);

  return (
    <TermsOfServiceClient
      dict={dictionary.auth.legal.termsOfService}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

--- End of Content for legal_contents.txt ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\accessibility-statement
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\accessibility-statement\AccessibilityStatementClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/accessibility-statement/AccessibilityStatementClient.tsx
'use client';

import React from 'react';
import Head from 'next/head';
import {
  Accessibility,
  CheckCircle,
  Type,
  Contrast,
  Eye,
  Hand,
  Speech,
  MousePointer,
  Sparkles,
} from 'lucide-react';
import { AccessibilityStatementDict } from '@/types/dictionaries/auth';

// Helper component for creating feature list items
const FeatureItem: React.FC<{
  icon: React.ElementType;
  title: string;
  description: string;
}> = ({ icon: Icon, title, description }) => (
  <li className="flex items-start gap-4">
    <div className="flex-shrink-0 mt-1 p-2 bg-cyan-100 rounded-full">
      <Icon className="w-5 h-5 text-cyan-700" />
    </div>
    <div>
      <h3 className="font-semibold text-gray-800">{title}</h3>
      <p className="text-gray-600 text-sm">{description}</p>
    </div>
  </li>
);

interface AccessibilityStatementClientProps {
  dict: AccessibilityStatementDict;
  locale: string;
}

const AccessibilityStatementClient: React.FC<AccessibilityStatementClientProps> = ({ dict, locale }) => {
  const brandName = 'NeshamaTech';
  const companyNameLegal = `ג'ואיש מאצ'פוינט בע"מ`; // This can also be moved to dict if needed
  const lastUpdatedDate = '28 באוגוסט 2025';
  const accessibilityCoordinatorName = 'איתן אנגלרד';
  const accessibilityCoordinatorEmail = 'eytanenglard@gmail.com';

  const pageTitle = dict.pageTitle.replace('{brandName}', brandName);
  const pageDescription = dict.pageDescription.replace('{brandName}', brandName);

  return (
    <>
      <Head>
        <title>{pageTitle}</title>
        <meta name="description" content={pageDescription} />
        <meta property="og:title" content={pageTitle} />
        <meta property="og:description" content={pageDescription} />
      </Head>
      <div className="bg-gradient-to-br from-cyan-50 via-white to-pink-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
        <div className="container mx-auto max-w-4xl bg-white shadow-xl rounded-2xl p-8 sm:p-12 border border-gray-200/50">
          <header className="mb-10 text-center border-b pb-6 border-gray-200">
            <div className="inline-block p-4 bg-gradient-to-r from-cyan-100 to-pink-100 rounded-2xl mb-4">
              <Accessibility className="w-10 h-10 text-cyan-700" />
            </div>
            <h1 className="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-600 to-pink-600">
              {dict.mainTitle}
            </h1>
            <p className="mt-3 text-lg text-gray-600">
              {dict.siteName.replace('{brandName}', brandName)}
            </p>
            <p className="mt-2 text-sm text-gray-500">
              {dict.lastUpdated.replace('{lastUpdatedDate}', lastUpdatedDate)}
            </p>
          </header>

          <article
            className="prose prose-lg max-w-none text-gray-700 leading-relaxed"
            dir={locale === 'he' ? 'rtl' : 'ltr'}
          >
            <h2 id="commitment">{dict.commitment.title}</h2>
            <p dangerouslySetInnerHTML={{ __html: dict.commitment.p1.replace('{companyNameLegal}', companyNameLegal).replace('{brandName}', brandName) }} />
            <p>{dict.commitment.p2}</p>
            
            <h2 id="level">{dict.level.title}</h2>
            <ul>
                <li dangerouslySetInnerHTML={{ __html: dict.level.item1 }} />
                <li dangerouslySetInnerHTML={{ __html: dict.level.item2 }} />
            </ul>

            <h2 id="features">{dict.features.title}</h2>
            <p>{dict.features.p1}</p>

            <h3 className="flex items-center gap-3">
              <Sparkles className="text-blue-600" />
              {dict.features.dedicatedToolbarTitle}
            </h3>
            <p>{dict.features.p2}</p>
            <ul className="space-y-4 not-prose list-none p-0">
                <FeatureItem icon={Type} title={dict.features.fontAdjustment.title} description={dict.features.fontAdjustment.description} />
                <FeatureItem icon={Contrast} title={dict.features.contrastModes.title} description={dict.features.contrastModes.description} />
                <FeatureItem icon={Eye} title={dict.features.readableFont.title} description={dict.features.readableFont.description} />
                <FeatureItem icon={MousePointer} title={dict.features.largeCursor.title} description={dict.features.largeCursor.description} />
                <FeatureItem icon={Speech} title={dict.features.textToSpeech.title} description={dict.features.textToSpeech.description} />
                <FeatureItem icon={Hand} title={dict.features.reduceMotion.title} description={dict.features.reduceMotion.description} />
            </ul>
            
            <h3 className="flex items-center gap-3 mt-8">
              <CheckCircle className="text-emerald-600" />
              {dict.features.additionalAdjustmentsTitle}
            </h3>
            <ul>
              <li dangerouslySetInnerHTML={{ __html: dict.features.keyboardNav }} />
              <li dangerouslySetInnerHTML={{ __html: dict.features.screenReader }} />
              <li dangerouslySetInnerHTML={{ __html: dict.features.altText }} />
              <li dangerouslySetInnerHTML={{ __html: dict.features.accessibleForms }} />
              <li dangerouslySetInnerHTML={{ __html: dict.features.noFlashing }} />
            </ul>

            <h2 id="limitations">{dict.limitations.title}</h2>
            <p>{dict.limitations.p1}</p>
            <p>{dict.limitations.p2}</p>

            <h2 id="contact">{dict.contact.title}</h2>
            <p>{dict.contact.p1}</p>
            <ul>
                <li dangerouslySetInnerHTML={{ __html: dict.contact.name.replace('{accessibilityCoordinatorName}', accessibilityCoordinatorName) }} />
                <li>{dict.contact.email} <a href={`mailto:${accessibilityCoordinatorEmail}`} className="text-cyan-600 hover:text-cyan-700">{accessibilityCoordinatorEmail}</a></li>
            </ul>
            <p>{dict.contact.p2}</p>
            <p dangerouslySetInnerHTML={{ __html: dict.contact.p3.replace('{lastUpdatedDate}', lastUpdatedDate) }} />
          </article>
        </div>
      </div>
    </>
  );
};

export default AccessibilityStatementClient;
--- End of Content for AccessibilityStatementClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\accessibility-statement\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/accessibility-statement/page.tsx
import React from 'react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '@/../i18n-config';
import AccessibilityStatementClient from './AccessibilityStatementClient';

// ▼▼▼ כאן השינוי ▼▼▼
type AccessibilityStatementPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function AccessibilityStatementPage({ params }: AccessibilityStatementPageProps) {
  const { locale } = await params; // הוספת await
  const dictionary = await getDictionary(locale);

  return (
    <AccessibilityStatementClient
      dict={dictionary.auth.legal.accessibilityStatement}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\privacy-policy
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\privacy-policy\PrivacyPolicyClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/privacy-policy/PrivacyPolicyClient.tsx
'use client';

import React from 'react';
import Head from 'next/head';
import { PrivacyPolicyDict } from '@/types/dictionaries/auth';

interface PrivacyPolicyClientProps {
  dict: PrivacyPolicyDict;
  locale: string;
}

const PrivacyPolicyClient: React.FC<PrivacyPolicyClientProps> = ({ dict, locale }) => {
  const brandName = `נשמה טק (NeshamaTech)`;
  const companyNameLegal = `ג'ואיש מאצ'פוינט בע"מ`;
  const companyNumber = '517172631';
  const lastUpdatedDate = '11 באוגוסט 2025';
  const companyEmail = 'jewish.matchpoint@gmail.com';
  const siteUrl = 'https://www.jewishmatchpoint.com';
  const companyRegisteredAddress = 'גולומב 7, רעננה, ישראל';

  const pageTitle = dict.pageTitle.replace('{brandName}', brandName);
  const pageDescription = dict.pageDescription.replace('{brandName}', brandName);

  return (
    <>
      <Head>
        <title>{pageTitle}</title>
        <meta name="description" content={pageDescription} />
        <meta property="og:title" content={pageTitle} />
        <meta property="og:description" content={pageDescription} />
        <meta property="og:url" content={`${siteUrl}/legal/privacy-policy`} />
        <meta name="twitter:card" content="summary_large_image" />
      </Head>
      <div className="bg-gradient-to-br from-cyan-50 via-white to-pink-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
        <div className="container mx-auto max-w-4xl bg-white shadow-xl rounded-lg p-8 sm:p-12">
          <header className="mb-10 text-center border-b pb-6 border-gray-200">
            <h1 className="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 to-pink-500">
              {dict.mainTitle}
            </h1>
            <p className="mt-2 text-sm text-gray-500">
              {dict.lastUpdated.replace('{lastUpdatedDate}', lastUpdatedDate)}
            </p>
          </header>

          <article
            className="prose prose-lg max-w-none text-gray-700 leading-relaxed"
            dir={locale === 'he' ? 'rtl' : 'ltr'}
          >
            <p><strong>{dict.introduction.title}</strong></p>
            <p>{dict.introduction.p1.replace('{companyNameLegal}', companyNameLegal).replace('{companyNumber}', companyNumber)}</p>
            <p>{dict.introduction.p2}</p>
            <p>{dict.introduction.p3}</p>
            
            <h2 id="consent">{dict.consent.title}</h2>
            <p>{dict.consent.p1}</p>
            <p>{dict.consent.p2}</p>
            <p>{dict.consent.p3.replace('{companyNameLegal}', companyNameLegal).replace('{companyNumber}', companyNumber).replace('{companyRegisteredAddress}', companyRegisteredAddress)}</p>
            <p dangerouslySetInnerHTML={{ __html: dict.consent.p4 }} />

            <h2 id="collected-info">{dict.collectedInfo.title}</h2>
            <p>{dict.collectedInfo.p1}</p>
            <p><strong>{dict.collectedInfo.subTitle1}</strong></p>
            <ul>
                <li>{dict.collectedInfo.list1.item1}</li>
                <li>
                    {dict.collectedInfo.list1.item2.title}
                    <ul>
                        <li>{dict.collectedInfo.list1.item2.subItem1}</li>
                        <li>{dict.collectedInfo.list1.item2.subItem2}</li>
                        <li>{dict.collectedInfo.list1.item2.subItem3}</li>
                    </ul>
                </li>
                <li>{dict.collectedInfo.list1.item3}</li>
                <li>{dict.collectedInfo.list1.item4}</li>
                <li>{dict.collectedInfo.list1.item5}</li>
                <li>{dict.collectedInfo.list1.item6}</li>
            </ul>

            <p><strong>{dict.collectedInfo.subTitle2}</strong></p>
            <p>{dict.collectedInfo.p2}</p>

            <p><strong>{dict.collectedInfo.subTitle3}</strong></p>
            <p><strong>{dict.collectedInfo.p3_1}</strong></p>
            <p>{dict.collectedInfo.p3_2}</p>
            <p>{dict.collectedInfo.p3_3}</p>
            <p>{dict.collectedInfo.p3_4}</p>
            <p dangerouslySetInnerHTML={{ __html: dict.collectedInfo.p3_5 }} />
            <p dangerouslySetInnerHTML={{ __html: dict.collectedInfo.p3_6 }} />
            <p>{dict.collectedInfo.p3_7}</p>

            <p><strong>{dict.collectedInfo.subTitle4}</strong></p>
            <ul>
                <li>{dict.collectedInfo.list2.item1}</li>
                <li>{dict.collectedInfo.list2.item2}</li>
            </ul>

            <h2 id="how-we-use">{dict.howWeUse.title}</h2>
            <p>{dict.howWeUse.p1}</p>
            <ul>
                {Object.values(dict.howWeUse.list).map((item, index) => (
                    <li key={index}>{item}</li>
                ))}
            </ul>

            <h2 id="sharing-info">{dict.sharingInfo.title}</h2>
            <p>{dict.sharingInfo.p1}</p>
            <ul>
                {Object.values(dict.sharingInfo.list).map((item, index) => (
                    <li key={index}>{item}</li>
                ))}
            </ul>
            
            <h2 id="security">{dict.security.title}</h2>
            <p>{dict.security.p1}</p>
            
            <h2 id="retention">{dict.retention.title}</h2>
            <p>{dict.retention.p1}</p>
            
            <h2 id="your-rights">{dict.yourRights.title}</h2>
            <p>{dict.yourRights.p1}</p>
            
            <h2 id="cross-border">{dict.crossBorder.title}</h2>
            <p>{dict.crossBorder.p1}</p>
            
            <h2 id="minors">{dict.minors.title}</h2>
            <p>{dict.minors.p1}</p>
            
            <h2 id="changes">{dict.changes.title}</h2>
            <p>{dict.changes.p1}</p>
            
            <h2 id="contact">{dict.contact.title}</h2>
            <p>{dict.contact.p1}</p>
            <p dangerouslySetInnerHTML={{ __html: dict.contact.companyName.replace('{companyNameLegal}', companyNameLegal).replace('{companyNumber}', companyNumber) }} />
            <p>{dict.contact.email} <a href={`mailto:${companyEmail}`} className="text-cyan-600 hover:text-cyan-700">{companyEmail}</a></p>
            <p dangerouslySetInnerHTML={{ __html: dict.contact.address.replace('{companyRegisteredAddress}', companyRegisteredAddress) }} />
          </article>
        </div>
      </div>
    </>
  );
};

export default PrivacyPolicyClient;
--- End of Content for PrivacyPolicyClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\privacy-policy\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/privacy-policy/page.tsx
import React from 'react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '@/../i18n-config';
import PrivacyPolicyClient from './PrivacyPolicyClient';

// ▼▼▼ כאן השינוי ▼▼▼
type PrivacyPolicyPageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function PrivacyPolicyPage({ params }: PrivacyPolicyPageProps) {
  const { locale } = await params; // הוספת await
  const dictionary = await getDictionary(locale);

  return (
    <PrivacyPolicyClient
      dict={dictionary.auth.legal.privacyPolicy}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\terms-of-service
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\terms-of-service\TermsOfServiceClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/terms-of-service/TermsOfServiceClient.tsx
'use client';

import React from 'react';
import Head from 'next/head';
import { TermsOfServiceDict } from '@/types/dictionaries/auth';

interface TermsOfServiceClientProps {
  dict: TermsOfServiceDict;
  locale: string;
}

const TermsOfServiceClient: React.FC<TermsOfServiceClientProps> = ({ dict, locale }) => {
    const brandName = 'NeshamaTech';
    const companyNameLegal = `ג'ואיש מאצ'פוינט בע"מ`;
    const companyNumber = '517172631';
    const lastUpdatedDate = '11 באוגוסט 2025';
    const supportEmail = 'jewish.matchpoint@gmail.com';
    const siteUrl = 'https://www.jewishmatchpoint.com';
    const privacyPolicyUrl = '/legal/privacy-policy';
    const jurisdictionDistrict = 'תל-אביב-יפו';
    
    const pageTitle = dict.pageTitle.replace('{brandName}', brandName);
    const pageDescription = dict.pageDescription.replace('{brandName}', brandName);

    return (
        <>
        <Head>
            <title>{pageTitle}</title>
            <meta name="description" content={pageDescription} />
            <meta property="og:title" content={pageTitle} />
            <meta property="og:description" content={pageDescription} />
            <meta property="og:url" content={`${siteUrl}/legal/terms-of-service`} />
            <meta name="twitter:card" content="summary_large_image" />
        </Head>
        <div className="bg-gradient-to-br from-cyan-50 via-white to-pink-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
            <div className="container mx-auto max-w-4xl bg-white shadow-xl rounded-lg p-8 sm:p-12">
            <header className="mb-10 text-center border-b pb-6 border-gray-200">
                <h1 className="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 to-pink-500">
                {dict.mainTitle}
                </h1>
                <p className="mt-3 text-lg text-gray-600">
                {dict.subTitle.replace('{brandName}', brandName).replace('{companyNameLegal}', companyNameLegal)}
                </p>
                <p className="mt-2 text-sm text-gray-500">
                {dict.lastUpdated.replace('{lastUpdatedDate}', lastUpdatedDate)}
                </p>
            </header>

            <article
                className="prose prose-lg max-w-none text-gray-700 leading-relaxed"
                dir={locale === 'he' ? 'rtl' : 'ltr'}
            >
                <h2 id="intro">{dict.introduction.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_1.replace('{companyNameLegal}', companyNameLegal).replace('{companyNumber}', companyNumber) }} />
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_2.replace('{privacyPolicyUrl}', privacyPolicyUrl) }} />
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_3 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_4 }} />
                <ul>
                    <li dangerouslySetInnerHTML={{ __html: dict.introduction.list.itemA }} />
                    <li dangerouslySetInnerHTML={{ __html: dict.introduction.list.itemB }} />
                    <li dangerouslySetInnerHTML={{ __html: dict.introduction.list.itemC }} />
                </ul>
                <p dangerouslySetInnerHTML={{ __html: dict.introduction.p1_5 }} />
                
                <h2 id="user-account">{dict.userAccount.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.userAccount.p2_1 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.userAccount.p2_2 }} />
                <ul>
                    {Object.values(dict.userAccount.list).map((item, index) => (
                        <li key={index} dangerouslySetInnerHTML={{ __html: item }} />
                    ))}
                </ul>
                <p dangerouslySetInnerHTML={{ __html: dict.userAccount.p2_3 }} />

                <h2 id="service-fees">{dict.serviceFees.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.serviceFees.p3_1 }} />
                <ul>
                    <li dangerouslySetInnerHTML={{ __html: dict.serviceFees.list.itemA }} />
                    <li dangerouslySetInnerHTML={{ __html: dict.serviceFees.list.itemB }} />
                    <li dangerouslySetInnerHTML={{ __html: dict.serviceFees.list.itemC }} />
                </ul>
                <p dangerouslySetInnerHTML={{ __html: dict.serviceFees.p3_2 }} />
                <p>{dict.serviceFees.p3_3}</p>
                <p dangerouslySetInnerHTML={{ __html: dict.serviceFees.p3_4 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.serviceFees.p3_5 }} />

                <h2 id="intellectual-property">{dict.intellectualProperty.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.intellectualProperty.p4_1 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.intellectualProperty.p4_2 }} />
                
                <h2 id="third-party-links">{dict.thirdPartyLinks.title}</h2>
                <p>{dict.thirdPartyLinks.p1}</p>
                
                <h2 id="limitation-of-liability">{dict.limitationOfLiability.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.limitationOfLiability.p6_1 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.limitationOfLiability.p6_2 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.limitationOfLiability.p6_3 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.limitationOfLiability.p6_4 }} />
                
                <h2 id="indemnification">{dict.indemnification.title}</h2>
                <p>{dict.indemnification.p1}</p>

                <h2 id="termination-law">{dict.terminationLaw.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.terminationLaw.p8_1 }} />
                <p dangerouslySetInnerHTML={{ __html: dict.terminationLaw.p8_2.replace('{jurisdictionDistrict}', jurisdictionDistrict) }} />
                <p dangerouslySetInnerHTML={{ __html: dict.terminationLaw.p8_3 }} />

                <h2 id="contact">{dict.contact.title}</h2>
                <p dangerouslySetInnerHTML={{ __html: dict.contact.p9_1 }} />
                <p>
                    <a href={`mailto:${supportEmail}`} className="text-cyan-600 hover:text-cyan-700">{supportEmail}</a>
                </p>
                <p dangerouslySetInnerHTML={{ __html: dict.contact.p9_2 }} />
            </article>
            </div>
        </div>
        </>
    );
};

export default TermsOfServiceClient;
--- End of Content for TermsOfServiceClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\legal\terms-of-service\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/legal/terms-of-service/page.tsx
import React from 'react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '@/../i18n-config';
import TermsOfServiceClient from './TermsOfServiceClient';

// ▼▼▼ כאן השינוי ▼▼▼
type TermsOfServicePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function TermsOfServicePage({ params }: TermsOfServicePageProps) {
  const { locale } = await params; // הוספת await
  const dictionary = await getDictionary(locale);

  return (
    <TermsOfServiceClient
      dict={dictionary.auth.legal.termsOfService}
      locale={locale}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/questionnaire/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '../../../../i18n-config';
import QuestionnairePageClient from '@/components/questionnaire/QuestionnairePageClient';

function Loading() {
  return (
    <div className="flex h-screen w-full items-center justify-center bg-slate-50">
      <Loader2 className="h-10 w-10 animate-spin text-blue-500" />
      <p className="ml-4 rtl:mr-4 text-lg text-gray-700">טוען שאלון...</p>
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type PageProps = {
  params: Promise<{ locale: Locale }>;
  // גם searchParams הוא עכשיו Promise
  searchParams: Promise<{ [key: string]: string | string[] | undefined }>;
};

export default async function Page({ params, searchParams }: PageProps) {
  // ממתינים לשני ה-Promises במקביל לביצועים טובים יותר
  const [{ locale }, resolvedSearchParams] = await Promise.all([
    params,
    searchParams,
  ]);
  
  const dictionary = await getDictionary(locale);

  console.log(
    `\n✅ [LOG | /questionnaire/page.tsx SERVER SIDE] Received searchParams:`,
    resolvedSearchParams, // משתמשים במשתנה החדש שחיכה ל-Promise
    `\n`
  );

  return (
    <Suspense fallback={<Loading />}>
      <QuestionnairePageClient
        dict={dictionary.questionnaire}
        locale={locale}
      />
    </Suspense>
  );
}
--- End of Content for page.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\questionnaire_contents.txt
--------------------------------------------------------------------------------
Content:
################################################################################
# Directory Content Map For: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire
# Generated on: 2025-11-15 22:20:32
################################################################################

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/questionnaire/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '../../../../i18n-config';
import QuestionnairePageClient from '@/components/questionnaire/QuestionnairePageClient';

function Loading() {
  return (
    <div className="flex h-screen w-full items-center justify-center bg-slate-50">
      <Loader2 className="h-10 w-10 animate-spin text-blue-500" />
      <p className="ml-4 rtl:mr-4 text-lg text-gray-700">טוען שאלון...</p>
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type PageProps = {
  params: Promise<{ locale: Locale }>;
  // גם searchParams הוא עכשיו Promise
  searchParams: Promise<{ [key: string]: string | string[] | undefined }>;
};

export default async function Page({ params, searchParams }: PageProps) {
  // ממתינים לשני ה-Promises במקביל לביצועים טובים יותר
  const [{ locale }, resolvedSearchParams] = await Promise.all([
    params,
    searchParams,
  ]);
  
  const dictionary = await getDictionary(locale);

  console.log(
    `\n✅ [LOG | /questionnaire/page.tsx SERVER SIDE] Received searchParams:`,
    resolvedSearchParams, // משתמשים במשתנה החדש שחיכה ל-Promise
    `\n`
  );

  return (
    <Suspense fallback={<Loading />}>
      <QuestionnairePageClient
        dict={dictionary.questionnaire}
        locale={locale}
      />
    </Suspense>
  );
}
--- End of Content for page.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\questionnaire_contents.txt
--------------------------------------------------------------------------------
[This is the output log file itself. Content not included.]

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\complete
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\complete\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/questionnaire/complete/page.tsx
import QuestionnaireComplete from '@/components/questionnaire/QuestionnaireComplete';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '../../../../../i18n-config';

// ▼▼▼ כאן השינוי ▼▼▼
type PageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function Page({ params }: PageProps) {
  const { locale } = await params; // הוספת await ושינוי הגישה ל-locale
  const dictionary = await getDictionary(locale);

  return (
    <QuestionnaireComplete
      dict={dictionary.questionnaire.questionnaireCompletePage}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\restore
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\restore\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/questionnaire/restore/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '../../../../../i18n-config';
import QuestionnaireRestore from '@/components/questionnaire/QuestionnaireRestore';

function Loading() {
  return (
    <div className="flex h-screen w-full items-center justify-center">
      <Loader2 className="h-10 w-10 animate-spin text-cyan-600" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type RestorePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function RestorePage({ params }: RestorePageProps) {
  const { locale } = await params; // הוספת await
  const dictionary = await getDictionary(locale);

  return (
    <Suspense fallback={<Loading />}>
      <QuestionnaireRestore
        dict={dictionary.questionnaire.questionnaireRestore}
      />
    </Suspense>
  );
}
--- End of Content for page.tsx ---

--- End of Content for questionnaire_contents.txt ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\complete
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\complete\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/questionnaire/complete/page.tsx
import QuestionnaireComplete from '@/components/questionnaire/QuestionnaireComplete';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '../../../../../i18n-config';

// ▼▼▼ כאן השינוי ▼▼▼
type PageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function Page({ params }: PageProps) {
  const { locale } = await params; // הוספת await ושינוי הגישה ל-locale
  const dictionary = await getDictionary(locale);

  return (
    <QuestionnaireComplete
      dict={dictionary.questionnaire.questionnaireCompletePage}
    />
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\restore
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\questionnaire\restore\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/questionnaire/restore/page.tsx
import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import { Locale } from '../../../../../i18n-config';
import QuestionnaireRestore from '@/components/questionnaire/QuestionnaireRestore';

function Loading() {
  return (
    <div className="flex h-screen w-full items-center justify-center">
      <Loader2 className="h-10 w-10 animate-spin text-cyan-600" />
    </div>
  );
}

// ▼▼▼ כאן השינוי ▼▼▼
type RestorePageProps = {
  params: Promise<{ locale: Locale }>;
};

export default async function RestorePage({ params }: RestorePageProps) {
  const { locale } = await params; // הוספת await
  const dictionary = await getDictionary(locale);

  return (
    <Suspense fallback={<Loading />}>
      <QuestionnaireRestore
        dict={dictionary.questionnaire.questionnaireRestore}
      />
    </Suspense>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial
================================================================================

(This directory contains subdirectories but no files directly. See subdirectories below.)

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]\TestimonialSubmissionForm.tsx
--------------------------------------------------------------------------------
Content:
'use client';

import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Label } from '@/components/ui/label';
import { Checkbox } from '@/components/ui/checkbox';
import { Loader2 } from 'lucide-react';
import { toast } from 'sonner';

interface FormProps {
  token: string;
  userName: string;
}

export function TestimonialSubmissionForm({ token, userName }: FormProps) {
  const [formData, setFormData] = useState({
    authorName: '',
    relationship: '',
    content: '',
    authorPhone: '',
    isPhoneVisibleToMatch: false,
  });
  const [isLoading, setIsLoading] = useState(false);
  const [isSubmitted, setIsSubmitted] = useState(false);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);

    try {
      // ======================= התיקון מתחיל כאן =======================

      // 1. נבנה את המטען (payload) שישלח לשרת.
      // הוא יכיל את כל פרטי הטופס, ובנוסף את הטוקן.
      const payload = {
        ...formData,
        token: token,
      };

      // 2. נשנה את כתובת ה-API לכתובת הנכונה שיצרנו ליצירת המלצות.
      const response = await fetch(`/api/profile/testimonials`, {
        // <-- שינוי הנתיב
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload), // <-- שליחת המטען המלא
      });

      // ======================= התיקון מסתיים כאן =======================

      const result = await response.json();

      if (!response.ok) {
        throw new Error(result.message || 'שגיאה בשליחת ההמלצה.');
      }

      toast.success('ההמלצה נשלחה בהצלחה!');
      setIsSubmitted(true);
    } catch (error) {
      const errorMessage =
        error instanceof Error ? error.message : 'אירעה שגיאה לא צפויה.';
      toast.error(errorMessage);
    } finally {
      setIsLoading(false);
    }
  };

  const handleChange = (
    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>
  ) => {
    const { name, value } = e.target;
    setFormData((prev) => ({ ...prev, [name]: value }));
  };

  if (isSubmitted) {
    return (
      <div className="text-center p-8 bg-white rounded-lg shadow-md">
        <h2 className="text-xl font-bold text-green-600">תודה רבה!</h2>
        <p className="mt-2 text-gray-700">
          ההמלצה שלך נשלחה ל{userName} ותעזור לו/לה המון במסע. מעריכים את זה
          מאוד!
        </p>
      </div>
    );
  }

  return (
    <form
      onSubmit={handleSubmit}
      className="p-8 bg-white rounded-lg shadow-md space-y-6"
    >
      <div className="space-y-2">
        <Label htmlFor="authorName">שמך המלא</Label>
        <Input
          id="authorName"
          name="authorName"
          value={formData.authorName}
          onChange={handleChange}
          required
          placeholder="לדוגמה: יוסי כהן"
        />
      </div>
      <div className="space-y-2">
        <Label htmlFor="relationship">הקשר שלכם</Label>
        <Input
          id="relationship"
          name="relationship"
          value={formData.relationship}
          onChange={handleChange}
          required
          placeholder="לדוגמה: חבר מהצבא, שותפה לדירה"
        />
      </div>
      <div className="space-y-2">
        <Label htmlFor="content">ההמלצה שלך</Label>
        <Textarea
          id="content"
          name="content"
          value={formData.content}
          onChange={handleChange}
          required
          minLength={50}
          rows={5}
          placeholder={`ספר/י קצת על ${userName}, על התכונות הבולטות שלו/ה, וכל מה שחשוב שהצד השני יכיר...`}
        />
      </div>
      <div className="space-y-2">
        <Label htmlFor="authorPhone">מספר טלפון (אופציונלי)</Label>
        <Input
          id="authorPhone"
          name="authorPhone"
          type="tel"
          value={formData.authorPhone}
          onChange={handleChange}
          placeholder="למקרה שירצו לשמוע ממך עוד"
        />
      </div>
      <div className="flex items-start space-x-2 rtl:space-x-reverse rounded-md border p-4">
        <Checkbox
          id="isPhoneVisibleToMatch"
          checked={formData.isPhoneVisibleToMatch}
          onCheckedChange={(checked) =>
            setFormData((prev) => ({
              ...prev,
              isPhoneVisibleToMatch: !!checked,
            }))
          }
          disabled={!formData.authorPhone}
        />
        <div className="grid gap-1.5 leading-none">
          <label
            htmlFor="isPhoneVisibleToMatch"
            className="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
          >
            אני מאשר/ת שמספר הטלפון שלי יישמר ויוצג למועמדים רלוונטיים שאושרו על
            ידי צוות NeshamaTech.
          </label>
          <p className="text-xs text-muted-foreground">
            זוהי הזדמנות נהדרת לתת המלצה אישית וחמה.
          </p>
        </div>
      </div>
      <Button type="submit" className="w-full" disabled={isLoading}>
        {isLoading ? <Loader2 className="mr-2 h-4 w-4 animate-spin" /> : null}
        {isLoading ? 'שולח...' : 'שלח המלצה'}
      </Button>
    </form>
  );
}
--- End of Content for TestimonialSubmissionForm.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]\[token]_contents.txt
--------------------------------------------------------------------------------
Content:
################################################################################
# Directory Content Map For: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]
# Generated on: 2025-10-26 16:22:25
################################################################################

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]\TestimonialSubmissionForm.tsx
--------------------------------------------------------------------------------
Content:
'use client';

import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Label } from '@/components/ui/label';
import { Checkbox } from '@/components/ui/checkbox';
import { Loader2 } from 'lucide-react';
import { toast } from 'sonner';

interface FormProps {
  token: string;
  userName: string;
}

export function TestimonialSubmissionForm({ token, userName }: FormProps) {
  const [formData, setFormData] = useState({
    authorName: '',
    relationship: '',
    content: '',
    authorPhone: '',
    isPhoneVisibleToMatch: false,
  });
  const [isLoading, setIsLoading] = useState(false);
  const [isSubmitted, setIsSubmitted] = useState(false);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);

    try {
      // ======================= התיקון מתחיל כאן =======================

      // 1. נבנה את המטען (payload) שישלח לשרת.
      // הוא יכיל את כל פרטי הטופס, ובנוסף את הטוקן.
      const payload = {
        ...formData,
        token: token,
      };

      // 2. נשנה את כתובת ה-API לכתובת הנכונה שיצרנו ליצירת המלצות.
      const response = await fetch(`/api/profile/testimonials`, {
        // <-- שינוי הנתיב
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload), // <-- שליחת המטען המלא
      });

      // ======================= התיקון מסתיים כאן =======================

      const result = await response.json();

      if (!response.ok) {
        throw new Error(result.message || 'שגיאה בשליחת ההמלצה.');
      }

      toast.success('ההמלצה נשלחה בהצלחה!');
      setIsSubmitted(true);
    } catch (error) {
      const errorMessage =
        error instanceof Error ? error.message : 'אירעה שגיאה לא צפויה.';
      toast.error(errorMessage);
    } finally {
      setIsLoading(false);
    }
  };

  const handleChange = (
    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>
  ) => {
    const { name, value } = e.target;
    setFormData((prev) => ({ ...prev, [name]: value }));
  };

  if (isSubmitted) {
    return (
      <div className="text-center p-8 bg-white rounded-lg shadow-md">
        <h2 className="text-xl font-bold text-green-600">תודה רבה!</h2>
        <p className="mt-2 text-gray-700">
          ההמלצה שלך נשלחה ל{userName} ותעזור לו/לה המון במסע. מעריכים את זה
          מאוד!
        </p>
      </div>
    );
  }

  return (
    <form
      onSubmit={handleSubmit}
      className="p-8 bg-white rounded-lg shadow-md space-y-6"
    >
      <div className="space-y-2">
        <Label htmlFor="authorName">שמך המלא</Label>
        <Input
          id="authorName"
          name="authorName"
          value={formData.authorName}
          onChange={handleChange}
          required
          placeholder="לדוגמה: יוסי כהן"
        />
      </div>
      <div className="space-y-2">
        <Label htmlFor="relationship">הקשר שלכם</Label>
        <Input
          id="relationship"
          name="relationship"
          value={formData.relationship}
          onChange={handleChange}
          required
          placeholder="לדוגמה: חבר מהצבא, שותפה לדירה"
        />
      </div>
      <div className="space-y-2">
        <Label htmlFor="content">ההמלצה שלך</Label>
        <Textarea
          id="content"
          name="content"
          value={formData.content}
          onChange={handleChange}
          required
          minLength={50}
          rows={5}
          placeholder={`ספר/י קצת על ${userName}, על התכונות הבולטות שלו/ה, וכל מה שחשוב שהצד השני יכיר...`}
        />
      </div>
      <div className="space-y-2">
        <Label htmlFor="authorPhone">מספר טלפון (אופציונלי)</Label>
        <Input
          id="authorPhone"
          name="authorPhone"
          type="tel"
          value={formData.authorPhone}
          onChange={handleChange}
          placeholder="למקרה שירצו לשמוע ממך עוד"
        />
      </div>
      <div className="flex items-start space-x-2 rtl:space-x-reverse rounded-md border p-4">
        <Checkbox
          id="isPhoneVisibleToMatch"
          checked={formData.isPhoneVisibleToMatch}
          onCheckedChange={(checked) =>
            setFormData((prev) => ({
              ...prev,
              isPhoneVisibleToMatch: !!checked,
            }))
          }
          disabled={!formData.authorPhone}
        />
        <div className="grid gap-1.5 leading-none">
          <label
            htmlFor="isPhoneVisibleToMatch"
            className="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
          >
            אני מאשר/ת שמספר הטלפון שלי יישמר ויוצג למועמדים רלוונטיים שאושרו על
            ידי צוות NeshamaTech.
          </label>
          <p className="text-xs text-muted-foreground">
            זוהי הזדמנות נהדרת לתת המלצה אישית וחמה.
          </p>
        </div>
      </div>
      <Button type="submit" className="w-full" disabled={isLoading}>
        {isLoading ? <Loader2 className="mr-2 h-4 w-4 animate-spin" /> : null}
        {isLoading ? 'שולח...' : 'שלח המלצה'}
      </Button>
    </form>
  );
}
--- End of Content for TestimonialSubmissionForm.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]\[token]_contents.txt
--------------------------------------------------------------------------------
[This is the output log file itself. Content not included.]

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/testimonial/[token]/page.tsx
import { TestimonialSubmissionForm } from './TestimonialSubmissionForm';
import prisma from '@/lib/prisma';
import { notFound } from 'next/navigation';

interface PageProps {
  params: { token: string };
}

// --- פונקציית אימות הטוקן (Token Validation) - גרסה חדשה ---
async function validateToken(
  token: string
): Promise<{ profileId: string; userName: string } | null> {
  try {
    // Search for a request that matches the token, is still PENDING, and has NOT expired.
    const request = await prisma.testimonialRequest.findUnique({
      where: {
        token: token,
        status: 'PENDING', // Must be unused
        expiresAt: {
          gt: new Date(), // Must not be expired
        },
      },
      // Include related user data to get the name
      include: {
        profile: {
          select: {
            user: {
              select: { firstName: true, lastName: true },
            },
          },
        },
      },
    });

    // If no such request exists, the link is invalid
    if (!request || !request.profile.user) {
      return null;
    }

    const { user } = request.profile;
    return {
      profileId: request.profileId,
      userName: `${user.firstName} ${user.lastName}`,
    };
  } catch (error) {
    console.error('Token validation failed:', error);
    return null;
  }
}

// --- רכיב העמוד (Page Component) - נשאר כמעט זהה ---
export default async function TestimonialPage({ params }: PageProps) {
  const validationResult = await validateToken(params.token);

  if (!validationResult) {
    return notFound();
  }

  const { userName } = validationResult; // We don't need profileId here

  return (
    <main className="flex items-center justify-center min-h-screen bg-gray-50 p-4">
      <div className="w-full max-w-lg">
        <div className="text-center mb-6">
          <h1 className="text-2xl font-bold text-gray-800">
            המלצה חמה על {userName}
          </h1>
          <p className="text-gray-600 mt-2">
            תודה רבה שהקדשת מזמנך! המילים החמות שלך יכולות לעשות את כל ההבדל.
          </p>
        </div>
        {/* Pass the token to the form for submission */}
        <TestimonialSubmissionForm token={params.token} userName={userName} />
      </div>
    </main>
  );
}
--- End of Content for page.tsx ---

--- End of Content for [token]_contents.txt ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\testimonial\[token]\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/testimonial/[token]/page.tsx
import { TestimonialSubmissionForm } from './TestimonialSubmissionForm';
import prisma from '@/lib/prisma';
import { notFound } from 'next/navigation';
import { Locale } from '../../../../../i18n-config'; // ייבוא חסר

// ▼▼▼ כאן השינוי ▼▼▼
interface PageProps {
  params: Promise<{ token: string; locale: Locale }>; // הוספת locale והפיכה ל-Promise
}

async function validateToken(
  token: string
): Promise<{ profileId: string; userName: string } | null> {
  try {
    const request = await prisma.testimonialRequest.findUnique({
      where: {
        token: token,
        status: 'PENDING',
        expiresAt: {
          gt: new Date(),
        },
      },
      include: {
        profile: {
          select: {
            user: {
              select: { firstName: true, lastName: true },
            },
          },
        },
      },
    });

    if (!request || !request.profile.user) {
      return null;
    }

    const { user } = request.profile;
    return {
      profileId: request.profileId,
      userName: `${user.firstName} ${user.lastName}`,
    };
  } catch (error) {
    console.error('Token validation failed:', error);
    return null;
  }
}

export default async function TestimonialPage({ params }: PageProps) {
  const { token } = await params; // הוספת await
  const validationResult = await validateToken(token);

  if (!validationResult) {
    return notFound();
  }

  const { userName } = validationResult;

  return (
    <main className="flex items-center justify-center min-h-screen bg-gray-50 p-4">
      <div className="w-full max-w-lg">
        <div className="text-center mb-6">
          <h1 className="text-2xl font-bold text-gray-800">
            המלצה חמה על {userName}
          </h1>
          <p className="text-gray-600 mt-2">
            תודה רבה שהקדשת מזמנך! המילים החמות שלך יכולות לעשות את כל ההבדל.
          </p>
        </div>
        <TestimonialSubmissionForm token={token} userName={userName} />
      </div>
    </main>
  );
}
--- End of Content for page.tsx ---

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe\UnsubscribeClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/unsubscribe/UnsubscribeClient.tsx
'use client';

import { useEffect, useState } from 'react';
import { useSearchParams } from 'next/navigation';
import { Loader2, CheckCircle, AlertTriangle, Home } from 'lucide-react';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import type { UnsubscribePageDict } from '@/types/dictionaries/auth'; // Adjust path as needed

type Status = 'verifying' | 'success' | 'error';

interface UnsubscribeClientProps {
    dict: UnsubscribePageDict;
}

export default function UnsubscribeClient({ dict }: UnsubscribeClientProps) {
    const searchParams = useSearchParams();
    const [status, setStatus] = useState<Status>('verifying');
    const [message, setMessage] = useState(dict.verifying);

    useEffect(() => {
        const token = searchParams.get('token');

        if (!token) {
            setStatus('error');
            setMessage(dict.errorInvalidLink);
            return;
        }

        const unsubscribeUser = async () => {
            try {
                const response = await fetch('/api/user/unsubscribe', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ token }),
                });

                const result = await response.json();

                if (!response.ok || !result.success) {
                    throw new Error(result.error || dict.errorMessageDefault);
                }

                setStatus('success');
                setMessage(dict.successMessage);
            } catch (err) {
                setStatus('error');
                setMessage(err instanceof Error ? err.message : dict.errorMessageDefault);
            }
        };

        unsubscribeUser();
    }, [searchParams, dict]);

    const renderIcon = () => {
        switch (status) {
            case 'verifying': return <Loader2 className="h-12 w-12 animate-spin text-cyan-600" />;
            case 'success': return <CheckCircle className="h-12 w-12 text-green-600" />;
            case 'error': return <AlertTriangle className="h-12 w-12 text-red-600" />;
        }
    };

    return (
        <div className="w-full max-w-md bg-white rounded-xl shadow-xl p-8 text-center space-y-6">
            <div>{renderIcon()}</div>
            <h1 className="text-2xl font-bold text-gray-800">
                {status === 'verifying' && dict.verifying}
                {status === 'success' && dict.successTitle}
                {status === 'error' && dict.errorTitle}
            </h1>
            <p className="text-gray-600">{message}</p>
            {(status === 'success' || status === 'error') && (
                <Button asChild>
                    <Link href="/">
                        <Home className="mr-2 h-4 w-4" />
                        {dict.backToHomeButton}
                    </Link>
                </Button>
            )}
        </div>
    );
};
--- End of Content for UnsubscribeClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/unsubscribe/page.tsx

import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../i18n-config';
import UnsubscribeClient from './UnsubscribeClient';

function Loading() {
    return <Loader2 className="h-8 w-8 animate-spin" />;
}

// ▼▼▼ THE FIX IS HERE ▼▼▼
type UnsubscribePageProps = {
    params: Promise<{ locale: Locale }>;
};

export default async function UnsubscribePage({ params }: UnsubscribePageProps) {
    const { locale } = await params; // <-- Added await
    const dictionary = await getDictionary(locale);
    
    return (
        <div className="min-h-screen flex items-center justify-center bg-gray-50 p-4">
            <Suspense fallback={<Loading />}>
                <UnsubscribeClient dict={dictionary.auth.unsubscribePage} />
            </Suspense>
        </div>
    );
}
--- End of Content for page.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe\unsubscribe_contents.txt
--------------------------------------------------------------------------------
Content:
################################################################################
# Directory Content Map For: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe
# Generated on: 2025-10-28 13:40:04
################################################################################

================================================================================
Directory: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe
================================================================================

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe\UnsubscribeClient.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/unsubscribe/UnsubscribeClient.tsx
'use client';

import { useEffect, useState } from 'react';
import { useSearchParams } from 'next/navigation';
import { Loader2, CheckCircle, AlertTriangle, Home } from 'lucide-react';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import type { UnsubscribePageDict } from '@/types/dictionaries/auth'; // Adjust path as needed

type Status = 'verifying' | 'success' | 'error';

interface UnsubscribeClientProps {
    dict: UnsubscribePageDict;
}

export default function UnsubscribeClient({ dict }: UnsubscribeClientProps) {
    const searchParams = useSearchParams();
    const [status, setStatus] = useState<Status>('verifying');
    const [message, setMessage] = useState(dict.verifying);

    useEffect(() => {
        const token = searchParams.get('token');

        if (!token) {
            setStatus('error');
            setMessage(dict.errorInvalidLink);
            return;
        }

        const unsubscribeUser = async () => {
            try {
                const response = await fetch('/api/user/unsubscribe', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ token }),
                });

                const result = await response.json();

                if (!response.ok || !result.success) {
                    throw new Error(result.error || dict.errorMessageDefault);
                }

                setStatus('success');
                setMessage(dict.successMessage);
            } catch (err) {
                setStatus('error');
                setMessage(err instanceof Error ? err.message : dict.errorMessageDefault);
            }
        };

        unsubscribeUser();
    }, [searchParams, dict]);

    const renderIcon = () => {
        switch (status) {
            case 'verifying': return <Loader2 className="h-12 w-12 animate-spin text-cyan-600" />;
            case 'success': return <CheckCircle className="h-12 w-12 text-green-600" />;
            case 'error': return <AlertTriangle className="h-12 w-12 text-red-600" />;
        }
    };

    return (
        <div className="w-full max-w-md bg-white rounded-xl shadow-xl p-8 text-center space-y-6">
            <div>{renderIcon()}</div>
            <h1 className="text-2xl font-bold text-gray-800">
                {status === 'verifying' && dict.verifying}
                {status === 'success' && dict.successTitle}
                {status === 'error' && dict.errorTitle}
            </h1>
            <p className="text-gray-600">{message}</p>
            {(status === 'success' || status === 'error') && (
                <Button asChild>
                    <Link href="/">
                        <Home className="mr-2 h-4 w-4" />
                        {dict.backToHomeButton}
                    </Link>
                </Button>
            )}
        </div>
    );
};
--- End of Content for UnsubscribeClient.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe\page.tsx
--------------------------------------------------------------------------------
Content:
// src/app/[locale]/unsubscribe/page.tsx

import { Suspense } from 'react';
import { Loader2 } from 'lucide-react';
import { getDictionary } from '@/lib/dictionaries';
import type { Locale } from '../../../../i18n-config';
import UnsubscribeClient from './UnsubscribeClient'; // We'll create this next

function Loading() {
    return <Loader2 className="h-8 w-8 animate-spin" />;
}

type UnsubscribePageProps = {
    params: { locale: Locale };
};

export default async function UnsubscribePage({ params }: UnsubscribePageProps) {
    const { locale } = params;
    const dictionary = await getDictionary(locale);
    
    return (
        <div className="min-h-screen flex items-center justify-center bg-gray-50 p-4">
            <Suspense fallback={<Loading />}>
                <UnsubscribeClient dict={dictionary.auth.unsubscribePage} />
            </Suspense>
        </div>
    );
}
--- End of Content for page.tsx ---

--------------------------------------------------------------------------------
File: C:\Users\eytan\Desktop\NeshamaTech\shidduch-system\src\app\[locale]\unsubscribe\unsubscribe_contents.txt
--------------------------------------------------------------------------------
[This is the output log file itself. Content not included.]

--- End of Content for unsubscribe_contents.txt ---

